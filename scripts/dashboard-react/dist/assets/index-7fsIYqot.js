(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(l){if(l.ep)return;l.ep=!0;const a=r(l);fetch(l.href,a)}})();function Tp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xu={exports:{}},ta={},gu={exports:{}},pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ms=Symbol.for("react.element"),Pp=Symbol.for("react.portal"),$p=Symbol.for("react.fragment"),zp=Symbol.for("react.strict_mode"),Ap=Symbol.for("react.profiler"),Lp=Symbol.for("react.provider"),Dp=Symbol.for("react.context"),Rp=Symbol.for("react.forward_ref"),Fp=Symbol.for("react.suspense"),Mp=Symbol.for("react.memo"),Op=Symbol.for("react.lazy"),qo=Symbol.iterator;function Ip(e){return e===null||typeof e!="object"?null:(e=qo&&e[qo]||e["@@iterator"],typeof e=="function"?e:null)}var hu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},yu=Object.assign,vu={};function On(e,t,r){this.props=e,this.context=t,this.refs=vu,this.updater=r||hu}On.prototype.isReactComponent={};On.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};On.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function wu(){}wu.prototype=On.prototype;function eo(e,t,r){this.props=e,this.context=t,this.refs=vu,this.updater=r||hu}var to=eo.prototype=new wu;to.constructor=eo;yu(to,On.prototype);to.isPureReactComponent=!0;var Xo=Array.isArray,bu=Object.prototype.hasOwnProperty,ro={current:null},ju={key:!0,ref:!0,__self:!0,__source:!0};function ku(e,t,r){var s,l={},a=null,i=null;if(t!=null)for(s in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)bu.call(t,s)&&!ju.hasOwnProperty(s)&&(l[s]=t[s]);var o=arguments.length-2;if(o===1)l.children=r;else if(1<o){for(var c=Array(o),m=0;m<o;m++)c[m]=arguments[m+2];l.children=c}if(e&&e.defaultProps)for(s in o=e.defaultProps,o)l[s]===void 0&&(l[s]=o[s]);return{$$typeof:Ms,type:e,key:a,ref:i,props:l,_owner:ro.current}}function Up(e,t){return{$$typeof:Ms,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function no(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ms}function Vp(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Go=/\/+/g;function Na(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Vp(""+e.key):t.toString(36)}function vl(e,t,r,s,l){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Ms:case Pp:i=!0}}if(i)return i=e,l=l(i),e=s===""?"."+Na(i,0):s,Xo(l)?(r="",e!=null&&(r=e.replace(Go,"$&/")+"/"),vl(l,t,r,"",function(m){return m})):l!=null&&(no(l)&&(l=Up(l,r+(!l.key||i&&i.key===l.key?"":(""+l.key).replace(Go,"$&/")+"/")+e)),t.push(l)),1;if(i=0,s=s===""?".":s+":",Xo(e))for(var o=0;o<e.length;o++){a=e[o];var c=s+Na(a,o);i+=vl(a,t,r,c,l)}else if(c=Ip(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=s+Na(a,o++),i+=vl(a,t,r,c,l);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function rl(e,t,r){if(e==null)return e;var s=[],l=0;return vl(e,s,"","",function(a){return t.call(r,a,l++)}),s}function Bp(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ut={current:null},wl={transition:null},Wp={ReactCurrentDispatcher:ut,ReactCurrentBatchConfig:wl,ReactCurrentOwner:ro};function _u(){throw Error("act(...) is not supported in production builds of React.")}pe.Children={map:rl,forEach:function(e,t,r){rl(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return rl(e,function(){t++}),t},toArray:function(e){return rl(e,function(t){return t})||[]},only:function(e){if(!no(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};pe.Component=On;pe.Fragment=$p;pe.Profiler=Ap;pe.PureComponent=eo;pe.StrictMode=zp;pe.Suspense=Fp;pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wp;pe.act=_u;pe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=yu({},e.props),l=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=ro.current),t.key!==void 0&&(l=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)bu.call(t,c)&&!ju.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){o=Array(c);for(var m=0;m<c;m++)o[m]=arguments[m+2];s.children=o}return{$$typeof:Ms,type:e.type,key:l,ref:a,props:s,_owner:i}};pe.createContext=function(e){return e={$$typeof:Dp,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Lp,_context:e},e.Consumer=e};pe.createElement=ku;pe.createFactory=function(e){var t=ku.bind(null,e);return t.type=e,t};pe.createRef=function(){return{current:null}};pe.forwardRef=function(e){return{$$typeof:Rp,render:e}};pe.isValidElement=no;pe.lazy=function(e){return{$$typeof:Op,_payload:{_status:-1,_result:e},_init:Bp}};pe.memo=function(e,t){return{$$typeof:Mp,type:e,compare:t===void 0?null:t}};pe.startTransition=function(e){var t=wl.transition;wl.transition={};try{e()}finally{wl.transition=t}};pe.unstable_act=_u;pe.useCallback=function(e,t){return ut.current.useCallback(e,t)};pe.useContext=function(e){return ut.current.useContext(e)};pe.useDebugValue=function(){};pe.useDeferredValue=function(e){return ut.current.useDeferredValue(e)};pe.useEffect=function(e,t){return ut.current.useEffect(e,t)};pe.useId=function(){return ut.current.useId()};pe.useImperativeHandle=function(e,t,r){return ut.current.useImperativeHandle(e,t,r)};pe.useInsertionEffect=function(e,t){return ut.current.useInsertionEffect(e,t)};pe.useLayoutEffect=function(e,t){return ut.current.useLayoutEffect(e,t)};pe.useMemo=function(e,t){return ut.current.useMemo(e,t)};pe.useReducer=function(e,t,r){return ut.current.useReducer(e,t,r)};pe.useRef=function(e){return ut.current.useRef(e)};pe.useState=function(e){return ut.current.useState(e)};pe.useSyncExternalStore=function(e,t,r){return ut.current.useSyncExternalStore(e,t,r)};pe.useTransition=function(){return ut.current.useTransition()};pe.version="18.3.1";gu.exports=pe;var p=gu.exports;const Qp=Tp(p);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hp=p,Kp=Symbol.for("react.element"),Yp=Symbol.for("react.fragment"),qp=Object.prototype.hasOwnProperty,Xp=Hp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Gp={key:!0,ref:!0,__self:!0,__source:!0};function Nu(e,t,r){var s,l={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(s in t)qp.call(t,s)&&!Gp.hasOwnProperty(s)&&(l[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)l[s]===void 0&&(l[s]=t[s]);return{$$typeof:Kp,type:e,key:a,ref:i,props:l,_owner:Xp.current}}ta.Fragment=Yp;ta.jsx=Nu;ta.jsxs=Nu;xu.exports=ta;var n=xu.exports,ai={},Su={exports:{}},jt={},Cu={exports:{}},Eu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(j,H){var Z=j.length;j.push(H);e:for(;0<Z;){var de=Z-1>>>1,oe=j[de];if(0<l(oe,H))j[de]=H,j[Z]=oe,Z=de;else break e}}function r(j){return j.length===0?null:j[0]}function s(j){if(j.length===0)return null;var H=j[0],Z=j.pop();if(Z!==H){j[0]=Z;e:for(var de=0,oe=j.length,Oe=oe>>>1;de<Oe;){var ke=2*(de+1)-1,L=j[ke],re=ke+1,xe=j[re];if(0>l(L,Z))re<oe&&0>l(xe,L)?(j[de]=xe,j[re]=Z,de=re):(j[de]=L,j[ke]=Z,de=ke);else if(re<oe&&0>l(xe,Z))j[de]=xe,j[re]=Z,de=re;else break e}}return H}function l(j,H){var Z=j.sortIndex-H.sortIndex;return Z!==0?Z:j.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],m=[],v=1,b=null,x=3,E=!1,h=!1,_=!1,D=typeof setTimeout=="function"?setTimeout:null,d=typeof clearTimeout=="function"?clearTimeout:null,u=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function f(j){for(var H=r(m);H!==null;){if(H.callback===null)s(m);else if(H.startTime<=j)s(m),H.sortIndex=H.expirationTime,t(c,H);else break;H=r(m)}}function C(j){if(_=!1,f(j),!h)if(r(c)!==null)h=!0,ne(A);else{var H=r(m);H!==null&&J(C,H.startTime-j)}}function A(j,H){h=!1,_&&(_=!1,d(O),O=-1),E=!0;var Z=x;try{for(f(H),b=r(c);b!==null&&(!(b.expirationTime>H)||j&&!Y());){var de=b.callback;if(typeof de=="function"){b.callback=null,x=b.priorityLevel;var oe=de(b.expirationTime<=H);H=e.unstable_now(),typeof oe=="function"?b.callback=oe:b===r(c)&&s(c),f(H)}else s(c);b=r(c)}if(b!==null)var Oe=!0;else{var ke=r(m);ke!==null&&J(C,ke.startTime-H),Oe=!1}return Oe}finally{b=null,x=Z,E=!1}}var z=!1,N=null,O=-1,ee=5,S=-1;function Y(){return!(e.unstable_now()-S<ee)}function $(){if(N!==null){var j=e.unstable_now();S=j;var H=!0;try{H=N(!0,j)}finally{H?V():(z=!1,N=null)}}else z=!1}var V;if(typeof u=="function")V=function(){u($)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,le=G.port2;G.port1.onmessage=$,V=function(){le.postMessage(null)}}else V=function(){D($,0)};function ne(j){N=j,z||(z=!0,V())}function J(j,H){O=D(function(){j(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(j){j.callback=null},e.unstable_continueExecution=function(){h||E||(h=!0,ne(A))},e.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<j?Math.floor(1e3/j):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(j){switch(x){case 1:case 2:case 3:var H=3;break;default:H=x}var Z=x;x=H;try{return j()}finally{x=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(j,H){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var Z=x;x=j;try{return H()}finally{x=Z}},e.unstable_scheduleCallback=function(j,H,Z){var de=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?de+Z:de):Z=de,j){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=Z+oe,j={id:v++,callback:H,priorityLevel:j,startTime:Z,expirationTime:oe,sortIndex:-1},Z>de?(j.sortIndex=Z,t(m,j),r(c)===null&&j===r(m)&&(_?(d(O),O=-1):_=!0,J(C,Z-de))):(j.sortIndex=oe,t(c,j),h||E||(h=!0,ne(A))),j},e.unstable_shouldYield=Y,e.unstable_wrapCallback=function(j){var H=x;return function(){var Z=x;x=H;try{return j.apply(this,arguments)}finally{x=Z}}}})(Eu);Cu.exports=Eu;var Jp=Cu.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zp=p,bt=Jp;function U(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Tu=new Set,bs={};function rn(e,t){zn(e,t),zn(e+"Capture",t)}function zn(e,t){for(bs[e]=t,e=0;e<t.length;e++)Tu.add(t[e])}var ir=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ii=Object.prototype.hasOwnProperty,em=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jo={},Zo={};function tm(e){return ii.call(Zo,e)?!0:ii.call(Jo,e)?!1:em.test(e)?Zo[e]=!0:(Jo[e]=!0,!1)}function rm(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function nm(e,t,r,s){if(t===null||typeof t>"u"||rm(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function dt(e,t,r,s,l,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=l,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Xe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Xe[e]=new dt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Xe[t]=new dt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Xe[e]=new dt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Xe[e]=new dt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Xe[e]=new dt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Xe[e]=new dt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Xe[e]=new dt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Xe[e]=new dt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Xe[e]=new dt(e,5,!1,e.toLowerCase(),null,!1,!1)});var so=/[\-:]([a-z])/g;function lo(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(so,lo);Xe[t]=new dt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(so,lo);Xe[t]=new dt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(so,lo);Xe[t]=new dt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Xe[e]=new dt(e,1,!1,e.toLowerCase(),null,!1,!1)});Xe.xlinkHref=new dt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Xe[e]=new dt(e,1,!1,e.toLowerCase(),null,!0,!0)});function ao(e,t,r,s){var l=Xe.hasOwnProperty(t)?Xe[t]:null;(l!==null?l.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(nm(t,r,l,s)&&(r=null),s||l===null?tm(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):l.mustUseProperty?e[l.propertyName]=r===null?l.type===3?!1:"":r:(t=l.attributeName,s=l.attributeNamespace,r===null?e.removeAttribute(t):(l=l.type,r=l===3||l===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var dr=Zp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nl=Symbol.for("react.element"),fn=Symbol.for("react.portal"),xn=Symbol.for("react.fragment"),io=Symbol.for("react.strict_mode"),oi=Symbol.for("react.profiler"),Pu=Symbol.for("react.provider"),$u=Symbol.for("react.context"),oo=Symbol.for("react.forward_ref"),ci=Symbol.for("react.suspense"),ui=Symbol.for("react.suspense_list"),co=Symbol.for("react.memo"),yr=Symbol.for("react.lazy"),zu=Symbol.for("react.offscreen"),ec=Symbol.iterator;function Gn(e){return e===null||typeof e!="object"?null:(e=ec&&e[ec]||e["@@iterator"],typeof e=="function"?e:null)}var Ae=Object.assign,Sa;function as(e){if(Sa===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Sa=t&&t[1]||""}return`
`+Sa+e}var Ca=!1;function Ea(e,t){if(!e||Ca)return"";Ca=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(m){var s=m}Reflect.construct(e,[],t)}else{try{t.call()}catch(m){s=m}e.call(t.prototype)}else{try{throw Error()}catch(m){s=m}e()}}catch(m){if(m&&s&&typeof m.stack=="string"){for(var l=m.stack.split(`
`),a=s.stack.split(`
`),i=l.length-1,o=a.length-1;1<=i&&0<=o&&l[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(l[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||l[i]!==a[o]){var c=`
`+l[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{Ca=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?as(e):""}function sm(e){switch(e.tag){case 5:return as(e.type);case 16:return as("Lazy");case 13:return as("Suspense");case 19:return as("SuspenseList");case 0:case 2:case 15:return e=Ea(e.type,!1),e;case 11:return e=Ea(e.type.render,!1),e;case 1:return e=Ea(e.type,!0),e;default:return""}}function di(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xn:return"Fragment";case fn:return"Portal";case oi:return"Profiler";case io:return"StrictMode";case ci:return"Suspense";case ui:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case $u:return(e.displayName||"Context")+".Consumer";case Pu:return(e._context.displayName||"Context")+".Provider";case oo:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case co:return t=e.displayName||null,t!==null?t:di(e.type)||"Memo";case yr:t=e._payload,e=e._init;try{return di(e(t))}catch{}}return null}function lm(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return di(t);case 8:return t===io?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function zr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Au(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function am(e){var t=Au(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var l=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(i){s=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function sl(e){e._valueTracker||(e._valueTracker=am(e))}function Lu(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=Au(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function $l(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function pi(e,t){var r=t.checked;return Ae({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function tc(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=zr(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Du(e,t){t=t.checked,t!=null&&ao(e,"checked",t,!1)}function mi(e,t){Du(e,t);var r=zr(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?fi(e,t.type,r):t.hasOwnProperty("defaultValue")&&fi(e,t.type,zr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function rc(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function fi(e,t,r){(t!=="number"||$l(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var is=Array.isArray;function Sn(e,t,r,s){if(e=e.options,t){t={};for(var l=0;l<r.length;l++)t["$"+r[l]]=!0;for(r=0;r<e.length;r++)l=t.hasOwnProperty("$"+e[r].value),e[r].selected!==l&&(e[r].selected=l),l&&s&&(e[r].defaultSelected=!0)}else{for(r=""+zr(r),t=null,l=0;l<e.length;l++){if(e[l].value===r){e[l].selected=!0,s&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function xi(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(U(91));return Ae({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function nc(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(U(92));if(is(r)){if(1<r.length)throw Error(U(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:zr(r)}}function Ru(e,t){var r=zr(t.value),s=zr(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function sc(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Fu(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gi(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Fu(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ll,Mu=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,l){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,l)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ll=ll||document.createElement("div"),ll.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ll.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function js(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ds={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},im=["Webkit","ms","Moz","O"];Object.keys(ds).forEach(function(e){im.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ds[t]=ds[e]})});function Ou(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ds.hasOwnProperty(e)&&ds[e]?(""+t).trim():t+"px"}function Iu(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,l=Ou(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,l):e[r]=l}}var om=Ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hi(e,t){if(t){if(om[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(U(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(U(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(U(61))}if(t.style!=null&&typeof t.style!="object")throw Error(U(62))}}function yi(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vi=null;function uo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var wi=null,Cn=null,En=null;function lc(e){if(e=Us(e)){if(typeof wi!="function")throw Error(U(280));var t=e.stateNode;t&&(t=aa(t),wi(e.stateNode,e.type,t))}}function Uu(e){Cn?En?En.push(e):En=[e]:Cn=e}function Vu(){if(Cn){var e=Cn,t=En;if(En=Cn=null,lc(e),t)for(e=0;e<t.length;e++)lc(t[e])}}function Bu(e,t){return e(t)}function Wu(){}var Ta=!1;function Qu(e,t,r){if(Ta)return e(t,r);Ta=!0;try{return Bu(e,t,r)}finally{Ta=!1,(Cn!==null||En!==null)&&(Wu(),Vu())}}function ks(e,t){var r=e.stateNode;if(r===null)return null;var s=aa(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(U(231,t,typeof r));return r}var bi=!1;if(ir)try{var Jn={};Object.defineProperty(Jn,"passive",{get:function(){bi=!0}}),window.addEventListener("test",Jn,Jn),window.removeEventListener("test",Jn,Jn)}catch{bi=!1}function cm(e,t,r,s,l,a,i,o,c){var m=Array.prototype.slice.call(arguments,3);try{t.apply(r,m)}catch(v){this.onError(v)}}var ps=!1,zl=null,Al=!1,ji=null,um={onError:function(e){ps=!0,zl=e}};function dm(e,t,r,s,l,a,i,o,c){ps=!1,zl=null,cm.apply(um,arguments)}function pm(e,t,r,s,l,a,i,o,c){if(dm.apply(this,arguments),ps){if(ps){var m=zl;ps=!1,zl=null}else throw Error(U(198));Al||(Al=!0,ji=m)}}function nn(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Hu(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ac(e){if(nn(e)!==e)throw Error(U(188))}function mm(e){var t=e.alternate;if(!t){if(t=nn(e),t===null)throw Error(U(188));return t!==e?null:e}for(var r=e,s=t;;){var l=r.return;if(l===null)break;var a=l.alternate;if(a===null){if(s=l.return,s!==null){r=s;continue}break}if(l.child===a.child){for(a=l.child;a;){if(a===r)return ac(l),e;if(a===s)return ac(l),t;a=a.sibling}throw Error(U(188))}if(r.return!==s.return)r=l,s=a;else{for(var i=!1,o=l.child;o;){if(o===r){i=!0,r=l,s=a;break}if(o===s){i=!0,s=l,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,s=l;break}if(o===s){i=!0,s=a,r=l;break}o=o.sibling}if(!i)throw Error(U(189))}}if(r.alternate!==s)throw Error(U(190))}if(r.tag!==3)throw Error(U(188));return r.stateNode.current===r?e:t}function Ku(e){return e=mm(e),e!==null?Yu(e):null}function Yu(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Yu(e);if(t!==null)return t;e=e.sibling}return null}var qu=bt.unstable_scheduleCallback,ic=bt.unstable_cancelCallback,fm=bt.unstable_shouldYield,xm=bt.unstable_requestPaint,Me=bt.unstable_now,gm=bt.unstable_getCurrentPriorityLevel,po=bt.unstable_ImmediatePriority,Xu=bt.unstable_UserBlockingPriority,Ll=bt.unstable_NormalPriority,hm=bt.unstable_LowPriority,Gu=bt.unstable_IdlePriority,ra=null,qt=null;function ym(e){if(qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(ra,e,void 0,(e.current.flags&128)===128)}catch{}}var Ft=Math.clz32?Math.clz32:bm,vm=Math.log,wm=Math.LN2;function bm(e){return e>>>=0,e===0?32:31-(vm(e)/wm|0)|0}var al=64,il=4194304;function os(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Dl(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,l=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~l;o!==0?s=os(o):(a&=i,a!==0&&(s=os(a)))}else i=r&~l,i!==0?s=os(i):a!==0&&(s=os(a));if(s===0)return 0;if(t!==0&&t!==s&&!(t&l)&&(l=s&-s,a=t&-t,l>=a||l===16&&(a&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-Ft(t),l=1<<r,s|=e[r],t&=~l;return s}function jm(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function km(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,l=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Ft(a),o=1<<i,c=l[i];c===-1?(!(o&r)||o&s)&&(l[i]=jm(o,t)):c<=t&&(e.expiredLanes|=o),a&=~o}}function ki(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ju(){var e=al;return al<<=1,!(al&4194240)&&(al=64),e}function Pa(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Os(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ft(t),e[t]=r}function _m(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var l=31-Ft(r),a=1<<l;t[l]=0,s[l]=-1,e[l]=-1,r&=~a}}function mo(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-Ft(r),l=1<<s;l&t|e[s]&t&&(e[s]|=t),r&=~l}}var ve=0;function Zu(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ed,fo,td,rd,nd,_i=!1,ol=[],_r=null,Nr=null,Sr=null,_s=new Map,Ns=new Map,wr=[],Nm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oc(e,t){switch(e){case"focusin":case"focusout":_r=null;break;case"dragenter":case"dragleave":Nr=null;break;case"mouseover":case"mouseout":Sr=null;break;case"pointerover":case"pointerout":_s.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ns.delete(t.pointerId)}}function Zn(e,t,r,s,l,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:a,targetContainers:[l]},t!==null&&(t=Us(t),t!==null&&fo(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function Sm(e,t,r,s,l){switch(t){case"focusin":return _r=Zn(_r,e,t,r,s,l),!0;case"dragenter":return Nr=Zn(Nr,e,t,r,s,l),!0;case"mouseover":return Sr=Zn(Sr,e,t,r,s,l),!0;case"pointerover":var a=l.pointerId;return _s.set(a,Zn(_s.get(a)||null,e,t,r,s,l)),!0;case"gotpointercapture":return a=l.pointerId,Ns.set(a,Zn(Ns.get(a)||null,e,t,r,s,l)),!0}return!1}function sd(e){var t=Hr(e.target);if(t!==null){var r=nn(t);if(r!==null){if(t=r.tag,t===13){if(t=Hu(r),t!==null){e.blockedOn=t,nd(e.priority,function(){td(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Ni(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);vi=s,r.target.dispatchEvent(s),vi=null}else return t=Us(r),t!==null&&fo(t),e.blockedOn=r,!1;t.shift()}return!0}function cc(e,t,r){bl(e)&&r.delete(t)}function Cm(){_i=!1,_r!==null&&bl(_r)&&(_r=null),Nr!==null&&bl(Nr)&&(Nr=null),Sr!==null&&bl(Sr)&&(Sr=null),_s.forEach(cc),Ns.forEach(cc)}function es(e,t){e.blockedOn===t&&(e.blockedOn=null,_i||(_i=!0,bt.unstable_scheduleCallback(bt.unstable_NormalPriority,Cm)))}function Ss(e){function t(l){return es(l,e)}if(0<ol.length){es(ol[0],e);for(var r=1;r<ol.length;r++){var s=ol[r];s.blockedOn===e&&(s.blockedOn=null)}}for(_r!==null&&es(_r,e),Nr!==null&&es(Nr,e),Sr!==null&&es(Sr,e),_s.forEach(t),Ns.forEach(t),r=0;r<wr.length;r++)s=wr[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<wr.length&&(r=wr[0],r.blockedOn===null);)sd(r),r.blockedOn===null&&wr.shift()}var Tn=dr.ReactCurrentBatchConfig,Rl=!0;function Em(e,t,r,s){var l=ve,a=Tn.transition;Tn.transition=null;try{ve=1,xo(e,t,r,s)}finally{ve=l,Tn.transition=a}}function Tm(e,t,r,s){var l=ve,a=Tn.transition;Tn.transition=null;try{ve=4,xo(e,t,r,s)}finally{ve=l,Tn.transition=a}}function xo(e,t,r,s){if(Rl){var l=Ni(e,t,r,s);if(l===null)Ia(e,t,s,Fl,r),oc(e,s);else if(Sm(l,e,t,r,s))s.stopPropagation();else if(oc(e,s),t&4&&-1<Nm.indexOf(e)){for(;l!==null;){var a=Us(l);if(a!==null&&ed(a),a=Ni(e,t,r,s),a===null&&Ia(e,t,s,Fl,r),a===l)break;l=a}l!==null&&s.stopPropagation()}else Ia(e,t,s,null,r)}}var Fl=null;function Ni(e,t,r,s){if(Fl=null,e=uo(s),e=Hr(e),e!==null)if(t=nn(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Hu(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Fl=e,null}function ld(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gm()){case po:return 1;case Xu:return 4;case Ll:case hm:return 16;case Gu:return 536870912;default:return 16}default:return 16}}var jr=null,go=null,jl=null;function ad(){if(jl)return jl;var e,t=go,r=t.length,s,l="value"in jr?jr.value:jr.textContent,a=l.length;for(e=0;e<r&&t[e]===l[e];e++);var i=r-e;for(s=1;s<=i&&t[r-s]===l[a-s];s++);return jl=l.slice(e,1<s?1-s:void 0)}function kl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function cl(){return!0}function uc(){return!1}function kt(e){function t(r,s,l,a,i){this._reactName=r,this._targetInst=l,this.type=s,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?cl:uc,this.isPropagationStopped=uc,this}return Ae(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=cl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=cl)},persist:function(){},isPersistent:cl}),t}var In={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ho=kt(In),Is=Ae({},In,{view:0,detail:0}),Pm=kt(Is),$a,za,ts,na=Ae({},Is,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ts&&(ts&&e.type==="mousemove"?($a=e.screenX-ts.screenX,za=e.screenY-ts.screenY):za=$a=0,ts=e),$a)},movementY:function(e){return"movementY"in e?e.movementY:za}}),dc=kt(na),$m=Ae({},na,{dataTransfer:0}),zm=kt($m),Am=Ae({},Is,{relatedTarget:0}),Aa=kt(Am),Lm=Ae({},In,{animationName:0,elapsedTime:0,pseudoElement:0}),Dm=kt(Lm),Rm=Ae({},In,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Fm=kt(Rm),Mm=Ae({},In,{data:0}),pc=kt(Mm),Om={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Im={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Um={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Um[e])?!!t[e]:!1}function yo(){return Vm}var Bm=Ae({},Is,{key:function(e){if(e.key){var t=Om[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=kl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Im[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yo,charCode:function(e){return e.type==="keypress"?kl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?kl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Wm=kt(Bm),Qm=Ae({},na,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mc=kt(Qm),Hm=Ae({},Is,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yo}),Km=kt(Hm),Ym=Ae({},In,{propertyName:0,elapsedTime:0,pseudoElement:0}),qm=kt(Ym),Xm=Ae({},na,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Gm=kt(Xm),Jm=[9,13,27,32],vo=ir&&"CompositionEvent"in window,ms=null;ir&&"documentMode"in document&&(ms=document.documentMode);var Zm=ir&&"TextEvent"in window&&!ms,id=ir&&(!vo||ms&&8<ms&&11>=ms),fc=" ",xc=!1;function od(e,t){switch(e){case"keyup":return Jm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var gn=!1;function e0(e,t){switch(e){case"compositionend":return cd(t);case"keypress":return t.which!==32?null:(xc=!0,fc);case"textInput":return e=t.data,e===fc&&xc?null:e;default:return null}}function t0(e,t){if(gn)return e==="compositionend"||!vo&&od(e,t)?(e=ad(),jl=go=jr=null,gn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return id&&t.locale!=="ko"?null:t.data;default:return null}}var r0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!r0[e.type]:t==="textarea"}function ud(e,t,r,s){Uu(s),t=Ml(t,"onChange"),0<t.length&&(r=new ho("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var fs=null,Cs=null;function n0(e){bd(e,0)}function sa(e){var t=vn(e);if(Lu(t))return e}function s0(e,t){if(e==="change")return t}var dd=!1;if(ir){var La;if(ir){var Da="oninput"in document;if(!Da){var hc=document.createElement("div");hc.setAttribute("oninput","return;"),Da=typeof hc.oninput=="function"}La=Da}else La=!1;dd=La&&(!document.documentMode||9<document.documentMode)}function yc(){fs&&(fs.detachEvent("onpropertychange",pd),Cs=fs=null)}function pd(e){if(e.propertyName==="value"&&sa(Cs)){var t=[];ud(t,Cs,e,uo(e)),Qu(n0,t)}}function l0(e,t,r){e==="focusin"?(yc(),fs=t,Cs=r,fs.attachEvent("onpropertychange",pd)):e==="focusout"&&yc()}function a0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return sa(Cs)}function i0(e,t){if(e==="click")return sa(t)}function o0(e,t){if(e==="input"||e==="change")return sa(t)}function c0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ot=typeof Object.is=="function"?Object.is:c0;function Es(e,t){if(Ot(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var l=r[s];if(!ii.call(t,l)||!Ot(e[l],t[l]))return!1}return!0}function vc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function wc(e,t){var r=vc(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=vc(r)}}function md(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?md(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function fd(){for(var e=window,t=$l();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=$l(e.document)}return t}function wo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function u0(e){var t=fd(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&md(r.ownerDocument.documentElement,r)){if(s!==null&&wo(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=r.textContent.length,a=Math.min(s.start,l);s=s.end===void 0?a:Math.min(s.end,l),!e.extend&&a>s&&(l=s,s=a,a=l),l=wc(r,a);var i=wc(r,s);l&&i&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),a>s?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var d0=ir&&"documentMode"in document&&11>=document.documentMode,hn=null,Si=null,xs=null,Ci=!1;function bc(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ci||hn==null||hn!==$l(s)||(s=hn,"selectionStart"in s&&wo(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),xs&&Es(xs,s)||(xs=s,s=Ml(Si,"onSelect"),0<s.length&&(t=new ho("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=hn)))}function ul(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var yn={animationend:ul("Animation","AnimationEnd"),animationiteration:ul("Animation","AnimationIteration"),animationstart:ul("Animation","AnimationStart"),transitionend:ul("Transition","TransitionEnd")},Ra={},xd={};ir&&(xd=document.createElement("div").style,"AnimationEvent"in window||(delete yn.animationend.animation,delete yn.animationiteration.animation,delete yn.animationstart.animation),"TransitionEvent"in window||delete yn.transitionend.transition);function la(e){if(Ra[e])return Ra[e];if(!yn[e])return e;var t=yn[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in xd)return Ra[e]=t[r];return e}var gd=la("animationend"),hd=la("animationiteration"),yd=la("animationstart"),vd=la("transitionend"),wd=new Map,jc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lr(e,t){wd.set(e,t),rn(t,[e])}for(var Fa=0;Fa<jc.length;Fa++){var Ma=jc[Fa],p0=Ma.toLowerCase(),m0=Ma[0].toUpperCase()+Ma.slice(1);Lr(p0,"on"+m0)}Lr(gd,"onAnimationEnd");Lr(hd,"onAnimationIteration");Lr(yd,"onAnimationStart");Lr("dblclick","onDoubleClick");Lr("focusin","onFocus");Lr("focusout","onBlur");Lr(vd,"onTransitionEnd");zn("onMouseEnter",["mouseout","mouseover"]);zn("onMouseLeave",["mouseout","mouseover"]);zn("onPointerEnter",["pointerout","pointerover"]);zn("onPointerLeave",["pointerout","pointerover"]);rn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));rn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));rn("onBeforeInput",["compositionend","keypress","textInput","paste"]);rn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));rn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));rn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f0=new Set("cancel close invalid load scroll toggle".split(" ").concat(cs));function kc(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,pm(s,t,void 0,e),e.currentTarget=null}function bd(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],l=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var i=s.length-1;0<=i;i--){var o=s[i],c=o.instance,m=o.currentTarget;if(o=o.listener,c!==a&&l.isPropagationStopped())break e;kc(l,o,m),a=c}else for(i=0;i<s.length;i++){if(o=s[i],c=o.instance,m=o.currentTarget,o=o.listener,c!==a&&l.isPropagationStopped())break e;kc(l,o,m),a=c}}}if(Al)throw e=ji,Al=!1,ji=null,e}function Se(e,t){var r=t[zi];r===void 0&&(r=t[zi]=new Set);var s=e+"__bubble";r.has(s)||(jd(t,e,2,!1),r.add(s))}function Oa(e,t,r){var s=0;t&&(s|=4),jd(r,e,s,t)}var dl="_reactListening"+Math.random().toString(36).slice(2);function Ts(e){if(!e[dl]){e[dl]=!0,Tu.forEach(function(r){r!=="selectionchange"&&(f0.has(r)||Oa(r,!1,e),Oa(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[dl]||(t[dl]=!0,Oa("selectionchange",!1,t))}}function jd(e,t,r,s){switch(ld(t)){case 1:var l=Em;break;case 4:l=Tm;break;default:l=xo}r=l.bind(null,t,r,e),l=void 0,!bi||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),s?l!==void 0?e.addEventListener(t,r,{capture:!0,passive:l}):e.addEventListener(t,r,!0):l!==void 0?e.addEventListener(t,r,{passive:l}):e.addEventListener(t,r,!1)}function Ia(e,t,r,s,l){var a=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var o=s.stateNode.containerInfo;if(o===l||o.nodeType===8&&o.parentNode===l)break;if(i===4)for(i=s.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===l||c.nodeType===8&&c.parentNode===l))return;i=i.return}for(;o!==null;){if(i=Hr(o),i===null)return;if(c=i.tag,c===5||c===6){s=a=i;continue e}o=o.parentNode}}s=s.return}Qu(function(){var m=a,v=uo(r),b=[];e:{var x=wd.get(e);if(x!==void 0){var E=ho,h=e;switch(e){case"keypress":if(kl(r)===0)break e;case"keydown":case"keyup":E=Wm;break;case"focusin":h="focus",E=Aa;break;case"focusout":h="blur",E=Aa;break;case"beforeblur":case"afterblur":E=Aa;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=dc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=zm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=Km;break;case gd:case hd:case yd:E=Dm;break;case vd:E=qm;break;case"scroll":E=Pm;break;case"wheel":E=Gm;break;case"copy":case"cut":case"paste":E=Fm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=mc}var _=(t&4)!==0,D=!_&&e==="scroll",d=_?x!==null?x+"Capture":null:x;_=[];for(var u=m,f;u!==null;){f=u;var C=f.stateNode;if(f.tag===5&&C!==null&&(f=C,d!==null&&(C=ks(u,d),C!=null&&_.push(Ps(u,C,f)))),D)break;u=u.return}0<_.length&&(x=new E(x,h,null,r,v),b.push({event:x,listeners:_}))}}if(!(t&7)){e:{if(x=e==="mouseover"||e==="pointerover",E=e==="mouseout"||e==="pointerout",x&&r!==vi&&(h=r.relatedTarget||r.fromElement)&&(Hr(h)||h[or]))break e;if((E||x)&&(x=v.window===v?v:(x=v.ownerDocument)?x.defaultView||x.parentWindow:window,E?(h=r.relatedTarget||r.toElement,E=m,h=h?Hr(h):null,h!==null&&(D=nn(h),h!==D||h.tag!==5&&h.tag!==6)&&(h=null)):(E=null,h=m),E!==h)){if(_=dc,C="onMouseLeave",d="onMouseEnter",u="mouse",(e==="pointerout"||e==="pointerover")&&(_=mc,C="onPointerLeave",d="onPointerEnter",u="pointer"),D=E==null?x:vn(E),f=h==null?x:vn(h),x=new _(C,u+"leave",E,r,v),x.target=D,x.relatedTarget=f,C=null,Hr(v)===m&&(_=new _(d,u+"enter",h,r,v),_.target=f,_.relatedTarget=D,C=_),D=C,E&&h)t:{for(_=E,d=h,u=0,f=_;f;f=dn(f))u++;for(f=0,C=d;C;C=dn(C))f++;for(;0<u-f;)_=dn(_),u--;for(;0<f-u;)d=dn(d),f--;for(;u--;){if(_===d||d!==null&&_===d.alternate)break t;_=dn(_),d=dn(d)}_=null}else _=null;E!==null&&_c(b,x,E,_,!1),h!==null&&D!==null&&_c(b,D,h,_,!0)}}e:{if(x=m?vn(m):window,E=x.nodeName&&x.nodeName.toLowerCase(),E==="select"||E==="input"&&x.type==="file")var A=s0;else if(gc(x))if(dd)A=o0;else{A=a0;var z=l0}else(E=x.nodeName)&&E.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(A=i0);if(A&&(A=A(e,m))){ud(b,A,r,v);break e}z&&z(e,x,m),e==="focusout"&&(z=x._wrapperState)&&z.controlled&&x.type==="number"&&fi(x,"number",x.value)}switch(z=m?vn(m):window,e){case"focusin":(gc(z)||z.contentEditable==="true")&&(hn=z,Si=m,xs=null);break;case"focusout":xs=Si=hn=null;break;case"mousedown":Ci=!0;break;case"contextmenu":case"mouseup":case"dragend":Ci=!1,bc(b,r,v);break;case"selectionchange":if(d0)break;case"keydown":case"keyup":bc(b,r,v)}var N;if(vo)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else gn?od(e,r)&&(O="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&(id&&r.locale!=="ko"&&(gn||O!=="onCompositionStart"?O==="onCompositionEnd"&&gn&&(N=ad()):(jr=v,go="value"in jr?jr.value:jr.textContent,gn=!0)),z=Ml(m,O),0<z.length&&(O=new pc(O,e,null,r,v),b.push({event:O,listeners:z}),N?O.data=N:(N=cd(r),N!==null&&(O.data=N)))),(N=Zm?e0(e,r):t0(e,r))&&(m=Ml(m,"onBeforeInput"),0<m.length&&(v=new pc("onBeforeInput","beforeinput",null,r,v),b.push({event:v,listeners:m}),v.data=N))}bd(b,t)})}function Ps(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ml(e,t){for(var r=t+"Capture",s=[];e!==null;){var l=e,a=l.stateNode;l.tag===5&&a!==null&&(l=a,a=ks(e,r),a!=null&&s.unshift(Ps(e,a,l)),a=ks(e,t),a!=null&&s.push(Ps(e,a,l))),e=e.return}return s}function dn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function _c(e,t,r,s,l){for(var a=t._reactName,i=[];r!==null&&r!==s;){var o=r,c=o.alternate,m=o.stateNode;if(c!==null&&c===s)break;o.tag===5&&m!==null&&(o=m,l?(c=ks(r,a),c!=null&&i.unshift(Ps(r,c,o))):l||(c=ks(r,a),c!=null&&i.push(Ps(r,c,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var x0=/\r\n?/g,g0=/\u0000|\uFFFD/g;function Nc(e){return(typeof e=="string"?e:""+e).replace(x0,`
`).replace(g0,"")}function pl(e,t,r){if(t=Nc(t),Nc(e)!==t&&r)throw Error(U(425))}function Ol(){}var Ei=null,Ti=null;function Pi(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var $i=typeof setTimeout=="function"?setTimeout:void 0,h0=typeof clearTimeout=="function"?clearTimeout:void 0,Sc=typeof Promise=="function"?Promise:void 0,y0=typeof queueMicrotask=="function"?queueMicrotask:typeof Sc<"u"?function(e){return Sc.resolve(null).then(e).catch(v0)}:$i;function v0(e){setTimeout(function(){throw e})}function Ua(e,t){var r=t,s=0;do{var l=r.nextSibling;if(e.removeChild(r),l&&l.nodeType===8)if(r=l.data,r==="/$"){if(s===0){e.removeChild(l),Ss(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=l}while(r);Ss(t)}function Cr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Cc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Un=Math.random().toString(36).slice(2),Yt="__reactFiber$"+Un,$s="__reactProps$"+Un,or="__reactContainer$"+Un,zi="__reactEvents$"+Un,w0="__reactListeners$"+Un,b0="__reactHandles$"+Un;function Hr(e){var t=e[Yt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[or]||r[Yt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Cc(e);e!==null;){if(r=e[Yt])return r;e=Cc(e)}return t}e=r,r=e.parentNode}return null}function Us(e){return e=e[Yt]||e[or],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function vn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(U(33))}function aa(e){return e[$s]||null}var Ai=[],wn=-1;function Dr(e){return{current:e}}function Ce(e){0>wn||(e.current=Ai[wn],Ai[wn]=null,wn--)}function _e(e,t){wn++,Ai[wn]=e.current,e.current=t}var Ar={},nt=Dr(Ar),xt=Dr(!1),Gr=Ar;function An(e,t){var r=e.type.contextTypes;if(!r)return Ar;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var l={},a;for(a in r)l[a]=t[a];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function gt(e){return e=e.childContextTypes,e!=null}function Il(){Ce(xt),Ce(nt)}function Ec(e,t,r){if(nt.current!==Ar)throw Error(U(168));_e(nt,t),_e(xt,r)}function kd(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var l in s)if(!(l in t))throw Error(U(108,lm(e)||"Unknown",l));return Ae({},r,s)}function Ul(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ar,Gr=nt.current,_e(nt,e),_e(xt,xt.current),!0}function Tc(e,t,r){var s=e.stateNode;if(!s)throw Error(U(169));r?(e=kd(e,t,Gr),s.__reactInternalMemoizedMergedChildContext=e,Ce(xt),Ce(nt),_e(nt,e)):Ce(xt),_e(xt,r)}var nr=null,ia=!1,Va=!1;function _d(e){nr===null?nr=[e]:nr.push(e)}function j0(e){ia=!0,_d(e)}function Rr(){if(!Va&&nr!==null){Va=!0;var e=0,t=ve;try{var r=nr;for(ve=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}nr=null,ia=!1}catch(l){throw nr!==null&&(nr=nr.slice(e+1)),qu(po,Rr),l}finally{ve=t,Va=!1}}return null}var bn=[],jn=0,Vl=null,Bl=0,Nt=[],St=0,Jr=null,sr=1,lr="";function Wr(e,t){bn[jn++]=Bl,bn[jn++]=Vl,Vl=e,Bl=t}function Nd(e,t,r){Nt[St++]=sr,Nt[St++]=lr,Nt[St++]=Jr,Jr=e;var s=sr;e=lr;var l=32-Ft(s)-1;s&=~(1<<l),r+=1;var a=32-Ft(t)+l;if(30<a){var i=l-l%5;a=(s&(1<<i)-1).toString(32),s>>=i,l-=i,sr=1<<32-Ft(t)+l|r<<l|s,lr=a+e}else sr=1<<a|r<<l|s,lr=e}function bo(e){e.return!==null&&(Wr(e,1),Nd(e,1,0))}function jo(e){for(;e===Vl;)Vl=bn[--jn],bn[jn]=null,Bl=bn[--jn],bn[jn]=null;for(;e===Jr;)Jr=Nt[--St],Nt[St]=null,lr=Nt[--St],Nt[St]=null,sr=Nt[--St],Nt[St]=null}var wt=null,vt=null,Te=!1,Rt=null;function Sd(e,t){var r=Ct(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Pc(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,wt=e,vt=Cr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,wt=e,vt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Jr!==null?{id:sr,overflow:lr}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ct(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,wt=e,vt=null,!0):!1;default:return!1}}function Li(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Di(e){if(Te){var t=vt;if(t){var r=t;if(!Pc(e,t)){if(Li(e))throw Error(U(418));t=Cr(r.nextSibling);var s=wt;t&&Pc(e,t)?Sd(s,r):(e.flags=e.flags&-4097|2,Te=!1,wt=e)}}else{if(Li(e))throw Error(U(418));e.flags=e.flags&-4097|2,Te=!1,wt=e}}}function $c(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;wt=e}function ml(e){if(e!==wt)return!1;if(!Te)return $c(e),Te=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Pi(e.type,e.memoizedProps)),t&&(t=vt)){if(Li(e))throw Cd(),Error(U(418));for(;t;)Sd(e,t),t=Cr(t.nextSibling)}if($c(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(U(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){vt=Cr(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}vt=null}}else vt=wt?Cr(e.stateNode.nextSibling):null;return!0}function Cd(){for(var e=vt;e;)e=Cr(e.nextSibling)}function Ln(){vt=wt=null,Te=!1}function ko(e){Rt===null?Rt=[e]:Rt.push(e)}var k0=dr.ReactCurrentBatchConfig;function rs(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(U(309));var s=r.stateNode}if(!s)throw Error(U(147,e));var l=s,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=l.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(U(284));if(!r._owner)throw Error(U(290,e))}return e}function fl(e,t){throw e=Object.prototype.toString.call(t),Error(U(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function zc(e){var t=e._init;return t(e._payload)}function Ed(e){function t(d,u){if(e){var f=d.deletions;f===null?(d.deletions=[u],d.flags|=16):f.push(u)}}function r(d,u){if(!e)return null;for(;u!==null;)t(d,u),u=u.sibling;return null}function s(d,u){for(d=new Map;u!==null;)u.key!==null?d.set(u.key,u):d.set(u.index,u),u=u.sibling;return d}function l(d,u){return d=$r(d,u),d.index=0,d.sibling=null,d}function a(d,u,f){return d.index=f,e?(f=d.alternate,f!==null?(f=f.index,f<u?(d.flags|=2,u):f):(d.flags|=2,u)):(d.flags|=1048576,u)}function i(d){return e&&d.alternate===null&&(d.flags|=2),d}function o(d,u,f,C){return u===null||u.tag!==6?(u=qa(f,d.mode,C),u.return=d,u):(u=l(u,f),u.return=d,u)}function c(d,u,f,C){var A=f.type;return A===xn?v(d,u,f.props.children,C,f.key):u!==null&&(u.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===yr&&zc(A)===u.type)?(C=l(u,f.props),C.ref=rs(d,u,f),C.return=d,C):(C=Pl(f.type,f.key,f.props,null,d.mode,C),C.ref=rs(d,u,f),C.return=d,C)}function m(d,u,f,C){return u===null||u.tag!==4||u.stateNode.containerInfo!==f.containerInfo||u.stateNode.implementation!==f.implementation?(u=Xa(f,d.mode,C),u.return=d,u):(u=l(u,f.children||[]),u.return=d,u)}function v(d,u,f,C,A){return u===null||u.tag!==7?(u=Xr(f,d.mode,C,A),u.return=d,u):(u=l(u,f),u.return=d,u)}function b(d,u,f){if(typeof u=="string"&&u!==""||typeof u=="number")return u=qa(""+u,d.mode,f),u.return=d,u;if(typeof u=="object"&&u!==null){switch(u.$$typeof){case nl:return f=Pl(u.type,u.key,u.props,null,d.mode,f),f.ref=rs(d,null,u),f.return=d,f;case fn:return u=Xa(u,d.mode,f),u.return=d,u;case yr:var C=u._init;return b(d,C(u._payload),f)}if(is(u)||Gn(u))return u=Xr(u,d.mode,f,null),u.return=d,u;fl(d,u)}return null}function x(d,u,f,C){var A=u!==null?u.key:null;if(typeof f=="string"&&f!==""||typeof f=="number")return A!==null?null:o(d,u,""+f,C);if(typeof f=="object"&&f!==null){switch(f.$$typeof){case nl:return f.key===A?c(d,u,f,C):null;case fn:return f.key===A?m(d,u,f,C):null;case yr:return A=f._init,x(d,u,A(f._payload),C)}if(is(f)||Gn(f))return A!==null?null:v(d,u,f,C,null);fl(d,f)}return null}function E(d,u,f,C,A){if(typeof C=="string"&&C!==""||typeof C=="number")return d=d.get(f)||null,o(u,d,""+C,A);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case nl:return d=d.get(C.key===null?f:C.key)||null,c(u,d,C,A);case fn:return d=d.get(C.key===null?f:C.key)||null,m(u,d,C,A);case yr:var z=C._init;return E(d,u,f,z(C._payload),A)}if(is(C)||Gn(C))return d=d.get(f)||null,v(u,d,C,A,null);fl(u,C)}return null}function h(d,u,f,C){for(var A=null,z=null,N=u,O=u=0,ee=null;N!==null&&O<f.length;O++){N.index>O?(ee=N,N=null):ee=N.sibling;var S=x(d,N,f[O],C);if(S===null){N===null&&(N=ee);break}e&&N&&S.alternate===null&&t(d,N),u=a(S,u,O),z===null?A=S:z.sibling=S,z=S,N=ee}if(O===f.length)return r(d,N),Te&&Wr(d,O),A;if(N===null){for(;O<f.length;O++)N=b(d,f[O],C),N!==null&&(u=a(N,u,O),z===null?A=N:z.sibling=N,z=N);return Te&&Wr(d,O),A}for(N=s(d,N);O<f.length;O++)ee=E(N,d,O,f[O],C),ee!==null&&(e&&ee.alternate!==null&&N.delete(ee.key===null?O:ee.key),u=a(ee,u,O),z===null?A=ee:z.sibling=ee,z=ee);return e&&N.forEach(function(Y){return t(d,Y)}),Te&&Wr(d,O),A}function _(d,u,f,C){var A=Gn(f);if(typeof A!="function")throw Error(U(150));if(f=A.call(f),f==null)throw Error(U(151));for(var z=A=null,N=u,O=u=0,ee=null,S=f.next();N!==null&&!S.done;O++,S=f.next()){N.index>O?(ee=N,N=null):ee=N.sibling;var Y=x(d,N,S.value,C);if(Y===null){N===null&&(N=ee);break}e&&N&&Y.alternate===null&&t(d,N),u=a(Y,u,O),z===null?A=Y:z.sibling=Y,z=Y,N=ee}if(S.done)return r(d,N),Te&&Wr(d,O),A;if(N===null){for(;!S.done;O++,S=f.next())S=b(d,S.value,C),S!==null&&(u=a(S,u,O),z===null?A=S:z.sibling=S,z=S);return Te&&Wr(d,O),A}for(N=s(d,N);!S.done;O++,S=f.next())S=E(N,d,O,S.value,C),S!==null&&(e&&S.alternate!==null&&N.delete(S.key===null?O:S.key),u=a(S,u,O),z===null?A=S:z.sibling=S,z=S);return e&&N.forEach(function($){return t(d,$)}),Te&&Wr(d,O),A}function D(d,u,f,C){if(typeof f=="object"&&f!==null&&f.type===xn&&f.key===null&&(f=f.props.children),typeof f=="object"&&f!==null){switch(f.$$typeof){case nl:e:{for(var A=f.key,z=u;z!==null;){if(z.key===A){if(A=f.type,A===xn){if(z.tag===7){r(d,z.sibling),u=l(z,f.props.children),u.return=d,d=u;break e}}else if(z.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===yr&&zc(A)===z.type){r(d,z.sibling),u=l(z,f.props),u.ref=rs(d,z,f),u.return=d,d=u;break e}r(d,z);break}else t(d,z);z=z.sibling}f.type===xn?(u=Xr(f.props.children,d.mode,C,f.key),u.return=d,d=u):(C=Pl(f.type,f.key,f.props,null,d.mode,C),C.ref=rs(d,u,f),C.return=d,d=C)}return i(d);case fn:e:{for(z=f.key;u!==null;){if(u.key===z)if(u.tag===4&&u.stateNode.containerInfo===f.containerInfo&&u.stateNode.implementation===f.implementation){r(d,u.sibling),u=l(u,f.children||[]),u.return=d,d=u;break e}else{r(d,u);break}else t(d,u);u=u.sibling}u=Xa(f,d.mode,C),u.return=d,d=u}return i(d);case yr:return z=f._init,D(d,u,z(f._payload),C)}if(is(f))return h(d,u,f,C);if(Gn(f))return _(d,u,f,C);fl(d,f)}return typeof f=="string"&&f!==""||typeof f=="number"?(f=""+f,u!==null&&u.tag===6?(r(d,u.sibling),u=l(u,f),u.return=d,d=u):(r(d,u),u=qa(f,d.mode,C),u.return=d,d=u),i(d)):r(d,u)}return D}var Dn=Ed(!0),Td=Ed(!1),Wl=Dr(null),Ql=null,kn=null,_o=null;function No(){_o=kn=Ql=null}function So(e){var t=Wl.current;Ce(Wl),e._currentValue=t}function Ri(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function Pn(e,t){Ql=e,_o=kn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ft=!0),e.firstContext=null)}function Tt(e){var t=e._currentValue;if(_o!==e)if(e={context:e,memoizedValue:t,next:null},kn===null){if(Ql===null)throw Error(U(308));kn=e,Ql.dependencies={lanes:0,firstContext:e}}else kn=kn.next=e;return t}var Kr=null;function Co(e){Kr===null?Kr=[e]:Kr.push(e)}function Pd(e,t,r,s){var l=t.interleaved;return l===null?(r.next=r,Co(t)):(r.next=l.next,l.next=r),t.interleaved=r,cr(e,s)}function cr(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var vr=!1;function Eo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $d(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ar(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Er(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,ge&2){var l=s.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),s.pending=t,cr(e,r)}return l=s.interleaved,l===null?(t.next=t,Co(s)):(t.next=l.next,l.next=t),s.interleaved=t,cr(e,r)}function _l(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,mo(e,r)}}function Ac(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var l=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?l=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?l=a=t:a=a.next=t}else l=a=t;r={baseState:s.baseState,firstBaseUpdate:l,lastBaseUpdate:a,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Hl(e,t,r,s){var l=e.updateQueue;vr=!1;var a=l.firstBaseUpdate,i=l.lastBaseUpdate,o=l.shared.pending;if(o!==null){l.shared.pending=null;var c=o,m=c.next;c.next=null,i===null?a=m:i.next=m,i=c;var v=e.alternate;v!==null&&(v=v.updateQueue,o=v.lastBaseUpdate,o!==i&&(o===null?v.firstBaseUpdate=m:o.next=m,v.lastBaseUpdate=c))}if(a!==null){var b=l.baseState;i=0,v=m=c=null,o=a;do{var x=o.lane,E=o.eventTime;if((s&x)===x){v!==null&&(v=v.next={eventTime:E,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var h=e,_=o;switch(x=t,E=r,_.tag){case 1:if(h=_.payload,typeof h=="function"){b=h.call(E,b,x);break e}b=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=_.payload,x=typeof h=="function"?h.call(E,b,x):h,x==null)break e;b=Ae({},b,x);break e;case 2:vr=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,x=l.effects,x===null?l.effects=[o]:x.push(o))}else E={eventTime:E,lane:x,tag:o.tag,payload:o.payload,callback:o.callback,next:null},v===null?(m=v=E,c=b):v=v.next=E,i|=x;if(o=o.next,o===null){if(o=l.shared.pending,o===null)break;x=o,o=x.next,x.next=null,l.lastBaseUpdate=x,l.shared.pending=null}}while(!0);if(v===null&&(c=b),l.baseState=c,l.firstBaseUpdate=m,l.lastBaseUpdate=v,t=l.shared.interleaved,t!==null){l=t;do i|=l.lane,l=l.next;while(l!==t)}else a===null&&(l.shared.lanes=0);en|=i,e.lanes=i,e.memoizedState=b}}function Lc(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],l=s.callback;if(l!==null){if(s.callback=null,s=r,typeof l!="function")throw Error(U(191,l));l.call(s)}}}var Vs={},Xt=Dr(Vs),zs=Dr(Vs),As=Dr(Vs);function Yr(e){if(e===Vs)throw Error(U(174));return e}function To(e,t){switch(_e(As,t),_e(zs,e),_e(Xt,Vs),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:gi(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=gi(t,e)}Ce(Xt),_e(Xt,t)}function Rn(){Ce(Xt),Ce(zs),Ce(As)}function zd(e){Yr(As.current);var t=Yr(Xt.current),r=gi(t,e.type);t!==r&&(_e(zs,e),_e(Xt,r))}function Po(e){zs.current===e&&(Ce(Xt),Ce(zs))}var $e=Dr(0);function Kl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ba=[];function $o(){for(var e=0;e<Ba.length;e++)Ba[e]._workInProgressVersionPrimary=null;Ba.length=0}var Nl=dr.ReactCurrentDispatcher,Wa=dr.ReactCurrentBatchConfig,Zr=0,ze=null,Ve=null,He=null,Yl=!1,gs=!1,Ls=0,_0=0;function et(){throw Error(U(321))}function zo(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ot(e[r],t[r]))return!1;return!0}function Ao(e,t,r,s,l,a){if(Zr=a,ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Nl.current=e===null||e.memoizedState===null?E0:T0,e=r(s,l),gs){a=0;do{if(gs=!1,Ls=0,25<=a)throw Error(U(301));a+=1,He=Ve=null,t.updateQueue=null,Nl.current=P0,e=r(s,l)}while(gs)}if(Nl.current=ql,t=Ve!==null&&Ve.next!==null,Zr=0,He=Ve=ze=null,Yl=!1,t)throw Error(U(300));return e}function Lo(){var e=Ls!==0;return Ls=0,e}function Kt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return He===null?ze.memoizedState=He=e:He=He.next=e,He}function Pt(){if(Ve===null){var e=ze.alternate;e=e!==null?e.memoizedState:null}else e=Ve.next;var t=He===null?ze.memoizedState:He.next;if(t!==null)He=t,Ve=e;else{if(e===null)throw Error(U(310));Ve=e,e={memoizedState:Ve.memoizedState,baseState:Ve.baseState,baseQueue:Ve.baseQueue,queue:Ve.queue,next:null},He===null?ze.memoizedState=He=e:He=He.next=e}return He}function Ds(e,t){return typeof t=="function"?t(e):t}function Qa(e){var t=Pt(),r=t.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=e;var s=Ve,l=s.baseQueue,a=r.pending;if(a!==null){if(l!==null){var i=l.next;l.next=a.next,a.next=i}s.baseQueue=l=a,r.pending=null}if(l!==null){a=l.next,s=s.baseState;var o=i=null,c=null,m=a;do{var v=m.lane;if((Zr&v)===v)c!==null&&(c=c.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),s=m.hasEagerState?m.eagerState:e(s,m.action);else{var b={lane:v,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};c===null?(o=c=b,i=s):c=c.next=b,ze.lanes|=v,en|=v}m=m.next}while(m!==null&&m!==a);c===null?i=s:c.next=o,Ot(s,t.memoizedState)||(ft=!0),t.memoizedState=s,t.baseState=i,t.baseQueue=c,r.lastRenderedState=s}if(e=r.interleaved,e!==null){l=e;do a=l.lane,ze.lanes|=a,en|=a,l=l.next;while(l!==e)}else l===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ha(e){var t=Pt(),r=t.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=e;var s=r.dispatch,l=r.pending,a=t.memoizedState;if(l!==null){r.pending=null;var i=l=l.next;do a=e(a,i.action),i=i.next;while(i!==l);Ot(a,t.memoizedState)||(ft=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,s]}function Ad(){}function Ld(e,t){var r=ze,s=Pt(),l=t(),a=!Ot(s.memoizedState,l);if(a&&(s.memoizedState=l,ft=!0),s=s.queue,Do(Fd.bind(null,r,s,e),[e]),s.getSnapshot!==t||a||He!==null&&He.memoizedState.tag&1){if(r.flags|=2048,Rs(9,Rd.bind(null,r,s,l,t),void 0,null),Ke===null)throw Error(U(349));Zr&30||Dd(r,t,l)}return l}function Dd(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ze.updateQueue,t===null?(t={lastEffect:null,stores:null},ze.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Rd(e,t,r,s){t.value=r,t.getSnapshot=s,Md(t)&&Od(e)}function Fd(e,t,r){return r(function(){Md(t)&&Od(e)})}function Md(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ot(e,r)}catch{return!0}}function Od(e){var t=cr(e,1);t!==null&&Mt(t,e,1,-1)}function Dc(e){var t=Kt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ds,lastRenderedState:e},t.queue=e,e=e.dispatch=C0.bind(null,ze,e),[t.memoizedState,e]}function Rs(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=ze.updateQueue,t===null?(t={lastEffect:null,stores:null},ze.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function Id(){return Pt().memoizedState}function Sl(e,t,r,s){var l=Kt();ze.flags|=e,l.memoizedState=Rs(1|t,r,void 0,s===void 0?null:s)}function oa(e,t,r,s){var l=Pt();s=s===void 0?null:s;var a=void 0;if(Ve!==null){var i=Ve.memoizedState;if(a=i.destroy,s!==null&&zo(s,i.deps)){l.memoizedState=Rs(t,r,a,s);return}}ze.flags|=e,l.memoizedState=Rs(1|t,r,a,s)}function Rc(e,t){return Sl(8390656,8,e,t)}function Do(e,t){return oa(2048,8,e,t)}function Ud(e,t){return oa(4,2,e,t)}function Vd(e,t){return oa(4,4,e,t)}function Bd(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Wd(e,t,r){return r=r!=null?r.concat([e]):null,oa(4,4,Bd.bind(null,t,e),r)}function Ro(){}function Qd(e,t){var r=Pt();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&zo(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function Hd(e,t){var r=Pt();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&zo(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function Kd(e,t,r){return Zr&21?(Ot(r,t)||(r=Ju(),ze.lanes|=r,en|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ft=!0),e.memoizedState=r)}function N0(e,t){var r=ve;ve=r!==0&&4>r?r:4,e(!0);var s=Wa.transition;Wa.transition={};try{e(!1),t()}finally{ve=r,Wa.transition=s}}function Yd(){return Pt().memoizedState}function S0(e,t,r){var s=Pr(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},qd(e))Xd(t,r);else if(r=Pd(e,t,r,s),r!==null){var l=ct();Mt(r,e,s,l),Gd(r,t,s)}}function C0(e,t,r){var s=Pr(e),l={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(qd(e))Xd(t,l);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(l.hasEagerState=!0,l.eagerState=o,Ot(o,i)){var c=t.interleaved;c===null?(l.next=l,Co(t)):(l.next=c.next,c.next=l),t.interleaved=l;return}}catch{}finally{}r=Pd(e,t,l,s),r!==null&&(l=ct(),Mt(r,e,s,l),Gd(r,t,s))}}function qd(e){var t=e.alternate;return e===ze||t!==null&&t===ze}function Xd(e,t){gs=Yl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Gd(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,mo(e,r)}}var ql={readContext:Tt,useCallback:et,useContext:et,useEffect:et,useImperativeHandle:et,useInsertionEffect:et,useLayoutEffect:et,useMemo:et,useReducer:et,useRef:et,useState:et,useDebugValue:et,useDeferredValue:et,useTransition:et,useMutableSource:et,useSyncExternalStore:et,useId:et,unstable_isNewReconciler:!1},E0={readContext:Tt,useCallback:function(e,t){return Kt().memoizedState=[e,t===void 0?null:t],e},useContext:Tt,useEffect:Rc,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Sl(4194308,4,Bd.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Sl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Sl(4,2,e,t)},useMemo:function(e,t){var r=Kt();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=Kt();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=S0.bind(null,ze,e),[s.memoizedState,e]},useRef:function(e){var t=Kt();return e={current:e},t.memoizedState=e},useState:Dc,useDebugValue:Ro,useDeferredValue:function(e){return Kt().memoizedState=e},useTransition:function(){var e=Dc(!1),t=e[0];return e=N0.bind(null,e[1]),Kt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=ze,l=Kt();if(Te){if(r===void 0)throw Error(U(407));r=r()}else{if(r=t(),Ke===null)throw Error(U(349));Zr&30||Dd(s,t,r)}l.memoizedState=r;var a={value:r,getSnapshot:t};return l.queue=a,Rc(Fd.bind(null,s,a,e),[e]),s.flags|=2048,Rs(9,Rd.bind(null,s,a,r,t),void 0,null),r},useId:function(){var e=Kt(),t=Ke.identifierPrefix;if(Te){var r=lr,s=sr;r=(s&~(1<<32-Ft(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ls++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=_0++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},T0={readContext:Tt,useCallback:Qd,useContext:Tt,useEffect:Do,useImperativeHandle:Wd,useInsertionEffect:Ud,useLayoutEffect:Vd,useMemo:Hd,useReducer:Qa,useRef:Id,useState:function(){return Qa(Ds)},useDebugValue:Ro,useDeferredValue:function(e){var t=Pt();return Kd(t,Ve.memoizedState,e)},useTransition:function(){var e=Qa(Ds)[0],t=Pt().memoizedState;return[e,t]},useMutableSource:Ad,useSyncExternalStore:Ld,useId:Yd,unstable_isNewReconciler:!1},P0={readContext:Tt,useCallback:Qd,useContext:Tt,useEffect:Do,useImperativeHandle:Wd,useInsertionEffect:Ud,useLayoutEffect:Vd,useMemo:Hd,useReducer:Ha,useRef:Id,useState:function(){return Ha(Ds)},useDebugValue:Ro,useDeferredValue:function(e){var t=Pt();return Ve===null?t.memoizedState=e:Kd(t,Ve.memoizedState,e)},useTransition:function(){var e=Ha(Ds)[0],t=Pt().memoizedState;return[e,t]},useMutableSource:Ad,useSyncExternalStore:Ld,useId:Yd,unstable_isNewReconciler:!1};function Lt(e,t){if(e&&e.defaultProps){t=Ae({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Fi(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:Ae({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ca={isMounted:function(e){return(e=e._reactInternals)?nn(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=ct(),l=Pr(e),a=ar(s,l);a.payload=t,r!=null&&(a.callback=r),t=Er(e,a,l),t!==null&&(Mt(t,e,l,s),_l(t,e,l))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=ct(),l=Pr(e),a=ar(s,l);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Er(e,a,l),t!==null&&(Mt(t,e,l,s),_l(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ct(),s=Pr(e),l=ar(r,s);l.tag=2,t!=null&&(l.callback=t),t=Er(e,l,s),t!==null&&(Mt(t,e,s,r),_l(t,e,s))}};function Fc(e,t,r,s,l,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,a,i):t.prototype&&t.prototype.isPureReactComponent?!Es(r,s)||!Es(l,a):!0}function Jd(e,t,r){var s=!1,l=Ar,a=t.contextType;return typeof a=="object"&&a!==null?a=Tt(a):(l=gt(t)?Gr:nt.current,s=t.contextTypes,a=(s=s!=null)?An(e,l):Ar),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ca,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=a),t}function Mc(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&ca.enqueueReplaceState(t,t.state,null)}function Mi(e,t,r,s){var l=e.stateNode;l.props=r,l.state=e.memoizedState,l.refs={},Eo(e);var a=t.contextType;typeof a=="object"&&a!==null?l.context=Tt(a):(a=gt(t)?Gr:nt.current,l.context=An(e,a)),l.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Fi(e,t,a,r),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&ca.enqueueReplaceState(l,l.state,null),Hl(e,r,l,s),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function Fn(e,t){try{var r="",s=t;do r+=sm(s),s=s.return;while(s);var l=r}catch(a){l=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:l,digest:null}}function Ka(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Oi(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var $0=typeof WeakMap=="function"?WeakMap:Map;function Zd(e,t,r){r=ar(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){Gl||(Gl=!0,qi=s),Oi(e,t)},r}function ep(e,t,r){r=ar(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var l=t.value;r.payload=function(){return s(l)},r.callback=function(){Oi(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Oi(e,t),typeof s!="function"&&(Tr===null?Tr=new Set([this]):Tr.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Oc(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new $0;var l=new Set;s.set(t,l)}else l=s.get(t),l===void 0&&(l=new Set,s.set(t,l));l.has(r)||(l.add(r),e=Q0.bind(null,e,t,r),t.then(e,e))}function Ic(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Uc(e,t,r,s,l){return e.mode&1?(e.flags|=65536,e.lanes=l,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ar(-1,1),t.tag=2,Er(r,t,1))),r.lanes|=1),e)}var z0=dr.ReactCurrentOwner,ft=!1;function at(e,t,r,s){t.child=e===null?Td(t,null,r,s):Dn(t,e.child,r,s)}function Vc(e,t,r,s,l){r=r.render;var a=t.ref;return Pn(t,l),s=Ao(e,t,r,s,a,l),r=Lo(),e!==null&&!ft?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,ur(e,t,l)):(Te&&r&&bo(t),t.flags|=1,at(e,t,s,l),t.child)}function Bc(e,t,r,s,l){if(e===null){var a=r.type;return typeof a=="function"&&!Wo(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,tp(e,t,a,s,l)):(e=Pl(r.type,null,s,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&l)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Es,r(i,s)&&e.ref===t.ref)return ur(e,t,l)}return t.flags|=1,e=$r(a,s),e.ref=t.ref,e.return=t,t.child=e}function tp(e,t,r,s,l){if(e!==null){var a=e.memoizedProps;if(Es(a,s)&&e.ref===t.ref)if(ft=!1,t.pendingProps=s=a,(e.lanes&l)!==0)e.flags&131072&&(ft=!0);else return t.lanes=e.lanes,ur(e,t,l)}return Ii(e,t,r,s,l)}function rp(e,t,r){var s=t.pendingProps,l=s.children,a=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_e(Nn,yt),yt|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_e(Nn,yt),yt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:r,_e(Nn,yt),yt|=s}else a!==null?(s=a.baseLanes|r,t.memoizedState=null):s=r,_e(Nn,yt),yt|=s;return at(e,t,l,r),t.child}function np(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ii(e,t,r,s,l){var a=gt(r)?Gr:nt.current;return a=An(t,a),Pn(t,l),r=Ao(e,t,r,s,a,l),s=Lo(),e!==null&&!ft?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,ur(e,t,l)):(Te&&s&&bo(t),t.flags|=1,at(e,t,r,l),t.child)}function Wc(e,t,r,s,l){if(gt(r)){var a=!0;Ul(t)}else a=!1;if(Pn(t,l),t.stateNode===null)Cl(e,t),Jd(t,r,s),Mi(t,r,s,l),s=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,m=r.contextType;typeof m=="object"&&m!==null?m=Tt(m):(m=gt(r)?Gr:nt.current,m=An(t,m));var v=r.getDerivedStateFromProps,b=typeof v=="function"||typeof i.getSnapshotBeforeUpdate=="function";b||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==s||c!==m)&&Mc(t,i,s,m),vr=!1;var x=t.memoizedState;i.state=x,Hl(t,s,i,l),c=t.memoizedState,o!==s||x!==c||xt.current||vr?(typeof v=="function"&&(Fi(t,r,v,s),c=t.memoizedState),(o=vr||Fc(t,r,o,s,x,c,m))?(b||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),i.props=s,i.state=c,i.context=m,s=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,$d(e,t),o=t.memoizedProps,m=t.type===t.elementType?o:Lt(t.type,o),i.props=m,b=t.pendingProps,x=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Tt(c):(c=gt(r)?Gr:nt.current,c=An(t,c));var E=r.getDerivedStateFromProps;(v=typeof E=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==b||x!==c)&&Mc(t,i,s,c),vr=!1,x=t.memoizedState,i.state=x,Hl(t,s,i,l);var h=t.memoizedState;o!==b||x!==h||xt.current||vr?(typeof E=="function"&&(Fi(t,r,E,s),h=t.memoizedState),(m=vr||Fc(t,r,m,s,x,h,c)||!1)?(v||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,h,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,h,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=h),i.props=s,i.state=h,i.context=c,s=m):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),s=!1)}return Ui(e,t,r,s,a,l)}function Ui(e,t,r,s,l,a){np(e,t);var i=(t.flags&128)!==0;if(!s&&!i)return l&&Tc(t,r,!1),ur(e,t,a);s=t.stateNode,z0.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&i?(t.child=Dn(t,e.child,null,a),t.child=Dn(t,null,o,a)):at(e,t,o,a),t.memoizedState=s.state,l&&Tc(t,r,!0),t.child}function sp(e){var t=e.stateNode;t.pendingContext?Ec(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Ec(e,t.context,!1),To(e,t.containerInfo)}function Qc(e,t,r,s,l){return Ln(),ko(l),t.flags|=256,at(e,t,r,s),t.child}var Vi={dehydrated:null,treeContext:null,retryLane:0};function Bi(e){return{baseLanes:e,cachePool:null,transitions:null}}function lp(e,t,r){var s=t.pendingProps,l=$e.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(l&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),_e($e,l&1),e===null)return Di(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=s.children,e=s.fallback,a?(s=t.mode,a=t.child,i={mode:"hidden",children:i},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=pa(i,s,0,null),e=Xr(e,s,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Bi(r),t.memoizedState=Vi,e):Fo(t,i));if(l=e.memoizedState,l!==null&&(o=l.dehydrated,o!==null))return A0(e,t,i,s,o,l,r);if(a){a=s.fallback,i=t.mode,l=e.child,o=l.sibling;var c={mode:"hidden",children:s.children};return!(i&1)&&t.child!==l?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=$r(l,c),s.subtreeFlags=l.subtreeFlags&14680064),o!==null?a=$r(o,a):(a=Xr(a,i,r,null),a.flags|=2),a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,i=e.child.memoizedState,i=i===null?Bi(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=Vi,s}return a=e.child,e=a.sibling,s=$r(a,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function Fo(e,t){return t=pa({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function xl(e,t,r,s){return s!==null&&ko(s),Dn(t,e.child,null,r),e=Fo(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function A0(e,t,r,s,l,a,i){if(r)return t.flags&256?(t.flags&=-257,s=Ka(Error(U(422))),xl(e,t,i,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=s.fallback,l=t.mode,s=pa({mode:"visible",children:s.children},l,0,null),a=Xr(a,l,i,null),a.flags|=2,s.return=t,a.return=t,s.sibling=a,t.child=s,t.mode&1&&Dn(t,e.child,null,i),t.child.memoizedState=Bi(i),t.memoizedState=Vi,a);if(!(t.mode&1))return xl(e,t,i,null);if(l.data==="$!"){if(s=l.nextSibling&&l.nextSibling.dataset,s)var o=s.dgst;return s=o,a=Error(U(419)),s=Ka(a,s,void 0),xl(e,t,i,s)}if(o=(i&e.childLanes)!==0,ft||o){if(s=Ke,s!==null){switch(i&-i){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(s.suspendedLanes|i)?0:l,l!==0&&l!==a.retryLane&&(a.retryLane=l,cr(e,l),Mt(s,e,l,-1))}return Bo(),s=Ka(Error(U(421))),xl(e,t,i,s)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=H0.bind(null,e),l._reactRetry=t,null):(e=a.treeContext,vt=Cr(l.nextSibling),wt=t,Te=!0,Rt=null,e!==null&&(Nt[St++]=sr,Nt[St++]=lr,Nt[St++]=Jr,sr=e.id,lr=e.overflow,Jr=t),t=Fo(t,s.children),t.flags|=4096,t)}function Hc(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),Ri(e.return,t,r)}function Ya(e,t,r,s,l){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:l}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=r,a.tailMode=l)}function ap(e,t,r){var s=t.pendingProps,l=s.revealOrder,a=s.tail;if(at(e,t,s.children,r),s=$e.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Hc(e,r,t);else if(e.tag===19)Hc(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(_e($e,s),!(t.mode&1))t.memoizedState=null;else switch(l){case"forwards":for(r=t.child,l=null;r!==null;)e=r.alternate,e!==null&&Kl(e)===null&&(l=r),r=r.sibling;r=l,r===null?(l=t.child,t.child=null):(l=r.sibling,r.sibling=null),Ya(t,!1,l,r,a);break;case"backwards":for(r=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&Kl(e)===null){t.child=l;break}e=l.sibling,l.sibling=r,r=l,l=e}Ya(t,!0,r,null,a);break;case"together":Ya(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Cl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ur(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),en|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(U(153));if(t.child!==null){for(e=t.child,r=$r(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=$r(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function L0(e,t,r){switch(t.tag){case 3:sp(t),Ln();break;case 5:zd(t);break;case 1:gt(t.type)&&Ul(t);break;case 4:To(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,l=t.memoizedProps.value;_e(Wl,s._currentValue),s._currentValue=l;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(_e($e,$e.current&1),t.flags|=128,null):r&t.child.childLanes?lp(e,t,r):(_e($e,$e.current&1),e=ur(e,t,r),e!==null?e.sibling:null);_e($e,$e.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return ap(e,t,r);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),_e($e,$e.current),s)break;return null;case 22:case 23:return t.lanes=0,rp(e,t,r)}return ur(e,t,r)}var ip,Wi,op,cp;ip=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Wi=function(){};op=function(e,t,r,s){var l=e.memoizedProps;if(l!==s){e=t.stateNode,Yr(Xt.current);var a=null;switch(r){case"input":l=pi(e,l),s=pi(e,s),a=[];break;case"select":l=Ae({},l,{value:void 0}),s=Ae({},s,{value:void 0}),a=[];break;case"textarea":l=xi(e,l),s=xi(e,s),a=[];break;default:typeof l.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Ol)}hi(r,s);var i;r=null;for(m in l)if(!s.hasOwnProperty(m)&&l.hasOwnProperty(m)&&l[m]!=null)if(m==="style"){var o=l[m];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(bs.hasOwnProperty(m)?a||(a=[]):(a=a||[]).push(m,null));for(m in s){var c=s[m];if(o=l!=null?l[m]:void 0,s.hasOwnProperty(m)&&c!==o&&(c!=null||o!=null))if(m==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(m,r)),r=c;else m==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(m,c)):m==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(m,""+c):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(bs.hasOwnProperty(m)?(c!=null&&m==="onScroll"&&Se("scroll",e),a||o===c||(a=[])):(a=a||[]).push(m,c))}r&&(a=a||[]).push("style",r);var m=a;(t.updateQueue=m)&&(t.flags|=4)}};cp=function(e,t,r,s){r!==s&&(t.flags|=4)};function ns(e,t){if(!Te)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function tt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var l=e.child;l!==null;)r|=l.lanes|l.childLanes,s|=l.subtreeFlags&14680064,s|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)r|=l.lanes|l.childLanes,s|=l.subtreeFlags,s|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function D0(e,t,r){var s=t.pendingProps;switch(jo(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tt(t),null;case 1:return gt(t.type)&&Il(),tt(t),null;case 3:return s=t.stateNode,Rn(),Ce(xt),Ce(nt),$o(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(ml(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Rt!==null&&(Ji(Rt),Rt=null))),Wi(e,t),tt(t),null;case 5:Po(t);var l=Yr(As.current);if(r=t.type,e!==null&&t.stateNode!=null)op(e,t,r,s,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(U(166));return tt(t),null}if(e=Yr(Xt.current),ml(t)){s=t.stateNode,r=t.type;var a=t.memoizedProps;switch(s[Yt]=t,s[$s]=a,e=(t.mode&1)!==0,r){case"dialog":Se("cancel",s),Se("close",s);break;case"iframe":case"object":case"embed":Se("load",s);break;case"video":case"audio":for(l=0;l<cs.length;l++)Se(cs[l],s);break;case"source":Se("error",s);break;case"img":case"image":case"link":Se("error",s),Se("load",s);break;case"details":Se("toggle",s);break;case"input":tc(s,a),Se("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},Se("invalid",s);break;case"textarea":nc(s,a),Se("invalid",s)}hi(r,a),l=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?s.textContent!==o&&(a.suppressHydrationWarning!==!0&&pl(s.textContent,o,e),l=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&pl(s.textContent,o,e),l=["children",""+o]):bs.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Se("scroll",s)}switch(r){case"input":sl(s),rc(s,a,!0);break;case"textarea":sl(s),sc(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=Ol)}s=l,t.updateQueue=s,s!==null&&(t.flags|=4)}else{i=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Fu(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=i.createElement(r,{is:s.is}):(e=i.createElement(r),r==="select"&&(i=e,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):e=i.createElementNS(e,r),e[Yt]=t,e[$s]=s,ip(e,t,!1,!1),t.stateNode=e;e:{switch(i=yi(r,s),r){case"dialog":Se("cancel",e),Se("close",e),l=s;break;case"iframe":case"object":case"embed":Se("load",e),l=s;break;case"video":case"audio":for(l=0;l<cs.length;l++)Se(cs[l],e);l=s;break;case"source":Se("error",e),l=s;break;case"img":case"image":case"link":Se("error",e),Se("load",e),l=s;break;case"details":Se("toggle",e),l=s;break;case"input":tc(e,s),l=pi(e,s),Se("invalid",e);break;case"option":l=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},l=Ae({},s,{value:void 0}),Se("invalid",e);break;case"textarea":nc(e,s),l=xi(e,s),Se("invalid",e);break;default:l=s}hi(r,l),o=l;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?Iu(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Mu(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&js(e,c):typeof c=="number"&&js(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(bs.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Se("scroll",e):c!=null&&ao(e,a,c,i))}switch(r){case"input":sl(e),rc(e,s,!1);break;case"textarea":sl(e),sc(e);break;case"option":s.value!=null&&e.setAttribute("value",""+zr(s.value));break;case"select":e.multiple=!!s.multiple,a=s.value,a!=null?Sn(e,!!s.multiple,a,!1):s.defaultValue!=null&&Sn(e,!!s.multiple,s.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=Ol)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return tt(t),null;case 6:if(e&&t.stateNode!=null)cp(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(U(166));if(r=Yr(As.current),Yr(Xt.current),ml(t)){if(s=t.stateNode,r=t.memoizedProps,s[Yt]=t,(a=s.nodeValue!==r)&&(e=wt,e!==null))switch(e.tag){case 3:pl(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&pl(s.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[Yt]=t,t.stateNode=s}return tt(t),null;case 13:if(Ce($e),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Te&&vt!==null&&t.mode&1&&!(t.flags&128))Cd(),Ln(),t.flags|=98560,a=!1;else if(a=ml(t),s!==null&&s.dehydrated!==null){if(e===null){if(!a)throw Error(U(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(U(317));a[Yt]=t}else Ln(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;tt(t),a=!1}else Rt!==null&&(Ji(Rt),Rt=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||$e.current&1?Be===0&&(Be=3):Bo())),t.updateQueue!==null&&(t.flags|=4),tt(t),null);case 4:return Rn(),Wi(e,t),e===null&&Ts(t.stateNode.containerInfo),tt(t),null;case 10:return So(t.type._context),tt(t),null;case 17:return gt(t.type)&&Il(),tt(t),null;case 19:if(Ce($e),a=t.memoizedState,a===null)return tt(t),null;if(s=(t.flags&128)!==0,i=a.rendering,i===null)if(s)ns(a,!1);else{if(Be!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Kl(e),i!==null){for(t.flags|=128,ns(a,!1),s=i.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)a=r,e=s,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return _e($e,$e.current&1|2),t.child}e=e.sibling}a.tail!==null&&Me()>Mn&&(t.flags|=128,s=!0,ns(a,!1),t.lanes=4194304)}else{if(!s)if(e=Kl(i),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ns(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Te)return tt(t),null}else 2*Me()-a.renderingStartTime>Mn&&r!==1073741824&&(t.flags|=128,s=!0,ns(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Me(),t.sibling=null,r=$e.current,_e($e,s?r&1|2:r&1),t):(tt(t),null);case 22:case 23:return Vo(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?yt&1073741824&&(tt(t),t.subtreeFlags&6&&(t.flags|=8192)):tt(t),null;case 24:return null;case 25:return null}throw Error(U(156,t.tag))}function R0(e,t){switch(jo(t),t.tag){case 1:return gt(t.type)&&Il(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Rn(),Ce(xt),Ce(nt),$o(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Po(t),null;case 13:if(Ce($e),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(U(340));Ln()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ce($e),null;case 4:return Rn(),null;case 10:return So(t.type._context),null;case 22:case 23:return Vo(),null;case 24:return null;default:return null}}var gl=!1,rt=!1,F0=typeof WeakSet=="function"?WeakSet:Set,q=null;function _n(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){De(e,t,s)}else r.current=null}function Qi(e,t,r){try{r()}catch(s){De(e,t,s)}}var Kc=!1;function M0(e,t){if(Ei=Rl,e=fd(),wo(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var l=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,c=-1,m=0,v=0,b=e,x=null;t:for(;;){for(var E;b!==r||l!==0&&b.nodeType!==3||(o=i+l),b!==a||s!==0&&b.nodeType!==3||(c=i+s),b.nodeType===3&&(i+=b.nodeValue.length),(E=b.firstChild)!==null;)x=b,b=E;for(;;){if(b===e)break t;if(x===r&&++m===l&&(o=i),x===a&&++v===s&&(c=i),(E=b.nextSibling)!==null)break;b=x,x=b.parentNode}b=E}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ti={focusedElem:e,selectionRange:r},Rl=!1,q=t;q!==null;)if(t=q,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,q=e;else for(;q!==null;){t=q;try{var h=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var _=h.memoizedProps,D=h.memoizedState,d=t.stateNode,u=d.getSnapshotBeforeUpdate(t.elementType===t.type?_:Lt(t.type,_),D);d.__reactInternalSnapshotBeforeUpdate=u}break;case 3:var f=t.stateNode.containerInfo;f.nodeType===1?f.textContent="":f.nodeType===9&&f.documentElement&&f.removeChild(f.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(C){De(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,q=e;break}q=t.return}return h=Kc,Kc=!1,h}function hs(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&e)===e){var a=l.destroy;l.destroy=void 0,a!==void 0&&Qi(t,r,a)}l=l.next}while(l!==s)}}function ua(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function Hi(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function up(e){var t=e.alternate;t!==null&&(e.alternate=null,up(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Yt],delete t[$s],delete t[zi],delete t[w0],delete t[b0])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dp(e){return e.tag===5||e.tag===3||e.tag===4}function Yc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ki(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ol));else if(s!==4&&(e=e.child,e!==null))for(Ki(e,t,r),e=e.sibling;e!==null;)Ki(e,t,r),e=e.sibling}function Yi(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Yi(e,t,r),e=e.sibling;e!==null;)Yi(e,t,r),e=e.sibling}var Ye=null,Dt=!1;function gr(e,t,r){for(r=r.child;r!==null;)pp(e,t,r),r=r.sibling}function pp(e,t,r){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(ra,r)}catch{}switch(r.tag){case 5:rt||_n(r,t);case 6:var s=Ye,l=Dt;Ye=null,gr(e,t,r),Ye=s,Dt=l,Ye!==null&&(Dt?(e=Ye,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ye.removeChild(r.stateNode));break;case 18:Ye!==null&&(Dt?(e=Ye,r=r.stateNode,e.nodeType===8?Ua(e.parentNode,r):e.nodeType===1&&Ua(e,r),Ss(e)):Ua(Ye,r.stateNode));break;case 4:s=Ye,l=Dt,Ye=r.stateNode.containerInfo,Dt=!0,gr(e,t,r),Ye=s,Dt=l;break;case 0:case 11:case 14:case 15:if(!rt&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){l=s=s.next;do{var a=l,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Qi(r,t,i),l=l.next}while(l!==s)}gr(e,t,r);break;case 1:if(!rt&&(_n(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(o){De(r,t,o)}gr(e,t,r);break;case 21:gr(e,t,r);break;case 22:r.mode&1?(rt=(s=rt)||r.memoizedState!==null,gr(e,t,r),rt=s):gr(e,t,r);break;default:gr(e,t,r)}}function qc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new F0),t.forEach(function(s){var l=K0.bind(null,e,s);r.has(s)||(r.add(s),s.then(l,l))})}}function At(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var l=r[s];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Ye=o.stateNode,Dt=!1;break e;case 3:Ye=o.stateNode.containerInfo,Dt=!0;break e;case 4:Ye=o.stateNode.containerInfo,Dt=!0;break e}o=o.return}if(Ye===null)throw Error(U(160));pp(a,i,l),Ye=null,Dt=!1;var c=l.alternate;c!==null&&(c.return=null),l.return=null}catch(m){De(l,t,m)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)mp(t,e),t=t.sibling}function mp(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(At(t,e),Ht(e),s&4){try{hs(3,e,e.return),ua(3,e)}catch(_){De(e,e.return,_)}try{hs(5,e,e.return)}catch(_){De(e,e.return,_)}}break;case 1:At(t,e),Ht(e),s&512&&r!==null&&_n(r,r.return);break;case 5:if(At(t,e),Ht(e),s&512&&r!==null&&_n(r,r.return),e.flags&32){var l=e.stateNode;try{js(l,"")}catch(_){De(e,e.return,_)}}if(s&4&&(l=e.stateNode,l!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&Du(l,a),yi(o,i);var m=yi(o,a);for(i=0;i<c.length;i+=2){var v=c[i],b=c[i+1];v==="style"?Iu(l,b):v==="dangerouslySetInnerHTML"?Mu(l,b):v==="children"?js(l,b):ao(l,v,b,m)}switch(o){case"input":mi(l,a);break;case"textarea":Ru(l,a);break;case"select":var x=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!a.multiple;var E=a.value;E!=null?Sn(l,!!a.multiple,E,!1):x!==!!a.multiple&&(a.defaultValue!=null?Sn(l,!!a.multiple,a.defaultValue,!0):Sn(l,!!a.multiple,a.multiple?[]:"",!1))}l[$s]=a}catch(_){De(e,e.return,_)}}break;case 6:if(At(t,e),Ht(e),s&4){if(e.stateNode===null)throw Error(U(162));l=e.stateNode,a=e.memoizedProps;try{l.nodeValue=a}catch(_){De(e,e.return,_)}}break;case 3:if(At(t,e),Ht(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Ss(t.containerInfo)}catch(_){De(e,e.return,_)}break;case 4:At(t,e),Ht(e);break;case 13:At(t,e),Ht(e),l=e.child,l.flags&8192&&(a=l.memoizedState!==null,l.stateNode.isHidden=a,!a||l.alternate!==null&&l.alternate.memoizedState!==null||(Io=Me())),s&4&&qc(e);break;case 22:if(v=r!==null&&r.memoizedState!==null,e.mode&1?(rt=(m=rt)||v,At(t,e),rt=m):At(t,e),Ht(e),s&8192){if(m=e.memoizedState!==null,(e.stateNode.isHidden=m)&&!v&&e.mode&1)for(q=e,v=e.child;v!==null;){for(b=q=v;q!==null;){switch(x=q,E=x.child,x.tag){case 0:case 11:case 14:case 15:hs(4,x,x.return);break;case 1:_n(x,x.return);var h=x.stateNode;if(typeof h.componentWillUnmount=="function"){s=x,r=x.return;try{t=s,h.props=t.memoizedProps,h.state=t.memoizedState,h.componentWillUnmount()}catch(_){De(s,r,_)}}break;case 5:_n(x,x.return);break;case 22:if(x.memoizedState!==null){Gc(b);continue}}E!==null?(E.return=x,q=E):Gc(b)}v=v.sibling}e:for(v=null,b=e;;){if(b.tag===5){if(v===null){v=b;try{l=b.stateNode,m?(a=l.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=b.stateNode,c=b.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=Ou("display",i))}catch(_){De(e,e.return,_)}}}else if(b.tag===6){if(v===null)try{b.stateNode.nodeValue=m?"":b.memoizedProps}catch(_){De(e,e.return,_)}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===e)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===e)break e;for(;b.sibling===null;){if(b.return===null||b.return===e)break e;v===b&&(v=null),b=b.return}v===b&&(v=null),b.sibling.return=b.return,b=b.sibling}}break;case 19:At(t,e),Ht(e),s&4&&qc(e);break;case 21:break;default:At(t,e),Ht(e)}}function Ht(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(dp(r)){var s=r;break e}r=r.return}throw Error(U(160))}switch(s.tag){case 5:var l=s.stateNode;s.flags&32&&(js(l,""),s.flags&=-33);var a=Yc(e);Yi(e,a,l);break;case 3:case 4:var i=s.stateNode.containerInfo,o=Yc(e);Ki(e,o,i);break;default:throw Error(U(161))}}catch(c){De(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function O0(e,t,r){q=e,fp(e)}function fp(e,t,r){for(var s=(e.mode&1)!==0;q!==null;){var l=q,a=l.child;if(l.tag===22&&s){var i=l.memoizedState!==null||gl;if(!i){var o=l.alternate,c=o!==null&&o.memoizedState!==null||rt;o=gl;var m=rt;if(gl=i,(rt=c)&&!m)for(q=l;q!==null;)i=q,c=i.child,i.tag===22&&i.memoizedState!==null?Jc(l):c!==null?(c.return=i,q=c):Jc(l);for(;a!==null;)q=a,fp(a),a=a.sibling;q=l,gl=o,rt=m}Xc(e)}else l.subtreeFlags&8772&&a!==null?(a.return=l,q=a):Xc(e)}}function Xc(e){for(;q!==null;){var t=q;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:rt||ua(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!rt)if(r===null)s.componentDidMount();else{var l=t.elementType===t.type?r.memoizedProps:Lt(t.type,r.memoizedProps);s.componentDidUpdate(l,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Lc(t,a,s);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Lc(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var m=t.alternate;if(m!==null){var v=m.memoizedState;if(v!==null){var b=v.dehydrated;b!==null&&Ss(b)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}rt||t.flags&512&&Hi(t)}catch(x){De(t,t.return,x)}}if(t===e){q=null;break}if(r=t.sibling,r!==null){r.return=t.return,q=r;break}q=t.return}}function Gc(e){for(;q!==null;){var t=q;if(t===e){q=null;break}var r=t.sibling;if(r!==null){r.return=t.return,q=r;break}q=t.return}}function Jc(e){for(;q!==null;){var t=q;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ua(4,t)}catch(c){De(t,r,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var l=t.return;try{s.componentDidMount()}catch(c){De(t,l,c)}}var a=t.return;try{Hi(t)}catch(c){De(t,a,c)}break;case 5:var i=t.return;try{Hi(t)}catch(c){De(t,i,c)}}}catch(c){De(t,t.return,c)}if(t===e){q=null;break}var o=t.sibling;if(o!==null){o.return=t.return,q=o;break}q=t.return}}var I0=Math.ceil,Xl=dr.ReactCurrentDispatcher,Mo=dr.ReactCurrentOwner,Et=dr.ReactCurrentBatchConfig,ge=0,Ke=null,Ie=null,qe=0,yt=0,Nn=Dr(0),Be=0,Fs=null,en=0,da=0,Oo=0,ys=null,mt=null,Io=0,Mn=1/0,rr=null,Gl=!1,qi=null,Tr=null,hl=!1,kr=null,Jl=0,vs=0,Xi=null,El=-1,Tl=0;function ct(){return ge&6?Me():El!==-1?El:El=Me()}function Pr(e){return e.mode&1?ge&2&&qe!==0?qe&-qe:k0.transition!==null?(Tl===0&&(Tl=Ju()),Tl):(e=ve,e!==0||(e=window.event,e=e===void 0?16:ld(e.type)),e):1}function Mt(e,t,r,s){if(50<vs)throw vs=0,Xi=null,Error(U(185));Os(e,r,s),(!(ge&2)||e!==Ke)&&(e===Ke&&(!(ge&2)&&(da|=r),Be===4&&br(e,qe)),ht(e,s),r===1&&ge===0&&!(t.mode&1)&&(Mn=Me()+500,ia&&Rr()))}function ht(e,t){var r=e.callbackNode;km(e,t);var s=Dl(e,e===Ke?qe:0);if(s===0)r!==null&&ic(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&ic(r),t===1)e.tag===0?j0(Zc.bind(null,e)):_d(Zc.bind(null,e)),y0(function(){!(ge&6)&&Rr()}),r=null;else{switch(Zu(s)){case 1:r=po;break;case 4:r=Xu;break;case 16:r=Ll;break;case 536870912:r=Gu;break;default:r=Ll}r=jp(r,xp.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function xp(e,t){if(El=-1,Tl=0,ge&6)throw Error(U(327));var r=e.callbackNode;if($n()&&e.callbackNode!==r)return null;var s=Dl(e,e===Ke?qe:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Zl(e,s);else{t=s;var l=ge;ge|=2;var a=hp();(Ke!==e||qe!==t)&&(rr=null,Mn=Me()+500,qr(e,t));do try{B0();break}catch(o){gp(e,o)}while(!0);No(),Xl.current=a,ge=l,Ie!==null?t=0:(Ke=null,qe=0,t=Be)}if(t!==0){if(t===2&&(l=ki(e),l!==0&&(s=l,t=Gi(e,l))),t===1)throw r=Fs,qr(e,0),br(e,s),ht(e,Me()),r;if(t===6)br(e,s);else{if(l=e.current.alternate,!(s&30)&&!U0(l)&&(t=Zl(e,s),t===2&&(a=ki(e),a!==0&&(s=a,t=Gi(e,a))),t===1))throw r=Fs,qr(e,0),br(e,s),ht(e,Me()),r;switch(e.finishedWork=l,e.finishedLanes=s,t){case 0:case 1:throw Error(U(345));case 2:Qr(e,mt,rr);break;case 3:if(br(e,s),(s&130023424)===s&&(t=Io+500-Me(),10<t)){if(Dl(e,0)!==0)break;if(l=e.suspendedLanes,(l&s)!==s){ct(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=$i(Qr.bind(null,e,mt,rr),t);break}Qr(e,mt,rr);break;case 4:if(br(e,s),(s&4194240)===s)break;for(t=e.eventTimes,l=-1;0<s;){var i=31-Ft(s);a=1<<i,i=t[i],i>l&&(l=i),s&=~a}if(s=l,s=Me()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*I0(s/1960))-s,10<s){e.timeoutHandle=$i(Qr.bind(null,e,mt,rr),s);break}Qr(e,mt,rr);break;case 5:Qr(e,mt,rr);break;default:throw Error(U(329))}}}return ht(e,Me()),e.callbackNode===r?xp.bind(null,e):null}function Gi(e,t){var r=ys;return e.current.memoizedState.isDehydrated&&(qr(e,t).flags|=256),e=Zl(e,t),e!==2&&(t=mt,mt=r,t!==null&&Ji(t)),e}function Ji(e){mt===null?mt=e:mt.push.apply(mt,e)}function U0(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var l=r[s],a=l.getSnapshot;l=l.value;try{if(!Ot(a(),l))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function br(e,t){for(t&=~Oo,t&=~da,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ft(t),s=1<<r;e[r]=-1,t&=~s}}function Zc(e){if(ge&6)throw Error(U(327));$n();var t=Dl(e,0);if(!(t&1))return ht(e,Me()),null;var r=Zl(e,t);if(e.tag!==0&&r===2){var s=ki(e);s!==0&&(t=s,r=Gi(e,s))}if(r===1)throw r=Fs,qr(e,0),br(e,t),ht(e,Me()),r;if(r===6)throw Error(U(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Qr(e,mt,rr),ht(e,Me()),null}function Uo(e,t){var r=ge;ge|=1;try{return e(t)}finally{ge=r,ge===0&&(Mn=Me()+500,ia&&Rr())}}function tn(e){kr!==null&&kr.tag===0&&!(ge&6)&&$n();var t=ge;ge|=1;var r=Et.transition,s=ve;try{if(Et.transition=null,ve=1,e)return e()}finally{ve=s,Et.transition=r,ge=t,!(ge&6)&&Rr()}}function Vo(){yt=Nn.current,Ce(Nn)}function qr(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,h0(r)),Ie!==null)for(r=Ie.return;r!==null;){var s=r;switch(jo(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Il();break;case 3:Rn(),Ce(xt),Ce(nt),$o();break;case 5:Po(s);break;case 4:Rn();break;case 13:Ce($e);break;case 19:Ce($e);break;case 10:So(s.type._context);break;case 22:case 23:Vo()}r=r.return}if(Ke=e,Ie=e=$r(e.current,null),qe=yt=t,Be=0,Fs=null,Oo=da=en=0,mt=ys=null,Kr!==null){for(t=0;t<Kr.length;t++)if(r=Kr[t],s=r.interleaved,s!==null){r.interleaved=null;var l=s.next,a=r.pending;if(a!==null){var i=a.next;a.next=l,s.next=i}r.pending=s}Kr=null}return e}function gp(e,t){do{var r=Ie;try{if(No(),Nl.current=ql,Yl){for(var s=ze.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Yl=!1}if(Zr=0,He=Ve=ze=null,gs=!1,Ls=0,Mo.current=null,r===null||r.return===null){Be=1,Fs=t,Ie=null;break}e:{var a=e,i=r.return,o=r,c=t;if(t=qe,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var m=c,v=o,b=v.tag;if(!(v.mode&1)&&(b===0||b===11||b===15)){var x=v.alternate;x?(v.updateQueue=x.updateQueue,v.memoizedState=x.memoizedState,v.lanes=x.lanes):(v.updateQueue=null,v.memoizedState=null)}var E=Ic(i);if(E!==null){E.flags&=-257,Uc(E,i,o,a,t),E.mode&1&&Oc(a,m,t),t=E,c=m;var h=t.updateQueue;if(h===null){var _=new Set;_.add(c),t.updateQueue=_}else h.add(c);break e}else{if(!(t&1)){Oc(a,m,t),Bo();break e}c=Error(U(426))}}else if(Te&&o.mode&1){var D=Ic(i);if(D!==null){!(D.flags&65536)&&(D.flags|=256),Uc(D,i,o,a,t),ko(Fn(c,o));break e}}a=c=Fn(c,o),Be!==4&&(Be=2),ys===null?ys=[a]:ys.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var d=Zd(a,c,t);Ac(a,d);break e;case 1:o=c;var u=a.type,f=a.stateNode;if(!(a.flags&128)&&(typeof u.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Tr===null||!Tr.has(f)))){a.flags|=65536,t&=-t,a.lanes|=t;var C=ep(a,o,t);Ac(a,C);break e}}a=a.return}while(a!==null)}vp(r)}catch(A){t=A,Ie===r&&r!==null&&(Ie=r=r.return);continue}break}while(!0)}function hp(){var e=Xl.current;return Xl.current=ql,e===null?ql:e}function Bo(){(Be===0||Be===3||Be===2)&&(Be=4),Ke===null||!(en&268435455)&&!(da&268435455)||br(Ke,qe)}function Zl(e,t){var r=ge;ge|=2;var s=hp();(Ke!==e||qe!==t)&&(rr=null,qr(e,t));do try{V0();break}catch(l){gp(e,l)}while(!0);if(No(),ge=r,Xl.current=s,Ie!==null)throw Error(U(261));return Ke=null,qe=0,Be}function V0(){for(;Ie!==null;)yp(Ie)}function B0(){for(;Ie!==null&&!fm();)yp(Ie)}function yp(e){var t=bp(e.alternate,e,yt);e.memoizedProps=e.pendingProps,t===null?vp(e):Ie=t,Mo.current=null}function vp(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=R0(r,t),r!==null){r.flags&=32767,Ie=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Be=6,Ie=null;return}}else if(r=D0(r,t,yt),r!==null){Ie=r;return}if(t=t.sibling,t!==null){Ie=t;return}Ie=t=e}while(t!==null);Be===0&&(Be=5)}function Qr(e,t,r){var s=ve,l=Et.transition;try{Et.transition=null,ve=1,W0(e,t,r,s)}finally{Et.transition=l,ve=s}return null}function W0(e,t,r,s){do $n();while(kr!==null);if(ge&6)throw Error(U(327));r=e.finishedWork;var l=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(U(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(_m(e,a),e===Ke&&(Ie=Ke=null,qe=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||hl||(hl=!0,jp(Ll,function(){return $n(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Et.transition,Et.transition=null;var i=ve;ve=1;var o=ge;ge|=4,Mo.current=null,M0(e,r),mp(r,e),u0(Ti),Rl=!!Ei,Ti=Ei=null,e.current=r,O0(r),xm(),ge=o,ve=i,Et.transition=a}else e.current=r;if(hl&&(hl=!1,kr=e,Jl=l),a=e.pendingLanes,a===0&&(Tr=null),ym(r.stateNode),ht(e,Me()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)l=t[r],s(l.value,{componentStack:l.stack,digest:l.digest});if(Gl)throw Gl=!1,e=qi,qi=null,e;return Jl&1&&e.tag!==0&&$n(),a=e.pendingLanes,a&1?e===Xi?vs++:(vs=0,Xi=e):vs=0,Rr(),null}function $n(){if(kr!==null){var e=Zu(Jl),t=Et.transition,r=ve;try{if(Et.transition=null,ve=16>e?16:e,kr===null)var s=!1;else{if(e=kr,kr=null,Jl=0,ge&6)throw Error(U(331));var l=ge;for(ge|=4,q=e.current;q!==null;){var a=q,i=a.child;if(q.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var m=o[c];for(q=m;q!==null;){var v=q;switch(v.tag){case 0:case 11:case 15:hs(8,v,a)}var b=v.child;if(b!==null)b.return=v,q=b;else for(;q!==null;){v=q;var x=v.sibling,E=v.return;if(up(v),v===m){q=null;break}if(x!==null){x.return=E,q=x;break}q=E}}}var h=a.alternate;if(h!==null){var _=h.child;if(_!==null){h.child=null;do{var D=_.sibling;_.sibling=null,_=D}while(_!==null)}}q=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,q=i;else e:for(;q!==null;){if(a=q,a.flags&2048)switch(a.tag){case 0:case 11:case 15:hs(9,a,a.return)}var d=a.sibling;if(d!==null){d.return=a.return,q=d;break e}q=a.return}}var u=e.current;for(q=u;q!==null;){i=q;var f=i.child;if(i.subtreeFlags&2064&&f!==null)f.return=i,q=f;else e:for(i=u;q!==null;){if(o=q,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:ua(9,o)}}catch(A){De(o,o.return,A)}if(o===i){q=null;break e}var C=o.sibling;if(C!==null){C.return=o.return,q=C;break e}q=o.return}}if(ge=l,Rr(),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(ra,e)}catch{}s=!0}return s}finally{ve=r,Et.transition=t}}return!1}function eu(e,t,r){t=Fn(r,t),t=Zd(e,t,1),e=Er(e,t,1),t=ct(),e!==null&&(Os(e,1,t),ht(e,t))}function De(e,t,r){if(e.tag===3)eu(e,e,r);else for(;t!==null;){if(t.tag===3){eu(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Tr===null||!Tr.has(s))){e=Fn(r,e),e=ep(t,e,1),t=Er(t,e,1),e=ct(),t!==null&&(Os(t,1,e),ht(t,e));break}}t=t.return}}function Q0(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=ct(),e.pingedLanes|=e.suspendedLanes&r,Ke===e&&(qe&r)===r&&(Be===4||Be===3&&(qe&130023424)===qe&&500>Me()-Io?qr(e,0):Oo|=r),ht(e,t)}function wp(e,t){t===0&&(e.mode&1?(t=il,il<<=1,!(il&130023424)&&(il=4194304)):t=1);var r=ct();e=cr(e,t),e!==null&&(Os(e,t,r),ht(e,r))}function H0(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),wp(e,r)}function K0(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,l=e.memoizedState;l!==null&&(r=l.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(U(314))}s!==null&&s.delete(t),wp(e,r)}var bp;bp=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||xt.current)ft=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ft=!1,L0(e,t,r);ft=!!(e.flags&131072)}else ft=!1,Te&&t.flags&1048576&&Nd(t,Bl,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Cl(e,t),e=t.pendingProps;var l=An(t,nt.current);Pn(t,r),l=Ao(null,t,s,e,l,r);var a=Lo();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,gt(s)?(a=!0,Ul(t)):a=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,Eo(t),l.updater=ca,t.stateNode=l,l._reactInternals=t,Mi(t,s,e,r),t=Ui(null,t,s,!0,a,r)):(t.tag=0,Te&&a&&bo(t),at(null,t,l,r),t=t.child),t;case 16:s=t.elementType;e:{switch(Cl(e,t),e=t.pendingProps,l=s._init,s=l(s._payload),t.type=s,l=t.tag=q0(s),e=Lt(s,e),l){case 0:t=Ii(null,t,s,e,r);break e;case 1:t=Wc(null,t,s,e,r);break e;case 11:t=Vc(null,t,s,e,r);break e;case 14:t=Bc(null,t,s,Lt(s.type,e),r);break e}throw Error(U(306,s,""))}return t;case 0:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:Lt(s,l),Ii(e,t,s,l,r);case 1:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:Lt(s,l),Wc(e,t,s,l,r);case 3:e:{if(sp(t),e===null)throw Error(U(387));s=t.pendingProps,a=t.memoizedState,l=a.element,$d(e,t),Hl(t,s,null,r);var i=t.memoizedState;if(s=i.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){l=Fn(Error(U(423)),t),t=Qc(e,t,s,r,l);break e}else if(s!==l){l=Fn(Error(U(424)),t),t=Qc(e,t,s,r,l);break e}else for(vt=Cr(t.stateNode.containerInfo.firstChild),wt=t,Te=!0,Rt=null,r=Td(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ln(),s===l){t=ur(e,t,r);break e}at(e,t,s,r)}t=t.child}return t;case 5:return zd(t),e===null&&Di(t),s=t.type,l=t.pendingProps,a=e!==null?e.memoizedProps:null,i=l.children,Pi(s,l)?i=null:a!==null&&Pi(s,a)&&(t.flags|=32),np(e,t),at(e,t,i,r),t.child;case 6:return e===null&&Di(t),null;case 13:return lp(e,t,r);case 4:return To(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Dn(t,null,s,r):at(e,t,s,r),t.child;case 11:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:Lt(s,l),Vc(e,t,s,l,r);case 7:return at(e,t,t.pendingProps,r),t.child;case 8:return at(e,t,t.pendingProps.children,r),t.child;case 12:return at(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,l=t.pendingProps,a=t.memoizedProps,i=l.value,_e(Wl,s._currentValue),s._currentValue=i,a!==null)if(Ot(a.value,i)){if(a.children===l.children&&!xt.current){t=ur(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===s){if(a.tag===1){c=ar(-1,r&-r),c.tag=2;var m=a.updateQueue;if(m!==null){m=m.shared;var v=m.pending;v===null?c.next=c:(c.next=v.next,v.next=c),m.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),Ri(a.return,r,t),o.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(U(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Ri(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}at(e,t,l.children,r),t=t.child}return t;case 9:return l=t.type,s=t.pendingProps.children,Pn(t,r),l=Tt(l),s=s(l),t.flags|=1,at(e,t,s,r),t.child;case 14:return s=t.type,l=Lt(s,t.pendingProps),l=Lt(s.type,l),Bc(e,t,s,l,r);case 15:return tp(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:Lt(s,l),Cl(e,t),t.tag=1,gt(s)?(e=!0,Ul(t)):e=!1,Pn(t,r),Jd(t,s,l),Mi(t,s,l,r),Ui(null,t,s,!0,e,r);case 19:return ap(e,t,r);case 22:return rp(e,t,r)}throw Error(U(156,t.tag))};function jp(e,t){return qu(e,t)}function Y0(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ct(e,t,r,s){return new Y0(e,t,r,s)}function Wo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function q0(e){if(typeof e=="function")return Wo(e)?1:0;if(e!=null){if(e=e.$$typeof,e===oo)return 11;if(e===co)return 14}return 2}function $r(e,t){var r=e.alternate;return r===null?(r=Ct(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Pl(e,t,r,s,l,a){var i=2;if(s=e,typeof e=="function")Wo(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case xn:return Xr(r.children,l,a,t);case io:i=8,l|=8;break;case oi:return e=Ct(12,r,t,l|2),e.elementType=oi,e.lanes=a,e;case ci:return e=Ct(13,r,t,l),e.elementType=ci,e.lanes=a,e;case ui:return e=Ct(19,r,t,l),e.elementType=ui,e.lanes=a,e;case zu:return pa(r,l,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Pu:i=10;break e;case $u:i=9;break e;case oo:i=11;break e;case co:i=14;break e;case yr:i=16,s=null;break e}throw Error(U(130,e==null?e:typeof e,""))}return t=Ct(i,r,t,l),t.elementType=e,t.type=s,t.lanes=a,t}function Xr(e,t,r,s){return e=Ct(7,e,s,t),e.lanes=r,e}function pa(e,t,r,s){return e=Ct(22,e,s,t),e.elementType=zu,e.lanes=r,e.stateNode={isHidden:!1},e}function qa(e,t,r){return e=Ct(6,e,null,t),e.lanes=r,e}function Xa(e,t,r){return t=Ct(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function X0(e,t,r,s,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pa(0),this.expirationTimes=Pa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pa(0),this.identifierPrefix=s,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Qo(e,t,r,s,l,a,i,o,c){return e=new X0(e,t,r,o,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ct(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Eo(a),e}function G0(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fn,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function kp(e){if(!e)return Ar;e=e._reactInternals;e:{if(nn(e)!==e||e.tag!==1)throw Error(U(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(gt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(U(171))}if(e.tag===1){var r=e.type;if(gt(r))return kd(e,r,t)}return t}function _p(e,t,r,s,l,a,i,o,c){return e=Qo(r,s,!0,e,l,a,i,o,c),e.context=kp(null),r=e.current,s=ct(),l=Pr(r),a=ar(s,l),a.callback=t??null,Er(r,a,l),e.current.lanes=l,Os(e,l,s),ht(e,s),e}function ma(e,t,r,s){var l=t.current,a=ct(),i=Pr(l);return r=kp(r),t.context===null?t.context=r:t.pendingContext=r,t=ar(a,i),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=Er(l,t,i),e!==null&&(Mt(e,l,i,a),_l(e,l,i)),i}function ea(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function tu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Ho(e,t){tu(e,t),(e=e.alternate)&&tu(e,t)}function J0(){return null}var Np=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ko(e){this._internalRoot=e}fa.prototype.render=Ko.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(U(409));ma(e,t,null,null)};fa.prototype.unmount=Ko.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;tn(function(){ma(null,e,null,null)}),t[or]=null}};function fa(e){this._internalRoot=e}fa.prototype.unstable_scheduleHydration=function(e){if(e){var t=rd();e={blockedOn:null,target:e,priority:t};for(var r=0;r<wr.length&&t!==0&&t<wr[r].priority;r++);wr.splice(r,0,e),r===0&&sd(e)}};function Yo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function xa(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ru(){}function Z0(e,t,r,s,l){if(l){if(typeof s=="function"){var a=s;s=function(){var m=ea(i);a.call(m)}}var i=_p(t,s,e,0,null,!1,!1,"",ru);return e._reactRootContainer=i,e[or]=i.current,Ts(e.nodeType===8?e.parentNode:e),tn(),i}for(;l=e.lastChild;)e.removeChild(l);if(typeof s=="function"){var o=s;s=function(){var m=ea(c);o.call(m)}}var c=Qo(e,0,!1,null,null,!1,!1,"",ru);return e._reactRootContainer=c,e[or]=c.current,Ts(e.nodeType===8?e.parentNode:e),tn(function(){ma(t,c,r,s)}),c}function ga(e,t,r,s,l){var a=r._reactRootContainer;if(a){var i=a;if(typeof l=="function"){var o=l;l=function(){var c=ea(i);o.call(c)}}ma(t,i,e,l)}else i=Z0(r,t,e,l,s);return ea(i)}ed=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=os(t.pendingLanes);r!==0&&(mo(t,r|1),ht(t,Me()),!(ge&6)&&(Mn=Me()+500,Rr()))}break;case 13:tn(function(){var s=cr(e,1);if(s!==null){var l=ct();Mt(s,e,1,l)}}),Ho(e,1)}};fo=function(e){if(e.tag===13){var t=cr(e,134217728);if(t!==null){var r=ct();Mt(t,e,134217728,r)}Ho(e,134217728)}};td=function(e){if(e.tag===13){var t=Pr(e),r=cr(e,t);if(r!==null){var s=ct();Mt(r,e,t,s)}Ho(e,t)}};rd=function(){return ve};nd=function(e,t){var r=ve;try{return ve=e,t()}finally{ve=r}};wi=function(e,t,r){switch(t){case"input":if(mi(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var l=aa(s);if(!l)throw Error(U(90));Lu(s),mi(s,l)}}}break;case"textarea":Ru(e,r);break;case"select":t=r.value,t!=null&&Sn(e,!!r.multiple,t,!1)}};Bu=Uo;Wu=tn;var ef={usingClientEntryPoint:!1,Events:[Us,vn,aa,Uu,Vu,Uo]},ss={findFiberByHostInstance:Hr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tf={bundleType:ss.bundleType,version:ss.version,rendererPackageName:ss.rendererPackageName,rendererConfig:ss.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ku(e),e===null?null:e.stateNode},findFiberByHostInstance:ss.findFiberByHostInstance||J0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yl.isDisabled&&yl.supportsFiber)try{ra=yl.inject(tf),qt=yl}catch{}}jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ef;jt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yo(t))throw Error(U(200));return G0(e,t,null,r)};jt.createRoot=function(e,t){if(!Yo(e))throw Error(U(299));var r=!1,s="",l=Np;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=Qo(e,1,!1,null,null,r,!1,s,l),e[or]=t.current,Ts(e.nodeType===8?e.parentNode:e),new Ko(t)};jt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(U(188)):(e=Object.keys(e).join(","),Error(U(268,e)));return e=Ku(t),e=e===null?null:e.stateNode,e};jt.flushSync=function(e){return tn(e)};jt.hydrate=function(e,t,r){if(!xa(t))throw Error(U(200));return ga(null,e,t,!0,r)};jt.hydrateRoot=function(e,t,r){if(!Yo(e))throw Error(U(405));var s=r!=null&&r.hydratedSources||null,l=!1,a="",i=Np;if(r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=_p(t,null,e,1,r??null,l,!1,a,i),e[or]=t.current,Ts(e),s)for(e=0;e<s.length;e++)r=s[e],l=r._getVersion,l=l(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,l]:t.mutableSourceEagerHydrationData.push(r,l);return new fa(t)};jt.render=function(e,t,r){if(!xa(t))throw Error(U(200));return ga(null,e,t,!1,r)};jt.unmountComponentAtNode=function(e){if(!xa(e))throw Error(U(40));return e._reactRootContainer?(tn(function(){ga(null,null,e,!1,function(){e._reactRootContainer=null,e[or]=null})}),!0):!1};jt.unstable_batchedUpdates=Uo;jt.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!xa(r))throw Error(U(200));if(e==null||e._reactInternals===void 0)throw Error(U(38));return ga(e,t,r,!1,s)};jt.version="18.3.1-next-f1338f8080-20240426";function Sp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sp)}catch(e){console.error(e)}}Sp(),Su.exports=jt;var rf=Su.exports,nu=rf;ai.createRoot=nu.createRoot,ai.hydrateRoot=nu.hydrateRoot;const nf="modulepreload",sf=function(e){return"/"+e},su={},Bs=function(t,r,s){let l=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));l=Promise.allSettled(r.map(c=>{if(c=sf(c),c in su)return;su[c]=!0;const m=c.endsWith(".css"),v=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${v}`))return;const b=document.createElement("link");if(b.rel=m?"stylesheet":nf,m||(b.as="script"),b.crossOrigin="",b.href=c,o&&b.setAttribute("nonce",o),document.head.appendChild(b),m)return new Promise((x,E)=>{b.addEventListener("load",x),b.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return l.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})},Cp=p.createContext(null);function lf({children:e}){const[t,r]=p.useState(null),s=p.useCallback(i=>new Promise(o=>{r({message:i,resolve:o})}),[]),l=()=>{t==null||t.resolve(!0),r(null)},a=()=>{t==null||t.resolve(!1),r(null)};return n.jsxs(Cp.Provider,{value:s,children:[e,t&&n.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:a}),n.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl border border-gray-200 p-6 max-w-sm w-full mx-4",children:[n.jsx("p",{className:"text-sm text-gray-800 mb-5 leading-relaxed",children:t.message}),n.jsxs("div",{className:"flex gap-3 justify-end",children:[n.jsx("button",{onClick:a,className:"px-4 py-2 rounded-lg text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 transition-colors",autoFocus:!0,children:"Cancel"}),n.jsx("button",{onClick:l,className:"px-4 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition-colors",children:"Confirm"})]})]})]})]})}function Ws(){const e=p.useContext(Cp);if(!e)throw new Error("useConfirm must be used within a ConfirmProvider");return e}function af({connected:e}){return n.jsx("header",{className:"bg-white border-b-2 border-cream-300 sticky top-0 z-50 shadow-sm",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"flex justify-between items-center py-4",children:[n.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:" Ice Cream Social Transcription"}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${e?"bg-sage-100 text-sage-700 border border-sage-200":"bg-gray-100 text-gray-600 border border-gray-200"}`,children:e?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"inline-block w-2 h-2 bg-sage-500 rounded-full mr-2 animate-pulse"}),"Worker Active"]}):n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"inline-block w-2 h-2 bg-gray-400 rounded-full mr-2"}),"Connecting..."]})})})]})})})}const Qs=typeof window<"u"&&window.__TAURI__!==void 0;console.log("Tauri detection:",{isTauri:Qs,hasWindow:typeof window<"u",hasTauriGlobal:typeof window<"u"&&window.__TAURI__!==void 0,tauriObject:typeof window<"u"?window.__TAURI__:"N/A"});async function of(){if(!Qs)throw new Error("Not running in Tauri");const{invoke:e}=await Bs(async()=>{const{invoke:t}=await Promise.resolve().then(()=>bf);return{invoke:t}},void 0);return e}async function cf(){if(!Qs)throw new Error("Not running in Tauri");const{listen:e}=await Bs(async()=>{const{listen:t}=await import("./event-DDX7swQu.js");return{listen:t}},[]);return e}async function M(e,t={}){return(await of())(e,t)}const Fe={async getEpisodes(e={}){console.log("Tauri getEpisodes called with:",e);const t=await M("get_episodes",{filters:e});return console.log("Tauri getEpisodes result:",t),t},async getEpisode(e){return M("get_episode",{id:e})},async refreshFeed(e="patreon",t=!1){console.log("Tauri refreshFeed called:",e,t);const r=await M("refresh_feed",{source:e,force:t});return console.log("Tauri refreshFeed result:",r),r},async getRefreshStatus(e){return{status:"completed"}},async getTranscript(e){console.log("Tauri getTranscript called for episode:",e);const t=await M("get_transcript",{episodeId:e});return console.log("Tauri getTranscript result:",t),t},async getFeedSources(){console.log("Tauri getFeedSources called");const e=await M("get_feed_sources");return console.log("Tauri getFeedSources result:",e),e},async downloadEpisode(e){console.log("Tauri downloadEpisode called for:",e);const t=await M("download_episode",{episodeId:e});return console.log("Tauri downloadEpisode result:",t),t},async updateSpeakerNames(e,t,r=null){console.log("Tauri updateSpeakerNames called for:",e,t);const s=await M("update_speaker_names",{episodeId:e,speakerNames:t,markedSamples:r});return console.log("Tauri updateSpeakerNames result:",s),s},async saveTranscriptEdits(e,t){console.log("Tauri saveTranscriptEdits called for:",e);const r=await M("save_transcript_edits",{episodeId:e,edits:t});return console.log("Tauri saveTranscriptEdits result:",r),r},async retryDiarization(e){console.log("Tauri retryDiarization called for:",e);const t=await M("retry_diarization",{episodeId:e});return console.log("Tauri retryDiarization result:",t),t},async saveVoiceSamples(e,t){console.log("Tauri saveVoiceSamples called for:",e,t);const r=await M("save_voice_samples",{episodeId:e,samples:t});return console.log("Tauri saveVoiceSamples result:",r),r},async getAudioPath(e){return console.log("Tauri getAudioPath called for:",e),await M("get_audio_path",{episodeId:e})},async analyzeEpisodeContent(e,t=!0){console.log("Tauri analyzeEpisodeContent called for:",e);const r=await M("analyze_episode_content",{episodeId:e,useLlm:t});return console.log("Tauri analyzeEpisodeContent result:",r),r},async reprocessDiarization(e){console.log("Tauri reprocessDiarization called for:",e);const t=await M("reprocess_diarization",{episodeId:e});return console.log("Tauri reprocessDiarization result:",t),t},async getCategoryRules(){return M("get_category_rules")},async recategorizeAllEpisodes(){return M("recategorize_all_episodes")},async linkCrossFeedEpisodes(){return M("link_cross_feed_episodes")},async getEpisodeVariants(e){return M("get_episode_variants",{episodeId:e})},async addCategoryRule(e){return M("add_category_rule",{rule:e})},async updateCategoryRule(e){return M("update_category_rule",{rule:e})},async deleteCategoryRule(e){return M("delete_category_rule",{id:e})},async testCategoryRule(e,t=null){return M("test_category_rule",{pattern:e,keywords:t})}},pn={async getQueue(){return M("get_queue")},async addToQueue(e,t=0){return M("add_to_queue",{episodeId:e,priority:t})},async removeFromQueue(e){return M("remove_from_queue",{episodeId:e})},async stopCurrent(){return M("stop_current_transcription")},async retryTranscription(e){return M("retry_transcription",{episodeId:e})},async getStatus(){return M("get_queue_status")}},ls={async getPipelineHealth(){return M("get_pipeline_health")},async getRecentErrors(e=20){return M("get_recent_errors",{limit:e})},async getQueueEpisodeLists(){return M("get_queue_episode_lists")},async getStats(){console.log("Tauri getStats called");const e=await M("get_stats");return console.log("Tauri getStats result:",e),e},async getPipelineStats(e=20){return M("get_pipeline_stats",{limit:e})}},Ga={async getStatus(){return M("get_worker_status")},async setPreventSleep(e){return M("set_prevent_sleep",{enabled:e})},async getPreventSleep(){return M("get_prevent_sleep")}};async function uf(e){if(!Qs)return console.log("Not in Tauri, skipping event listeners"),()=>{};const t=await cf(),r=[];if(e.onStatusUpdate){const s=await t("status_update",l=>{e.onStatusUpdate(l.payload)});r.push(s)}if(e.onQueueUpdate){const s=await t("queue_update",l=>{e.onQueueUpdate(l.payload)});r.push(s)}if(e.onStatsUpdate){const s=await t("stats_update",l=>{e.onStatsUpdate(l.payload)});r.push(s)}if(e.onTranscriptionComplete){const s=await t("transcription_complete",l=>{e.onTranscriptionComplete(l.payload)});r.push(s)}if(e.onTranscriptionFailed){const s=await t("transcription_failed",l=>{e.onTranscriptionFailed(l.payload)});r.push(s)}return()=>{r.forEach(s=>s())}}const Ja={async getSetting(e){return M("get_setting",{key:e})},async setSetting(e,t){return M("set_setting",{key:e,value:t})},async getAllSettings(){return M("get_all_settings")}},pt={async getSpeakers(){return M("get_speakers")},async createSpeaker(e,t=null,r=!1){return M("create_speaker",{name:e,shortName:t,isHost:r})},async updateSpeaker(e,t,r=null,s=!1){return M("update_speaker",{id:e,name:t,shortName:r,isHost:s})},async deleteSpeaker(e){return M("delete_speaker",{id:e})},async getSpeakerStats(){return M("get_speaker_stats")},async linkEpisodeSpeaker(e,t,r){return M("link_episode_speaker",{episodeId:e,diarizationLabel:t,speakerId:r})},async linkEpisodeAudioDrop(e,t,r){return M("link_episode_audio_drop",{episodeId:e,diarizationLabel:t,audioDropId:r})},async unlinkEpisodeSpeaker(e,t){return M("unlink_episode_speaker",{episodeId:e,diarizationLabel:t})},async getEpisodeSpeakerAssignments(e){return M("get_episode_speaker_assignments",{episodeId:e})},async getVoiceLibrary(){return M("get_voice_library")},async getVoiceSamplePath(e){return M("get_voice_sample_path",{speakerName:e})},async getVoiceSamples(e){return M("get_voice_samples",{speakerName:e})},async deleteVoiceSample(e,t,r){return M("delete_voice_sample",{speakerName:e,filePath:t||null,sampleId:r||null})},async updateVoiceSampleRating(e,t){return M("update_voice_sample_rating",{id:e,rating:t})}},be={async getChapterTypes(){return M("get_chapter_types")},async createChapterType(e,t,r,s){return M("create_chapter_type",{name:e,description:t,color:r,icon:s})},async getEpisodeChapters(e){return M("get_episode_chapters",{episodeId:e})},async createEpisodeChapter(e,t,r,s,l,a,i){return M("create_episode_chapter",{episodeId:e,chapterTypeId:t,title:r,startTime:s,endTime:l,startSegmentIdx:a,endSegmentIdx:i})},async deleteEpisodeChapter(e){return M("delete_episode_chapter",{chapterId:e})},async getCharacters(){return M("get_characters")},async createCharacter(e,t,r,s){return M("create_character",{name:e,shortName:t,description:r,catchphrase:s})},async updateCharacter(e,t,r,s,l){return M("update_character",{id:e,name:t,shortName:r,description:s,catchphrase:l})},async deleteCharacter(e){return M("delete_character",{id:e})},async addCharacterAppearance(e,t,r,s,l){return M("add_character_appearance",{characterId:e,episodeId:t,startTime:r,endTime:s,segmentIdx:l})},async getSponsors(){return M("get_sponsors")},async createSponsor(e,t,r,s){return M("create_sponsor",{name:e,tagline:t,description:r,isReal:s})},async updateSponsor(e,t,r,s,l){return M("update_sponsor",{id:e,name:t,tagline:r,description:s,isReal:l})},async deleteSponsor(e){return M("delete_sponsor",{id:e})},async addSponsorMention(e,t,r,s,l){return M("add_sponsor_mention",{sponsorId:e,episodeId:t,startTime:r,endTime:s,segmentIdx:l})},async getCharacterAppearancesForEpisode(e){return M("get_character_appearances_for_episode",{episodeId:e})},async deleteCharacterAppearance(e){return M("delete_character_appearance",{id:e})},async getAudioDrops(){return M("get_audio_drops")},async createAudioDrop(e,t=null,r=null,s=null){return M("create_audio_drop",{name:e,transcriptText:t,description:r,category:s})},async deleteAudioDrop(e){return M("delete_audio_drop",{id:e})},async addAudioDropInstance(e,t,r=null,s=null,l=null,a=null){return M("add_audio_drop_instance",{audioDropId:e,episodeId:t,segmentIdx:r,startTime:s,endTime:l,notes:a})},async getAudioDropInstances(e){return M("get_audio_drop_instances",{episodeId:e})},async deleteAudioDropInstance(e){return M("delete_audio_drop_instance",{id:e})},async createFlaggedSegment(e,t,r,s=null,l=null,a=null,i=null){return M("create_flagged_segment",{episodeId:e,segmentIdx:t,flagType:r,correctedSpeaker:s,characterId:l,notes:a,speakerIds:i})},async getFlaggedSegments(e){return M("get_flagged_segments",{episodeId:e})},async updateFlaggedSegment(e,t=null,r=null,s=null,l=null,a=null,i=null){return M("update_flagged_segment",{id:e,flagType:t,correctedSpeaker:r,characterId:s,notes:l,speakerIds:a,resolved:i})},async deleteFlaggedSegment(e){return M("delete_flagged_segment",{id:e})},async getUnresolvedFlagCount(e){return M("get_unresolved_flag_count",{episodeId:e})}},hr={async searchTranscripts(e,t=50,r=0){console.log("Tauri searchTranscripts called:",e);const s=await M("search_transcripts",{query:e,limit:t,offset:r});return console.log("Tauri searchTranscripts result:",s),s},async getSearchStats(){return M("get_search_stats")},async indexEpisodeTranscript(e,t){return console.log("Tauri indexEpisodeTranscript called for:",e),M("index_episode_transcript",{episodeId:e,segments:t})},async indexAllTranscripts(){return console.log("Tauri indexAllTranscripts called"),M("index_all_transcripts")},async reindexAllWithSpeakers(){return console.log("Tauri reindexAllWithSpeakers called"),M("reindex_all_with_speakers")},async getDetectedContent(e){return M("get_detected_content",{episodeId:e})},async getDetectedContentByType(e){return M("get_detected_content_by_type",{contentType:e})},async addDetectedContent(e,t,r,s,l,a,i,o,c){return M("add_detected_content",{episodeId:e,contentType:t,name:r,description:s,startTime:l,endTime:a,segmentIdx:i,confidence:o,rawText:c})}},er={async getOllamaStatus(){return M("get_ollama_status")},async getPrompts(){return M("get_extraction_prompts")},async getPrompt(e){return M("get_extraction_prompt",{promptId:e})},async createPrompt(e,t,r,s,l,a){return M("create_extraction_prompt",{name:e,description:t,contentType:r,promptText:s,systemPrompt:l,outputSchema:a})},async updatePrompt(e,t,r,s,l,a,i,o){return M("update_extraction_prompt",{promptId:e,name:t,description:r,contentType:s,promptText:l,systemPrompt:a,outputSchema:i,isActive:o})},async deletePrompt(e){return M("delete_extraction_prompt",{promptId:e})},async runExtraction(e,t){return M("run_extraction",{promptId:e,episodeId:t})},async testPrompt(e,t,r){return M("test_extraction_prompt",{promptText:e,systemPrompt:t,sampleText:r})},async getExtractionRuns(e,t){return M("get_extraction_runs",{episodeId:e,limit:t})}},lu={async syncWikiEpisode(e){return M("sync_wiki_episode",{episodeNumber:String(e)})},async getWikiEpisodeMeta(e){return M("get_wiki_episode_meta",{episodeId:e})}},F=Qs,it="/api/v2";class Za extends Error{constructor(t,r,s){super(t),this.name="APIError",this.status=r,this.data=s}}async function ot(e,t={}){try{const r=await fetch(e,{headers:{"Content-Type":"application/json",...t.headers},...t}),s=await r.json();if(!r.ok)throw new Za(s.error||"API request failed",r.status,s);return s}catch(r){throw r instanceof Za?r:new Za(r.message,0,null)}}const je={async getEpisodes(e={}){if(F)try{return await Fe.getEpisodes(e)}catch(r){throw console.error("Tauri getEpisodes failed:",r),r}const t=new URLSearchParams(e).toString();return ot(`${it}/episodes?${t}`)},async getEpisode(e){if(F)try{return await Fe.getEpisode(e)}catch(t){throw console.error("Tauri getEpisode failed:",t),t}return ot(`${it}/episodes/${e}`)},async refreshFeed(e="patreon",t=!1){if(F)try{return await Fe.refreshFeed(e,t)}catch(r){throw console.error("Tauri refreshFeed failed:",r),r}return ot(`${it}/episodes/refresh-feed`,{method:"POST",body:JSON.stringify({source:e,force:t})})},async getRefreshStatus(e){return F?{status:"idle"}:ot(`${it}/episodes/refresh-status/${e}`)},async getFeedSources(){if(F)try{return await Fe.getFeedSources()}catch(e){throw console.error("Tauri getFeedSources failed:",e),e}return ot(`${it}/feeds/sources`)},async getTranscript(e){if(F)try{return await Fe.getTranscript(e)}catch(t){throw console.error("Tauri getTranscript failed:",t),t}return ot(`${it}/episodes/${e}/transcript`)},async updateSpeakerNames(e,t,r=null){if(F)try{return await Fe.updateSpeakerNames(e,t,r)}catch(s){throw console.error("Tauri updateSpeakerNames failed:",s),s}throw new Error("Speaker name updates require Tauri")},async saveTranscriptEdits(e,t){if(F)try{return await Fe.saveTranscriptEdits(e,t)}catch(r){throw console.error("Tauri saveTranscriptEdits failed:",r),r}throw new Error("Transcript edits require Tauri")},async retryDiarization(e){if(F)try{return await Fe.retryDiarization(e)}catch(t){throw console.error("Tauri retryDiarization failed:",t),t}throw new Error("Diarization requires Tauri")},async saveVoiceSamples(e,t){if(F)try{return await Fe.saveVoiceSamples(e,t)}catch(r){throw console.error("Tauri saveVoiceSamples failed:",r),r}throw new Error("Voice samples require Tauri")},async getAudioPath(e){if(F)try{return await Fe.getAudioPath(e)}catch(t){throw console.error("Tauri getAudioPath failed:",t),t}throw new Error("Audio path requires Tauri")},async downloadEpisode(e){if(F)try{return await Fe.downloadEpisode(e)}catch(t){throw console.error("Tauri downloadEpisode failed:",t),t}return ot(`${it}/episodes/${e}/download`,{method:"POST"})},async analyzeEpisodeContent(e,t=!0){if(F)try{return await Fe.analyzeEpisodeContent(e,t)}catch(r){throw console.error("Tauri analyzeEpisodeContent failed:",r),r}throw new Error("Content analysis requires Tauri")},async reprocessDiarization(e){if(F)try{return await Fe.reprocessDiarization(e)}catch(t){throw console.error("Tauri reprocessDiarization failed:",t),t}throw new Error("Reprocess diarization requires Tauri")},async getCategoryRules(){if(F)try{return await Fe.getCategoryRules()}catch(e){return console.error("Tauri getCategoryRules failed:",e),[]}return[]},async recategorizeAllEpisodes(){if(F)return await Fe.recategorizeAllEpisodes();throw new Error("Recategorize requires Tauri")},async linkCrossFeedEpisodes(){if(F)return await Fe.linkCrossFeedEpisodes();throw new Error("Link cross-feed requires Tauri")},async getEpisodeVariants(e){if(F)try{return await Fe.getEpisodeVariants(e)}catch(t){return console.error("Tauri getEpisodeVariants failed:",t),[]}return[]},async addCategoryRule(e){if(F)return await Fe.addCategoryRule(e);throw new Error("Category rules require Tauri")},async updateCategoryRule(e){if(F)return await Fe.updateCategoryRule(e);throw new Error("Category rules require Tauri")},async deleteCategoryRule(e){if(F)return await Fe.deleteCategoryRule(e);throw new Error("Category rules require Tauri")},async testCategoryRule(e,t=null){if(F)return await Fe.testCategoryRule(e,t);throw new Error("Category rules require Tauri")}},ei={async getQueue(){if(F)try{return await pn.getQueue()}catch(e){throw console.error("Tauri getQueue failed:",e),e}return ot(`${it}/queue`)},async addToQueue(e,t=0){if(F)try{return await pn.addToQueue(e,t),{success:!0}}catch(r){throw console.error("Tauri addToQueue failed:",r),r}return ot(`${it}/queue/add`,{method:"POST",body:JSON.stringify({episode_id:e,priority:t})})},async removeFromQueue(e){if(F)try{return await pn.removeFromQueue(e),{success:!0}}catch(t){throw console.error("Tauri removeFromQueue failed:",t),t}return ot(`${it}/queue/remove/${e}`,{method:"DELETE"})},async stopCurrent(){if(F)try{return await pn.stopCurrent(),{success:!0}}catch(e){throw console.error("Tauri stopCurrent failed:",e),e}return ot(`${it}/queue/stop-current`,{method:"POST"})},async retryTranscription(e){if(F)try{return await pn.retryTranscription(e),{success:!0}}catch(t){throw console.error("Tauri retryTranscription failed:",t),t}return ot(`${it}/queue/retry/${e}`,{method:"POST"})},async getStatus(){if(F)try{return await pn.getStatus()}catch(e){throw console.error("Tauri getStatus failed:",e),e}return ot(`${it}/queue/status`)}},ws={async getStats(){if(F)try{return await ls.getStats()}catch(e){throw console.error("Tauri getStats failed:",e),e}return ot(`${it}/stats`)},async getPipelineStats(e=20){if(F)try{return await ls.getPipelineStats(e)}catch(t){return console.error("Tauri getPipelineStats failed:",t),{timing:null,recent:[]}}return{timing:null,recent:[]}},async getPipelineHealth(){if(F)try{return await ls.getPipelineHealth()}catch(e){return console.error("Tauri getPipelineHealth failed:",e),null}return null},async getRecentErrors(e=20){if(F)try{return await ls.getRecentErrors(e)}catch(t){return console.error("Tauri getRecentErrors failed:",t),[]}return[]},async getQueueEpisodeLists(){if(F)try{return await ls.getQueueEpisodeLists()}catch(e){return console.error("Tauri getQueueEpisodeLists failed:",e),{transcribe:[],diarize:[]}}return{transcribe:[],diarize:[]}}},Zi={async getStatus(){if(F)try{return await Ga.getStatus()}catch(e){throw console.error("Tauri workerStatus failed:",e),e}return ot(`${it}/worker/status`)},async setPreventSleep(e){if(F)return await Ga.setPreventSleep(e);throw new Error("Prevent sleep is only available in the Tauri app")},async getPreventSleep(){return F?await Ga.getPreventSleep():!1}},df=uf,au={async getSetting(e){if(F)try{return await Ja.getSetting(e)}catch(t){return console.error("Tauri getSetting failed:",t),null}return null},async setSetting(e,t){if(F)try{return await Ja.setSetting(e,t)}catch(r){throw console.error("Tauri setSetting failed:",r),r}throw new Error("Settings only available in Tauri mode")},async getAllSettings(){if(F)try{return await Ja.getAllSettings()}catch(e){return console.error("Tauri getAllSettings failed:",e),{}}return{}}},lt={async getSpeakers(){if(F)try{return await pt.getSpeakers()}catch(e){return console.error("Tauri getSpeakers failed:",e),[]}return[]},async createSpeaker(e,t=null,r=!1){if(F)return await pt.createSpeaker(e,t,r);throw new Error("Speakers only available in Tauri mode")},async updateSpeaker(e,t,r=null,s=!1){if(F)return await pt.updateSpeaker(e,t,r,s);throw new Error("Speakers only available in Tauri mode")},async deleteSpeaker(e){if(F)return await pt.deleteSpeaker(e);throw new Error("Speakers only available in Tauri mode")},async getSpeakerStats(){if(F)try{return await pt.getSpeakerStats()}catch(e){return console.error("Tauri getSpeakerStats failed:",e),[]}return[]},async linkEpisodeSpeaker(e,t,r){if(F)return await pt.linkEpisodeSpeaker(e,t,r);throw new Error("Speakers only available in Tauri mode")},async linkEpisodeAudioDrop(e,t,r){if(F)return await pt.linkEpisodeAudioDrop(e,t,r);throw new Error("Speakers only available in Tauri mode")},async unlinkEpisodeSpeaker(e,t){if(F)return await pt.unlinkEpisodeSpeaker(e,t);throw new Error("Speakers only available in Tauri mode")},async getEpisodeSpeakerAssignments(e){if(F)try{return await pt.getEpisodeSpeakerAssignments(e)}catch(t){return console.error("Tauri getEpisodeSpeakerAssignments failed:",t),[]}return[]},async getVoiceLibrary(){if(F)try{return await pt.getVoiceLibrary()}catch(e){return console.error("Tauri getVoiceLibrary failed:",e),[]}return[]},async getVoiceSamplePath(e){if(F)try{return await pt.getVoiceSamplePath(e)}catch(t){return console.error("Tauri getVoiceSamplePath failed:",t),null}return null},async getVoiceSamples(e){if(F)try{return await pt.getVoiceSamples(e)}catch(t){return console.error("Tauri getVoiceSamples failed:",t),[]}return[]},async deleteVoiceSample(e,t,r){if(F)return await pt.deleteVoiceSample(e,t,r);throw new Error("Voice samples only available in Tauri mode")},async updateVoiceSampleRating(e,t){if(F)return await pt.updateVoiceSampleRating(e,t);throw new Error("Voice sample ratings only available in Tauri mode")}},te={async getChapterTypes(){if(F)try{return await be.getChapterTypes()}catch(e){return console.error("Tauri getChapterTypes failed:",e),[]}return[]},async createChapterType(e,t,r,s){if(F)return await be.createChapterType(e,t,r,s);throw new Error("Content only available in Tauri mode")},async getEpisodeChapters(e){if(F)try{return await be.getEpisodeChapters(e)}catch(t){return console.error("Tauri getEpisodeChapters failed:",t),[]}return[]},async createEpisodeChapter(e,t,r,s,l,a,i){if(F)return await be.createEpisodeChapter(e,t,r,s,l,a,i);throw new Error("Content only available in Tauri mode")},async deleteEpisodeChapter(e){if(F)return await be.deleteEpisodeChapter(e);throw new Error("Content only available in Tauri mode")},async getCharacters(){if(F)try{return await be.getCharacters()}catch(e){return console.error("Tauri getCharacters failed:",e),[]}return[]},async createCharacter(e,t,r,s){if(F)return await be.createCharacter(e,t,r,s);throw new Error("Content only available in Tauri mode")},async updateCharacter(e,t,r,s,l){if(F)return await be.updateCharacter(e,t,r,s,l);throw new Error("Content only available in Tauri mode")},async deleteCharacter(e){if(F)return await be.deleteCharacter(e);throw new Error("Content only available in Tauri mode")},async addCharacterAppearance(e,t,r,s,l){if(F)return await be.addCharacterAppearance(e,t,r,s,l);throw new Error("Content only available in Tauri mode")},async getCharacterAppearancesForEpisode(e){if(F)try{return await be.getCharacterAppearancesForEpisode(e)}catch(t){return console.error("Tauri getCharacterAppearancesForEpisode failed:",t),[]}return[]},async deleteCharacterAppearance(e){if(F)return await be.deleteCharacterAppearance(e);throw new Error("Content only available in Tauri mode")},async getAudioDrops(){if(F)try{return await be.getAudioDrops()}catch(e){return console.error("Tauri getAudioDrops failed:",e),[]}return[]},async createAudioDrop(e,t=null,r=null,s=null){if(F)return await be.createAudioDrop(e,t,r,s);throw new Error("Content only available in Tauri mode")},async deleteAudioDrop(e){if(F)return await be.deleteAudioDrop(e);throw new Error("Content only available in Tauri mode")},async addAudioDropInstance(e,t,r=null,s=null,l=null,a=null){if(F)return await be.addAudioDropInstance(e,t,r,s,l,a);throw new Error("Content only available in Tauri mode")},async getAudioDropInstances(e){if(F)try{return await be.getAudioDropInstances(e)}catch(t){return console.error("Tauri getAudioDropInstances failed:",t),[]}return[]},async deleteAudioDropInstance(e){if(F)return await be.deleteAudioDropInstance(e);throw new Error("Content only available in Tauri mode")},async createFlaggedSegment(e,t,r,s=null,l=null,a=null,i=null){if(F)return await be.createFlaggedSegment(e,t,r,s,l,a,i);throw new Error("Content only available in Tauri mode")},async getFlaggedSegments(e){if(F)try{return await be.getFlaggedSegments(e)}catch(t){return console.error("Tauri getFlaggedSegments failed:",t),[]}return[]},async updateFlaggedSegment(e,t=null,r=null,s=null,l=null,a=null,i=null){if(F)return await be.updateFlaggedSegment(e,t,r,s,l,a,i);throw new Error("Content only available in Tauri mode")},async deleteFlaggedSegment(e){if(F)return await be.deleteFlaggedSegment(e);throw new Error("Content only available in Tauri mode")},async getUnresolvedFlagCount(e){if(F)try{return await be.getUnresolvedFlagCount(e)}catch(t){return console.error("Tauri getUnresolvedFlagCount failed:",t),0}return 0},async getSponsors(){if(F)try{return await be.getSponsors()}catch(e){return console.error("Tauri getSponsors failed:",e),[]}return[]},async createSponsor(e,t,r,s){if(F)return await be.createSponsor(e,t,r,s);throw new Error("Content only available in Tauri mode")},async updateSponsor(e,t,r,s,l){if(F)return await be.updateSponsor(e,t,r,s,l);throw new Error("Content only available in Tauri mode")},async deleteSponsor(e){if(F)return await be.deleteSponsor(e);throw new Error("Content only available in Tauri mode")},async addSponsorMention(e,t,r,s,l){if(F)return await be.addSponsorMention(e,t,r,s,l);throw new Error("Content only available in Tauri mode")}},us={async searchTranscripts(e,t=50,r=0){if(F)try{return await hr.searchTranscripts(e,t,r)}catch(s){throw console.error("Tauri searchTranscripts failed:",s),s}throw new Error("Search only available in Tauri mode")},async getSearchStats(){if(F)try{return await hr.getSearchStats()}catch(e){return console.error("Tauri getSearchStats failed:",e),{indexed_segments:0,unindexed_episode_count:0}}return{indexed_segments:0,unindexed_episode_count:0}},async indexEpisodeTranscript(e,t){if(F)try{return await hr.indexEpisodeTranscript(e,t)}catch(r){throw console.error("Tauri indexEpisodeTranscript failed:",r),r}throw new Error("Search indexing only available in Tauri mode")},async indexAllTranscripts(){if(F)try{return await hr.indexAllTranscripts()}catch(e){throw console.error("Tauri indexAllTranscripts failed:",e),e}throw new Error("Search indexing only available in Tauri mode")},async reindexAllWithSpeakers(){if(F)try{return await hr.reindexAllWithSpeakers()}catch(e){throw console.error("Tauri reindexAllWithSpeakers failed:",e),e}throw new Error("Reindex only available in Tauri mode")},async getDetectedContent(e){if(F)try{return await hr.getDetectedContent(e)}catch(t){return console.error("Tauri getDetectedContent failed:",t),[]}return[]},async getDetectedContentByType(e){if(F)try{return await hr.getDetectedContentByType(e)}catch(t){return console.error("Tauri getDetectedContentByType failed:",t),[]}return[]},async addDetectedContent(e,t,r,s,l,a,i,o,c){if(F)return await hr.addDetectedContent(e,t,r,s,l,a,i,o,c);throw new Error("Search only available in Tauri mode")}},Br={async getOllamaStatus(){return F?await er.getOllamaStatus():{running:!1,model:"",model_available:!1,available_models:[],error:"Not in Tauri mode"}},async getPrompts(){return F?await er.getPrompts():[]},async getPrompt(e){return F?await er.getPrompt(e):null},async createPrompt(e,t,r,s,l,a){if(F)return await er.createPrompt(e,t,r,s,l,a);throw new Error("Extraction only available in Tauri mode")},async updatePrompt(e,t,r,s,l,a,i,o){if(F)return await er.updatePrompt(e,t,r,s,l,a,i,o);throw new Error("Extraction only available in Tauri mode")},async deletePrompt(e){if(F)return await er.deletePrompt(e);throw new Error("Extraction only available in Tauri mode")},async runExtraction(e,t){if(F)return await er.runExtraction(e,t);throw new Error("Extraction only available in Tauri mode")},async testPrompt(e,t,r){if(F)return await er.testPrompt(e,t,r);throw new Error("Extraction only available in Tauri mode")},async getExtractionRuns(e,t){return F?await er.getExtractionRuns(e,t):[]}},ti={async syncWikiEpisode(e){if(F)return await lu.syncWikiEpisode(e);throw new Error("Wiki sync only available in Tauri mode")},async getWikiEpisodeMeta(e){if(F)try{return await lu.getWikiEpisodeMeta(e)}catch(t){return console.error("Tauri getWikiEpisodeMeta failed:",t),null}return null}};function pf({stats:e}){const[t,r]=p.useState(!1),[s,l]=p.useState(!1),[a,i]=p.useState(!0),[o,c]=p.useState(!0),[m,v]=p.useState({transcribe:[],diarize:[]}),[b,x]=p.useState(!1),E=e.total_episodes||0,h=e.downloaded_episodes||0,_=e.transcribed_episodes||0,D=e.diarized_episodes||0,d=e.in_queue||0,u=e.in_diarization_queue||0,f=e.failed||0,C=E>0?(_/E*100).toFixed(1):0,A=_>0?(D/_*100).toFixed(1):0,z=d>0||u>0;return p.useEffect(()=>{!s&&z&&(x(!1),ws.getQueueEpisodeLists().then(N=>{v(N||{transcribe:[],diarize:[]}),x(!0)}).catch(()=>x(!0)))},[s,d,u]),n.jsxs("div",{className:"space-y-4 mb-4",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-slate-700 to-slate-800 px-6 py-4 cursor-pointer select-none",onClick:()=>r(N=>!N),children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:"Episode Tracking"}),t&&n.jsxs("p",{className:"text-white/80 text-xs mt-1",children:[_," transcribed / ",D," diarized / ",E," total (",C,"%)"]})]}),n.jsx("svg",{className:`w-5 h-5 text-white/80 transition-transform ${t?"-rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]})}),!t&&n.jsxs("div",{className:"p-4",children:[n.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-3",children:[n.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:E}),n.jsx("div",{className:"text-xs text-gray-500",children:"Total"})]}),n.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-blue-700",children:h}),n.jsx("div",{className:"text-xs text-blue-600",children:"Downloaded"})]}),n.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-green-700",children:_}),n.jsx("div",{className:"text-xs text-green-600",children:"Transcribed"})]}),n.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-purple-700",children:D}),n.jsx("div",{className:"text-xs text-purple-600",children:"Diarized"})]})]}),n.jsxs("div",{className:`grid gap-3 mb-3 ${f>0?"grid-cols-3":"grid-cols-2"}`,children:[n.jsxs("div",{className:"text-center p-3 bg-amber-50 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-700",children:d}),n.jsx("div",{className:"text-xs text-amber-600",children:"Transcribe Queue"})]}),n.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-orange-700",children:u}),n.jsx("div",{className:"text-xs text-orange-600",children:"Diarization Queue"})]}),f>0&&n.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[n.jsx("div",{className:"text-2xl font-bold text-red-700",children:f}),n.jsx("div",{className:"text-xs text-red-600",children:"Failed"})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-2",children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Transcription Progress"}),n.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[_," of ",E," (",C,"%)"]})]}),n.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-green-500 transition-all duration-500",style:{width:`${C}%`}})})]}),_>0&&n.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Diarization Progress"}),n.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[D," of ",_," (",A,"%)"]})]}),n.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-purple-500 transition-all duration-500",style:{width:`${A}%`}})})]})]})]}),z&&n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-slate-600 to-slate-700 px-6 py-3 cursor-pointer select-none",onClick:()=>l(N=>!N),children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h2",{className:"text-base font-bold text-white",children:["Transcription & Diarization Queues",n.jsxs("span",{className:"ml-2 text-white/70 text-sm font-normal",children:["(",d+u," pending)"]})]}),n.jsx("svg",{className:`w-4 h-4 text-white/80 transition-transform ${s?"-rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]})}),!s&&n.jsxs("div",{className:"divide-y divide-cream-100",children:[n.jsxs("div",{children:[n.jsxs("button",{className:"w-full flex items-center justify-between px-4 py-2.5 text-sm font-medium text-amber-800 bg-amber-50 hover:bg-amber-100 transition-colors text-left",onClick:()=>i(N=>!N),children:[n.jsxs("span",{children:["Transcribe Queue (",d,")"]}),n.jsx("svg",{className:`w-4 h-4 transition-transform ${a?"":"-rotate-90"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),a&&n.jsx("div",{className:"max-h-72 overflow-y-auto",children:b?d===0?n.jsx("div",{className:"px-4 py-2 text-xs text-gray-400",children:"Nothing in transcription queue"}):n.jsx("table",{className:"min-w-full text-xs",children:n.jsx("tbody",{className:"divide-y divide-cream-50",children:m.transcribe.map((N,O)=>n.jsxs("tr",{className:"hover:bg-amber-50",children:[n.jsx("td",{className:"px-4 py-1.5 text-gray-400 w-6 tabular-nums",children:O+1}),n.jsx("td",{className:"px-2 py-1.5 text-gray-500 whitespace-nowrap w-12",children:N.episode_number?`#${N.episode_number}`:""}),n.jsx("td",{className:"px-2 py-1.5 text-gray-800 truncate max-w-xs",children:N.title})]},N.id))})}):n.jsx("div",{className:"px-4 py-2 text-xs text-gray-400",children:"Loading..."})})]}),n.jsxs("div",{children:[n.jsxs("button",{className:"w-full flex items-center justify-between px-4 py-2.5 text-sm font-medium text-orange-800 bg-orange-50 hover:bg-orange-100 transition-colors text-left",onClick:()=>c(N=>!N),children:[n.jsxs("span",{children:["Diarization Queue (",u,")"]}),n.jsx("svg",{className:`w-4 h-4 transition-transform ${o?"":"-rotate-90"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),o&&n.jsx("div",{className:"max-h-72 overflow-y-auto",children:b?u===0?n.jsx("div",{className:"px-4 py-2 text-xs text-gray-400",children:"Nothing in diarization queue"}):n.jsx("table",{className:"min-w-full text-xs",children:n.jsx("tbody",{className:"divide-y divide-cream-50",children:m.diarize.map((N,O)=>n.jsxs("tr",{className:"hover:bg-orange-50",children:[n.jsx("td",{className:"px-4 py-1.5 text-gray-400 w-6 tabular-nums",children:O+1}),n.jsx("td",{className:"px-2 py-1.5 text-gray-500 whitespace-nowrap w-12",children:N.episode_number?`#${N.episode_number}`:""}),n.jsx("td",{className:"px-2 py-1.5 text-gray-800 truncate max-w-xs",children:N.title})]},N.id))})}):n.jsx("div",{className:"px-4 py-2 text-xs text-gray-400",children:"Loading..."})})]})]})]})]})}function mf({activity:e}){const[t,r]=p.useState(!1),[s,l]=p.useState({}),a=p.useRef({});p.useEffect(()=>{if(!e||e.status==="idle"){l({}),a.current={};return}const u=e.slots||[];if(u.length===0&&e.current_episode){const f=e.current_episode.id;e.elapsed_seconds!=null&&(a.current[f]={polled:e.elapsed_seconds,at:Date.now()})}else for(const f of u){const C=f.episode.id;f.elapsed_seconds!=null&&(a.current[C]={polled:f.elapsed_seconds,at:Date.now()})}},[e]),p.useEffect(()=>{const u=setInterval(()=>{const f=Date.now(),C={};for(const[A,z]of Object.entries(a.current)){const N=(f-z.at)/1e3;C[A]=Math.floor(z.polled+N)}l(C)},1e3);return()=>clearInterval(u)},[]);const i=(u,f)=>s[u]!=null?s[u]:f,o=u=>{if(u==null)return"Unknown";if(u===0)return"0m 0s";const f=Math.floor(u/60),C=Math.floor(u%60);return`${f}m ${C}s`},c=u=>{if(!u)return"Never";try{return new Date(u).toLocaleString()}catch{return"Invalid date"}},m={downloading:{icon:"",label:"Downloading",color:"amber",bgClass:"bg-amber-50",borderClass:"border-amber-200",textClass:"text-amber-600",barClass:"bg-amber-500"},transcribing:{icon:"",label:"Transcribing",color:"sky",bgClass:"bg-sky-50",borderClass:"border-sky-200",textClass:"text-sky-600",barClass:"bg-sky-500"},diarizing:{icon:"",label:"Diarizing",color:"purple",bgClass:"bg-purple-50",borderClass:"border-purple-300",textClass:"text-purple-600",barClass:"bg-gradient-to-r from-purple-500 to-purple-600"},saving:{icon:"",label:"Saving",color:"green",bgClass:"bg-green-50",borderClass:"border-green-200",textClass:"text-green-600",barClass:"bg-green-500"}},v=u=>{const f=m[u.stage]||m.transcribing,C=i(u.episode.id,u.elapsed_seconds),A=u.progress||0;return n.jsxs("div",{className:`p-4 rounded-lg border ${f.bgClass} ${f.borderClass}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-lg",children:f.icon}),n.jsx("span",{className:`text-xs font-bold uppercase tracking-wide ${f.textClass}`,children:f.label})]}),n.jsxs("div",{className:"font-semibold text-gray-900 text-sm",children:[u.episode.episode_number?`Ep ${u.episode.episode_number}: `:"",u.episode.title]}),n.jsxs("div",{className:`mt-3 transition-opacity duration-300 ${A>0?"opacity-100":"opacity-0 h-0 overflow-hidden"}`,children:[n.jsxs("div",{className:"flex justify-between items-center mb-1",children:[n.jsxs("span",{className:`text-xs ${f.textClass}`,children:[f.label," Progress"]}),n.jsxs("span",{className:`text-xs font-bold ${f.textClass}`,children:["~",A,"%"]})]}),n.jsx("div",{className:`h-2 rounded-full overflow-hidden bg-${f.color}-100`,children:n.jsx("div",{className:`h-full transition-all duration-1000 ease-linear ${f.barClass}`,style:{width:`${A}%`}})})]}),n.jsxs("div",{className:"flex gap-4 mt-3 text-xs",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Elapsed: "}),n.jsx("span",{className:"font-medium text-gray-900",children:o(C)})]}),u.estimated_remaining_seconds!=null&&u.estimated_remaining_seconds>0&&n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Remaining: "}),n.jsxs("span",{className:"font-medium text-gray-900",children:["~",o(u.estimated_remaining_seconds)]})]})]})]},`${u.episode.id}-${u.stage}`)},b=()=>{var u,f,C,A;if(!e)return n.jsxs("div",{className:"text-center py-8 text-gray-400",children:[n.jsx("div",{className:"text-4xl mb-2",children:""}),n.jsx("div",{children:"Connecting..."})]});if(e.status==="idle")return n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"p-4 bg-white border border-gray-200 rounded-lg",children:[n.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"Pipeline Status"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:n.jsx("span",{className:"text-green-600 text-sm",children:""})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Ready to Process"}),n.jsx("div",{className:"text-xs text-gray-500",children:"Worker is online and waiting"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center",children:n.jsx("span",{className:"text-gray-400 text-sm",children:""})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm font-medium text-gray-400",children:"Queue Empty"}),n.jsx("div",{className:"text-xs text-gray-400",children:"Add episodes to start transcribing"})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:((u=e.worker_info)==null?void 0:u.processed_today)||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"Done Today"})]}),n.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:((f=e.worker_info)==null?void 0:f.model)||"medium"}),n.jsx("div",{className:"text-xs text-gray-500",children:"Model"})]})]}),e.last_activity&&n.jsxs("div",{className:"text-xs text-gray-400 text-center",children:["Last completed: ",c(e.last_activity)]})]});if(e.status==="processing"||e.status==="transcribing"){const z=e.slots||[];if(z.length>1,z.length>0)return n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"p-4 bg-white border border-sky-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Pipeline Status"}),n.jsxs("div",{className:"text-xs font-medium text-sky-600",children:[z.length," active ",z.length===1?"slot":"slots"]})]}),n.jsx("div",{className:"flex items-center gap-1",children:["downloading","transcribing","diarizing","saving"].map((ne,J)=>{const j=z.some(H=>H.stage===ne);return n.jsxs("div",{className:"flex items-center flex-1",children:[n.jsx("div",{className:`h-1.5 rounded-full flex-1 ${j?"bg-sky-500 animate-pulse":"bg-gray-200"}`}),J<3&&n.jsx("div",{className:"w-1"})]},ne)})}),n.jsx("div",{className:"flex justify-between mt-1",children:["Download","Transcribe","Diarize","Save"].map(ne=>n.jsx("div",{className:"text-[10px] text-gray-400 text-center flex-1",children:ne},ne))})]}),z.map(ne=>v(ne)),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:((C=e.worker_info)==null?void 0:C.processed_today)||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"Done Today"})]}),n.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:((A=e.worker_info)==null?void 0:A.model)||"medium"}),n.jsx("div",{className:"text-xs text-gray-500",children:"Model"})]})]})]});const N=e.current_episode,O=e.stage||"transcribing",ee=O==="downloading",S=O==="transcribing",Y=O==="diarizing",$=O==="saving",V=S||Y||$,G=Y||$,le=$;return n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"p-4 bg-white border border-sky-200 rounded-lg",children:[n.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"Pipeline Status"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${V?"bg-green-100":ee?"bg-amber-500":"bg-gray-100"}`,children:V?n.jsx("span",{className:"text-green-600 text-sm",children:""}):ee?n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):n.jsx("span",{className:"text-gray-400 text-sm",children:""})}),n.jsx("div",{className:"flex-1",children:n.jsx("div",{className:`text-sm font-medium ${V?"text-gray-900":ee?"text-amber-700":"text-gray-400"}`,children:V?"Audio Downloaded":"Downloading Audio"})})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${G?"bg-green-100":S?"bg-sky-500":"bg-gray-100"}`,children:G?n.jsx("span",{className:"text-green-600 text-sm",children:""}):S?n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):n.jsx("span",{className:"text-gray-400 text-sm",children:""})}),n.jsx("div",{className:"flex-1",children:n.jsx("div",{className:`text-sm font-medium ${G?"text-gray-900":S?"text-sky-700":"text-gray-400"}`,children:G?"Transcription Complete":"Transcribing Audio"})})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${le?"bg-green-100":Y?"bg-purple-500":"bg-gray-100"}`,children:le?n.jsx("span",{className:"text-green-600 text-sm",children:""}):Y?n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):n.jsx("span",{className:"text-gray-400 text-sm",children:""})}),n.jsx("div",{className:"flex-1",children:n.jsx("div",{className:`text-sm font-medium ${le?"text-gray-900":Y?"text-purple-700":"text-gray-400"}`,children:le?"Speakers Identified":"Speaker Diarization"})})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${$?"bg-green-500":"bg-gray-100"}`,children:$?n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):n.jsx("span",{className:"text-gray-400 text-sm",children:""})}),n.jsx("div",{className:"flex-1",children:n.jsx("div",{className:`text-sm font-medium ${$?"text-green-700":"text-gray-400"}`,children:$?"Saving...":"Save Transcript"})})]})]})]}),N&&(S||Y||ee||$)&&v({episode:N,stage:O,progress:e.progress,elapsed_seconds:e.elapsed_seconds,estimated_remaining_seconds:e.estimated_remaining_seconds})]})}return n.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[n.jsxs("div",{className:"text-red-700 font-semibold",children:["Unknown Status: ",e.status]}),n.jsx("pre",{className:"text-xs mt-2 text-red-600",children:JSON.stringify(e,null,2)})]})},x=(e==null?void 0:e.stage)||"idle",E=(e==null?void 0:e.slots)||[],h=E.length,_=u=>E.some(f=>f.stage===u),D=_("transcribing")?"from-sky-600 to-sky-700":_("diarizing")?"from-purple-600 to-purple-700":_("downloading")?"from-amber-500 to-amber-600":x==="diarizing"?"from-purple-600 to-purple-700":x==="transcribing"?"from-sky-600 to-sky-700":x==="downloading"?"from-amber-500 to-amber-600":"from-slate-700 to-slate-800",d=()=>{if(!e||e.status==="idle")return"Waiting for queue items";if(h>1)return`${h} slots active  pipeline processing`;switch(x){case"downloading":return"Downloading audio...";case"transcribing":return"Transcribing audio...";case"diarizing":return"Identifying speakers...";case"saving":return"Saving results...";default:return"Processing..."}};return n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden",children:[n.jsx("div",{className:`bg-gradient-to-r ${D} px-6 py-4 transition-colors duration-500 cursor-pointer select-none`,onClick:()=>r(u=>!u),children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:"Processing Pipeline"}),n.jsx("p",{className:"text-white/80 text-xs mt-1",children:d()})]}),n.jsx("svg",{className:`w-5 h-5 text-white/80 transition-transform ${t?"-rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]})}),!t&&n.jsx("div",{className:"p-4",children:b()})]})}const ff=p.memo(mf);function tr(e){if(e==null||e===0)return"-";if(e<60)return`${Math.round(e)}s`;const t=Math.floor(e/60),r=Math.round(e%60);return r>0?`${t}m ${r}s`:`${t}m`}function xf(e){if(e==null)return"-";const t=Math.floor(e/3600),r=Math.round(e%3600/60);return t>0?`${t}h ${r}m`:`${r}m`}const gf={download:"bg-blue-100 text-blue-700",transcribe:"bg-purple-100 text-purple-700",diarize:"bg-orange-100 text-orange-700"};function hf({stats:e,currentActivity:t}){const[r,s]=p.useState(null),[l,a]=p.useState(null),[i,o]=p.useState([]),[c,m]=p.useState(!0),v=p.useRef(!1),b=async()=>{if(!v.current){v.current=!0;try{const[h,_,D]=await Promise.all([ws.getPipelineStats(20),ws.getPipelineHealth(),ws.getRecentErrors(10)]);s(h),a(_),o(D||[])}catch(h){console.error("Failed to load pipeline stats:",h)}finally{v.current=!1,m(!1)}}};p.useEffect(()=>{b();const h=setInterval(b,6e4);return()=>clearInterval(h)},[]);const x=r==null?void 0:r.timing,E=(r==null?void 0:r.recent)||[];return n.jsxs("div",{className:"space-y-6",children:[n.jsx(pf,{stats:e}),n.jsx(ff,{activity:t}),l&&n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-cream-200 p-4",children:[n.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Success Rate"}),n.jsxs("div",{className:`text-2xl font-bold mt-1 ${l.success_rate_last_50>=.9?"text-green-600":l.success_rate_last_50>=.7?"text-yellow-600":"text-red-600"}`,children:[(l.success_rate_last_50*100).toFixed(0),"%"]}),n.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"last 50 episodes"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-cream-200 p-4",children:[n.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Queue Remaining"}),n.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:l.episodes_remaining.toLocaleString()}),n.jsx("div",{className:"text-xs text-gray-400 mt-1",children:isFinite(l.estimated_completion_days)?`~${Math.ceil(l.estimated_completion_days)}d to finish`:"rate unknown"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-cream-200 p-4",children:[n.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Errors (24h)"}),n.jsx("div",{className:`text-2xl font-bold mt-1 ${l.failed_last_24h>0?"text-red-600":"text-green-600"}`,children:l.failed_last_24h}),n.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[l.unresolved_errors," unresolved total"]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-cream-200 p-4",children:[n.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Transcribe"}),n.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:tr(l.avg_transcribe_seconds)}),n.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"per episode"})]})]}),x&&n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-cream-200 p-4",children:[n.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Download"}),n.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:tr(x.avg_download_seconds)})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-cream-200 p-4",children:[n.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Transcribe"}),n.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:tr(x.avg_transcribe_seconds)})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-cream-200 p-4",children:[n.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Diarize"}),n.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:tr(x.avg_diarize_seconds)})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-cream-200 p-4",children:[n.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transcribe / Hr Audio"}),n.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:tr(x.avg_transcribe_per_hour_audio)})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-cream-200 p-4",children:[n.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Processed"}),n.jsxs("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:[x.total_hours_processed.toFixed(1),"h"]}),n.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[x.episodes_timed," episodes"]})]})]}),i.length>0&&n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-red-200",children:[n.jsxs("div",{className:"px-4 py-3 border-b border-red-100 flex items-center justify-between",children:[n.jsx("h3",{className:"text-sm font-semibold text-red-800",children:"Recent Pipeline Errors"}),n.jsxs("span",{className:"text-xs text-red-500",children:[i.filter(h=>!h.resolved).length," unresolved"]})]}),n.jsx("div",{className:"divide-y divide-red-50",children:i.map(h=>n.jsxs("div",{className:`px-4 py-3 ${h.resolved?"opacity-50":""}`,children:[n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("span",{className:`text-xs font-medium px-1.5 py-0.5 rounded flex-shrink-0 ${gf[h.context]||"bg-gray-100 text-gray-600"}`,children:h.context}),h.resolved&&n.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-1.5 py-0.5 rounded flex-shrink-0",children:"resolved"}),n.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0",children:h.occurred_at})]}),h.episode_title&&n.jsx("div",{className:"text-xs font-medium text-gray-700 mt-1 truncate",children:h.episode_title}),n.jsx("div",{className:"text-xs text-gray-500 mt-0.5 line-clamp-2 font-mono",children:h.error_detail})]},h.id))})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-cream-200",children:[n.jsx("div",{className:"px-4 py-3 border-b border-cream-200",children:n.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Recently Completed"})}),c?n.jsx("div",{className:"p-4 text-sm text-gray-500",children:"Loading..."}):E.length===0?n.jsx("div",{className:"p-4 text-sm text-gray-500",children:"No timed episodes yet. Durations are recorded as episodes complete the pipeline."}):n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-cream-200 text-sm",children:[n.jsx("thead",{className:"bg-cream-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-500",children:"Ep#"}),n.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-500",children:"Title"}),n.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Audio"}),n.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Download"}),n.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Transcribe"}),n.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Diarize"}),n.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Total"}),n.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-500",children:"Finished"})]})}),n.jsx("tbody",{className:"divide-y divide-cream-100",children:E.map(h=>n.jsxs("tr",{className:"hover:bg-cream-50",children:[n.jsx("td",{className:"px-3 py-2 text-gray-600 whitespace-nowrap",children:h.episode_number||"-"}),n.jsx("td",{className:"px-3 py-2 text-gray-900 max-w-xs truncate",children:h.title}),n.jsx("td",{className:"px-3 py-2 text-right text-gray-600 whitespace-nowrap",children:xf(h.audio_duration)}),n.jsx("td",{className:"px-3 py-2 text-right text-gray-600 whitespace-nowrap",children:tr(h.download_duration)}),n.jsx("td",{className:"px-3 py-2 text-right text-gray-600 whitespace-nowrap",children:tr(h.transcribe_duration)}),n.jsx("td",{className:"px-3 py-2 text-right text-gray-600 whitespace-nowrap",children:tr(h.diarize_duration)}),n.jsx("td",{className:"px-3 py-2 text-right font-medium text-gray-900 whitespace-nowrap",children:tr(h.total_duration)}),n.jsx("td",{className:"px-3 py-2 text-right text-gray-400 whitespace-nowrap",children:h.completed_date?new Date(h.completed_date).toLocaleString([],{dateStyle:"short",timeStyle:"short"}):"-"})]},h.id))})]})})]})]})}const yf=p.memo(hf);function vf(e,t=!1){return window.__TAURI_INTERNALS__.transformCallback(e,t)}async function wf(e,t={},r){return window.__TAURI_INTERNALS__.invoke(e,t,r)}function ha(e,t="asset"){return window.__TAURI_INTERNALS__.convertFileSrc(e,t)}const bf=Object.freeze(Object.defineProperty({__proto__:null,convertFileSrc:ha,invoke:wf,transformCallback:vf},Symbol.toStringTag,{value:"Module"})),ri=[{id:"wrong_speaker",label:"Wrong Speaker",icon:"",description:"Speaker assignment is incorrect",needsSpeaker:!0},{id:"character_voice",label:"Character Voice",icon:"",description:"This is a character speaking",needsCharacter:!0},{id:"multiple_speakers",label:"Multiple Speakers",icon:"",description:"Overlapping speech from multiple people"},{id:"audio_issue",label:"Audio Issue",icon:"",description:"Transcription error or audio problem"},{id:"other",label:"Other",icon:"",description:"Add a note about this segment",needsNotes:!0}],iu={SPEAKER_00:{bg:"bg-blue-100",text:"text-blue-700",label:"bg-blue-200 text-blue-800",border:"border-blue-300",ring:"ring-blue-400"},SPEAKER_01:{bg:"bg-green-100",text:"text-green-700",label:"bg-green-200 text-green-800",border:"border-green-300",ring:"ring-green-400"},SPEAKER_02:{bg:"bg-orange-100",text:"text-orange-700",label:"bg-orange-200 text-orange-800",border:"border-orange-300",ring:"ring-orange-400"},SPEAKER_03:{bg:"bg-purple-100",text:"text-purple-700",label:"bg-purple-200 text-purple-800",border:"border-purple-300",ring:"ring-purple-400"},SPEAKER_04:{bg:"bg-pink-100",text:"text-pink-700",label:"bg-pink-200 text-pink-800",border:"border-pink-300",ring:"ring-pink-400"},SPEAKER_05:{bg:"bg-cyan-100",text:"text-cyan-700",label:"bg-cyan-200 text-cyan-800",border:"border-cyan-300",ring:"ring-cyan-400"},UNKNOWN:{bg:"bg-gray-100",text:"text-gray-600",label:"bg-gray-200 text-gray-600",border:"border-gray-300",ring:"ring-gray-400"}},ou=[{id:"Matt Donnelly",short:"Matt"},{id:"Paul Mattingly",short:"Paul"},{id:"Jacob Smith",short:"Jacob"}],cu=e=>iu[e]||iu.UNKNOWN,ni=e=>{if(!e||isNaN(e))return"00:00";const t=Math.floor(e/3600),r=Math.floor(e%3600/60),s=Math.floor(e%60);return t>0?`${t}:${r.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${r}:${s.toString().padStart(2,"0")}`};function jf({episode:e,onClose:t}){const r=Ws(),[s,l]=p.useState(null),[a,i]=p.useState(!0),[o,c]=p.useState(null),[m,v]=p.useState(""),[b,x]=p.useState("speakers"),[E,h]=p.useState({}),[_,D]=p.useState(!1),[d,u]=p.useState(null),[f,C]=p.useState(!1),[A,z]=p.useState(null),[N,O]=p.useState({}),[ee,S]=p.useState(!1),[Y,$]=p.useState(!1),[V,G]=p.useState(null),[le,ne]=p.useState({}),[J,j]=p.useState({}),[H,Z]=p.useState([]),[de,oe]=p.useState(!1),[Oe,ke]=p.useState([]),[L,re]=p.useState([]),[xe,Re]=p.useState([]),[he,Q]=p.useState([]),[ae,w]=p.useState(null),[I,B]=p.useState(null),[se,ye]=p.useState(null),[$t,zt]=p.useState(!1),[st,Ne]=p.useState(null),[Ee,It]=p.useState(!1),[ce,pr]=p.useState(""),[Gt,Vn]=p.useState(!1),[Ut,Vt]=p.useState(0),[Bt,Bn]=p.useState(0),[Fr,Wn]=p.useState(!0),[sn,Jt]=p.useState(1),We=p.useRef(null),Mr=p.useRef(null),Wt=p.useRef({}),Or=p.useRef(!1);p.useEffect(()=>{e!=null&&e.id&&ln()},[e]);const ln=async()=>{try{i(!0),c(null);const[y,T,K,X,we,g,k]=await Promise.all([je.getTranscript(e.id),lt.getVoiceLibrary().catch(()=>[]),te.getChapterTypes().catch(()=>[]),te.getEpisodeChapters(e.id).catch(()=>[]),te.getFlaggedSegments(e.id).catch(()=>[]),te.getCharacterAppearancesForEpisode(e.id).catch(()=>[]),te.getCharacters().catch(()=>[])]);l(y),Z(T),ke(K),re(X),Re(g),Q(k);const P={};we.forEach(W=>{P[W.segment_idx]=W}),j(P),y.speaker_names&&h(y.speaker_names)}catch(y){console.error("Error loading transcript:",y),c(y.message||"Failed to load transcript")}finally{i(!1)}},fe=p.useMemo(()=>{if(!(s!=null&&s.segments_json))return null;try{const y=JSON.parse(s.segments_json);if(Array.isArray(y)&&y.length>0)return y}catch(y){console.error("Failed to parse segments JSON:",y)}return null},[s==null?void 0:s.segments_json]),Hs=p.useMemo(()=>{if(!fe)return[];const y=new Set;return fe.forEach(T=>{T.speaker&&T.speaker!=="UNKNOWN"&&y.add(T.speaker)}),Array.from(y).sort()},[fe]),Ge=p.useMemo(()=>fe?fe.some(y=>y.speaker&&y.speaker!=="UNKNOWN"):!1,[fe]),ya=y=>E[y]||y,Je=p.useCallback(y=>{var T;if((T=y.timestamps)!=null&&T.from){const X=y.timestamps.from.replace(",",".").split(":");if(X.length===3)return parseFloat(X[0])*3600+parseFloat(X[1])*60+parseFloat(X[2])}return typeof y.start=="number"?y.start:0},[]),mr=p.useCallback(y=>{var T;if((T=y.timestamps)!=null&&T.to){const X=y.timestamps.to.replace(",",".").split(":");if(X.length===3)return parseFloat(X[0])*3600+parseFloat(X[1])*60+parseFloat(X[2])}return typeof y.end=="number"?y.end:Je(y)+10},[Je]),Ir=p.useMemo(()=>{if(!fe||!Gt)return-1;for(let y=0;y<fe.length;y++){const T=Je(fe[y]),K=mr(fe[y]);if(Ut>=T&&Ut<K)return y}return-1},[fe,Ut,Gt,Je,mr]);p.useEffect(()=>{Fr&&Ir>=0&&Wt.current[Ir]&&Wt.current[Ir].scrollIntoView({behavior:"smooth",block:"center"})},[Ir,Fr]);const ue=y=>{var T;if((T=y.timestamps)!=null&&T.from)return y.timestamps.from.replace(",",".").slice(0,8);if(typeof y.start=="number"){const K=Math.floor(y.start/60),X=Math.floor(y.start%60);return`${K.toString().padStart(2,"0")}:${X.toString().padStart(2,"0")}`}return""},an=y=>{if(!m||!y)return y;try{const T=new RegExp(`(${m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return y.split(T).map((X,we)=>T.test(X)?n.jsx("mark",{className:"bg-yellow-200",children:X},we):X)}catch{return y}},on=p.useMemo(()=>{if(!fe)return null;if(!m)return fe;const y=m.toLowerCase();return fe.filter(T=>{var K;return(K=T.text)==null?void 0:K.toLowerCase().includes(y)})},[fe,m]),_t=(y,T)=>{h(K=>({...K,[y]:T}))},fr=async()=>{try{C(!0),await je.updateSpeakerNames(e.id,E),D(!1)}catch(y){console.error("Failed to save speaker names:",y),alert("Failed to save speaker names: "+y.message)}finally{C(!1)}},va=(y,T)=>{var K;return((K=N[T])==null?void 0:K.speaker)??y.speaker},Ur=(y,T)=>{var K;return((K=N[T])==null?void 0:K.text)??y.text},Ks=y=>{z(A===y?null:y)},Zt=(y,T)=>{h(K=>({...K,[y]:T})),S(!0),z(null)},Qn=y=>{ne(T=>{const K={...T};return K[y]?delete K[y]:K[y]=!0,K}),S(!0)},Vr=async(y,T,K=null,X=null,we=null)=>{try{const g=await te.createFlaggedSegment(e.id,y,T,K,X,we);j(k=>({...k,[y]:{id:g,episode_id:e.id,segment_idx:y,flag_type:T,corrected_speaker:K,character_id:X,notes:we,resolved:!1}})),B(null),ye(null)}catch(g){console.error("Error creating flag:",g),alert(`Failed to create flag: ${g.message}`)}},Hn=async y=>{const T=J[y];if(T)try{await te.deleteFlaggedSegment(T.id),j(K=>{const X={...K};return delete X[y],X})}catch(K){console.error("Error deleting flag:",K),alert(`Failed to delete flag: ${K.message}`)}},xr=async(y,T)=>{const K=fe[y];if(K)try{const X=await te.addCharacterAppearance(T,e.id,Je(K),mr(K),y),we=await te.getCharacterAppearancesForEpisode(e.id);Re(we),B(null),ye(null)}catch(X){console.error("Error adding character appearance:",X),alert(`Failed to add character: ${X.message}`)}},Ys=async(y,T)=>{if(T.trim())try{const K=await te.createCharacter(T.trim(),null,null,null);await xr(y,K);const X=await te.getCharacters();Q(X),pr("")}catch(K){console.error("Error creating character:",K),alert(`Failed to create character: ${K.message}`)}},Kn=async y=>{try{await te.deleteCharacterAppearance(y);const T=await te.getCharacterAppearancesForEpisode(e.id);Re(T)}catch(T){console.error("Error removing character:",T)}},wa=y=>xe.find(T=>T.segment_idx===y),cn=Object.keys(J).length;Object.values(J).filter(y=>!y.resolved).length;const qs=async()=>{if(!de)try{oe(!0),await je.retryDiarization(e.id),await ln()}catch(y){console.error("Error running diarization:",y),alert(`Diarization failed: ${y.message||"Unknown error"}`)}finally{oe(!1)}},Xs=async(y,T)=>{if(!fe||T==null)return;const K=fe[T],X=K.start??Je(K),we=K.end??mr(K);try{await te.createEpisodeChapter(e.id,y,null,X,we,T,T);const g=await te.getEpisodeChapters(e.id);re(g),B(null),ye(null)}catch(g){console.error("Error creating chapter:",g),alert(`Failed to create chapter: ${g.message}`)}},Yn=async y=>{try{await te.deleteEpisodeChapter(y);const T=await te.getEpisodeChapters(e.id);re(T)}catch(T){console.error("Error deleting chapter:",T)}},ba=async()=>{try{const y=await us.getDetectedContent(e.id);Ne(y)}catch(y){console.error("Error loading detected content:",y)}},Gs=async(y=!0)=>{if(!$t)try{zt(!0);const T=await je.analyzeEpisodeContent(e.id,y),K=[...(T.characters||[]).map(X=>({...X,content_type:"character"})),...(T.commercials||[]).map(X=>({...X,content_type:"commercial"})),...(T.bits||[]).map(X=>({...X,content_type:"bit"}))];Ne(K),It(!0)}catch(T){console.error("Error analyzing content:",T),alert(`Content analysis failed: ${T.message||"Unknown error"}`)}finally{zt(!1)}};p.useEffect(()=>{e!=null&&e.id&&ba()},[e==null?void 0:e.id]),p.useEffect(()=>{if(!fe||!(e!=null&&e.initialTimestamp)||Or.current)return;Or.current=!0;let y=e.initialSegmentIdx!=null?e.initialSegmentIdx:null;if(y==null){let T=1/0;fe.forEach((K,X)=>{const we=Math.abs(Je(K)-e.initialTimestamp);we<T&&(T=we,y=X)})}y!=null&&setTimeout(()=>{Wt.current[y]&&Wt.current[y].scrollIntoView({behavior:"smooth",block:"center"})},200)},[fe]);const qn=y=>L.find(T=>T.start_segment_idx<=y&&T.end_segment_idx>=y),Xn=p.useMemo(()=>{const y={};return Object.keys(le).forEach(T=>{const K=fe==null?void 0:fe[parseInt(T)];K!=null&&K.speaker&&(y[K.speaker]=(y[K.speaker]||0)+1)}),y},[le,fe]),Js=async()=>{if(ee)try{if($(!0),await je.updateSpeakerNames(e.id,E),Object.keys(N).length>0&&await je.saveTranscriptEdits(e.id,N),Object.keys(le).length>0&&fe){const y=Object.keys(le).map(T=>{const K=parseInt(T),X=fe[K],we=E[X.speaker]||X.speaker;return{speaker:X.speaker,speakerName:we,startTime:Je(X),endTime:mr(X),text:X.text,segmentIdx:K}});try{await je.saveVoiceSamples(e.id,y),console.log(`Saved ${y.length} voice samples`)}catch(T){console.error("Failed to save voice samples:",T)}}S(!1),O({}),ne({}),ln()}catch(y){console.error("Failed to save edits:",y),alert("Failed to save edits: "+y.message)}finally{$(!1)}};p.useEffect(()=>{const y=async()=>{try{const T=await je.getAudioPath(e.id);T&&G(ha(T))}catch(T){console.error("Failed to load audio path:",T)}};e!=null&&e.id&&y()},[e]),p.useEffect(()=>{const y=We.current;if(!y)return;const T=()=>Vt(y.currentTime),K=()=>Bn(y.duration),X=()=>Vn(!0),we=()=>Vn(!1),g=()=>{Vn(!1),Vt(0)};return y.addEventListener("timeupdate",T),y.addEventListener("durationchange",K),y.addEventListener("play",X),y.addEventListener("pause",we),y.addEventListener("ended",g),()=>{y.removeEventListener("timeupdate",T),y.removeEventListener("durationchange",K),y.removeEventListener("play",X),y.removeEventListener("pause",we),y.removeEventListener("ended",g)}},[V]);const ja=()=>{We.current&&(Gt?We.current.pause():We.current.play())},un=y=>{We.current&&(We.current.currentTime=y,Vt(y))},Zs=y=>{var K;const T=Je(y);un(T),Gt||(K=We.current)==null||K.play()},ka=y=>{const T=y.currentTarget.getBoundingClientRect(),X=(y.clientX-T.left)/T.width*Bt;un(X)},el=y=>{We.current&&un(Math.max(0,Math.min(Bt,Ut+y)))},_a=()=>{const y=[1,1.25,1.5,1.75,2],T=y.indexOf(sn),K=y[(T+1)%y.length];Jt(K),We.current&&(We.current.playbackRate=K)},tl=(e==null?void 0:e.title)||"Transcript";return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:t,children:n.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] flex flex-col shadow-2xl",onClick:y=>y.stopPropagation(),children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 truncate",children:tl}),n.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[(s==null?void 0:s.language)&&n.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded text-xs",children:s.language}),s!=null&&s.has_diarization?n.jsxs("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs flex items-center gap-1",children:[" ",s.num_speakers," speakers"]}):s&&n.jsx("button",{onClick:qs,disabled:de,className:"px-2 py-0.5 bg-orange-100 hover:bg-orange-200 text-orange-700 rounded text-xs flex items-center gap-1 transition-colors disabled:opacity-50",title:"Run speaker diarization to identify who is speaking",children:de?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"animate-spin",children:""})," Running..."]}):n.jsxs(n.Fragment,{children:[" No speaker data - ",n.jsx("span",{className:"underline",children:"Run Diarization"})]})}),n.jsx("button",{onClick:()=>Gs(!0),disabled:$t,className:"px-2 py-0.5 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 rounded text-xs flex items-center gap-1 transition-colors disabled:opacity-50",title:"Analyze transcript for characters, commercials, and bits",children:$t?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"animate-spin",children:""})," Analyzing..."]}):n.jsx(n.Fragment,{children:" Analyze Content"})}),st&&st.length>0&&n.jsxs("button",{onClick:()=>It(!Ee),className:`px-2 py-0.5 rounded text-xs flex items-center gap-1 transition-colors ${Ee?"bg-indigo-500 text-white":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200"}`,children:[" ",st.length," items found"]})]})]}),n.jsx("button",{className:"text-gray-400 hover:text-gray-600 text-2xl leading-none p-1",onClick:t,children:""})]})}),V&&n.jsxs("div",{className:"px-6 py-3 bg-gradient-to-r from-purple-50 to-indigo-50 border-b border-purple-100",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:ja,className:"w-12 h-12 flex items-center justify-center bg-purple-500 hover:bg-purple-600 text-white rounded-full shadow-md transition-colors",children:Gt?n.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:[n.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),n.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}):n.jsx("svg",{className:"w-5 h-5 ml-1",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M8 5v14l11-7z"})})}),n.jsx("button",{onClick:()=>el(-10),className:"p-2 text-gray-600 hover:text-purple-600 transition-colors",title:"Back 10s",children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0019 16V8a1 1 0 00-1.6-.8l-5.333 4zM4.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0011 16V8a1 1 0 00-1.6-.8l-5.334 4z"})})}),n.jsx("button",{onClick:()=>el(10),className:"p-2 text-gray-600 hover:text-purple-600 transition-colors",title:"Forward 10s",children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.933 12.8a1 1 0 000-1.6L6.6 7.2A1 1 0 005 8v8a1 1 0 001.6.8l5.333-4zM19.933 12.8a1 1 0 000-1.6l-5.333-4A1 1 0 0013 8v8a1 1 0 001.6.8l5.333-4z"})})}),n.jsxs("div",{className:"flex-1 flex items-center gap-3",children:[n.jsx("span",{className:"text-xs text-gray-500 w-12 text-right font-mono",children:ni(Ut)}),n.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full cursor-pointer relative group",onClick:ka,children:n.jsx("div",{className:"h-full bg-purple-500 rounded-full relative",style:{width:`${Bt?Ut/Bt*100:0}%`},children:n.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-4 h-4 bg-purple-600 rounded-full shadow opacity-0 group-hover:opacity-100 transition-opacity"})})}),n.jsx("span",{className:"text-xs text-gray-500 w-12 font-mono",children:ni(Bt)})]}),n.jsxs("button",{onClick:_a,className:"px-2 py-1 text-xs font-medium text-gray-600 hover:text-purple-600 bg-white rounded border border-gray-200 transition-colors",title:"Playback speed",children:[sn,"x"]}),n.jsx("button",{onClick:()=>Wn(!Fr),className:`p-2 rounded transition-colors ${Fr?"text-purple-600 bg-purple-100":"text-gray-400 hover:text-gray-600"}`,title:Fr?"Auto-scroll ON":"Auto-scroll OFF",children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})]}),n.jsx("audio",{ref:We,src:V,preload:"metadata",onLoadedMetadata:()=>{e!=null&&e.initialTimestamp&&We.current&&(We.current.currentTime=e.initialTimestamp,Vt(e.initialTimestamp))}})]}),Ee&&st&&st.length>0&&n.jsxs("div",{className:"px-6 py-3 bg-gradient-to-r from-indigo-50 to-purple-50 border-b border-indigo-100 max-h-48 overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-semibold text-indigo-800",children:"Detected Content"}),n.jsx("button",{onClick:()=>It(!1),className:"text-indigo-400 hover:text-indigo-600 text-sm",children:"Hide"})]}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:st.map((y,T)=>n.jsxs("div",{className:`p-2 rounded-lg border cursor-pointer hover:shadow-md transition-all ${y.content_type==="character"?"bg-pink-50 border-pink-200":y.content_type==="commercial"?"bg-orange-50 border-orange-200":"bg-green-50 border-green-200"}`,onClick:()=>{y.start_time!=null&&(un(y.start_time),!Gt&&We.current&&We.current.play())},title:y.raw_text||y.description,children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-lg",children:y.content_type==="character"?"":y.content_type==="commercial"?"":""}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm text-gray-800 truncate",children:y.name}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[n.jsx("span",{className:`px-1.5 py-0.5 rounded ${y.content_type==="character"?"bg-pink-200 text-pink-700":y.content_type==="commercial"?"bg-orange-200 text-orange-700":"bg-green-200 text-green-700"}`,children:y.content_type}),y.start_time!=null&&n.jsx("span",{className:"font-mono",children:ni(y.start_time)}),y.confidence!=null&&n.jsxs("span",{children:[Math.round(y.confidence*100),"%"]})]})]})]}),y.description&&n.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-1",children:y.description})]},T))})]}),n.jsx("div",{className:"px-6 py-4 flex-1 overflow-hidden min-h-0 flex flex-col",children:a?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-10 h-10 border-4 border-purple-200 border-t-purple-500 rounded-full animate-spin mx-auto mb-4"}),n.jsx("div",{className:"text-gray-500",children:"Loading transcript..."})]}):o?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"text-red-500 text-4xl mb-4",children:""}),n.jsx("div",{className:"text-red-600 font-medium",children:o}),n.jsx("button",{onClick:ln,className:"mt-4 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm",children:"Try Again"})]}):s?n.jsxs(n.Fragment,{children:[Ge&&Hs.length>0&&n.jsxs("div",{className:"mb-4 p-3 bg-purple-50 rounded-lg border border-purple-200 flex-shrink-0",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-purple-800",children:"Speaker Names"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-purple-600",children:"Click to preview"}),_?n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>D(!1),className:"text-xs px-2 py-1 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded transition-colors",children:"Cancel"}),n.jsx("button",{onClick:fr,disabled:f,className:"text-xs px-2 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded transition-colors disabled:opacity-50",children:f?"Saving...":"Save"})]}):n.jsx("button",{onClick:()=>D(!0),className:"text-xs px-2 py-1 bg-purple-100 hover:bg-purple-200 text-purple-700 rounded transition-colors",children:"Edit Names"})]})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Hs.map(y=>{const T=cu(y),K=ya(y),X=(fe==null?void 0:fe.findIndex(g=>g.speaker===y))??-1,we=X>=0?fe[X]:null;return n.jsxs("div",{className:`flex items-center gap-2 px-2 py-1 rounded ${T.bg} ${T.border} border cursor-pointer hover:shadow-md transition-shadow`,onClick:()=>{we&&!_&&(Zs(we),Wt.current[X]&&Wt.current[X].scrollIntoView({behavior:"smooth",block:"center"}))},title:_?"":`Click to hear ${y}`,children:[n.jsxs("span",{className:`text-xs ${T.text}`,children:[y,":"]}),_?n.jsx("input",{type:"text",value:E[y]||"",onChange:g=>_t(y,g.target.value),placeholder:"Enter name...",className:"text-sm px-2 py-0.5 border border-gray-300 rounded w-24 focus:outline-none focus:ring-1 focus:ring-purple-500",onClick:g=>g.stopPropagation()}):n.jsx("span",{className:`text-sm font-medium ${T.text}`,children:K!==y?K:"(unnamed)"}),!_&&n.jsx("span",{className:"text-xs opacity-50",children:""}),!_&&K===y&&H.length>0&&n.jsxs("div",{className:"relative",children:[n.jsx("button",{onClick:g=>{g.stopPropagation(),u(d===y?null:y)},className:"px-1.5 py-0.5 text-xs bg-red-100 hover:bg-red-200 text-red-600 rounded transition-colors",children:"Fix"}),d===y&&n.jsxs("div",{className:"absolute left-0 top-full z-20 mt-1 p-2 bg-white rounded-lg shadow-xl border border-gray-200 min-w-32",children:[n.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Choose speaker:"}),n.jsxs("div",{className:"flex flex-col gap-1",children:[H.map(g=>n.jsx("button",{onClick:k=>{k.stopPropagation(),_t(y,g.name),u(null),S(!0)},className:"px-2 py-1 text-xs text-left bg-yellow-50 hover:bg-yellow-100 text-yellow-800 rounded transition-colors",children:g.short_name||g.name},g.name)),n.jsx("button",{onClick:g=>{g.stopPropagation(),u(null)},className:"px-2 py-1 text-xs text-gray-500 hover:bg-gray-100 rounded transition-colors mt-1 border-t",children:"Cancel"})]})]})]}),Xn[y]>0&&n.jsxs("span",{className:"px-1.5 py-0.5 bg-yellow-400 text-yellow-900 rounded text-xs font-medium",children:["",Xn[y]]})]},y)})})]}),n.jsxs("div",{className:"mb-4 flex gap-3 flex-shrink-0",children:[n.jsx("input",{type:"text",placeholder:"Search in transcript...",className:"flex-1 px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",value:m,onChange:y=>v(y.target.value)}),Ge&&n.jsxs("div",{className:"flex rounded-lg border border-gray-200 overflow-hidden",children:[n.jsx("button",{onClick:()=>x("speakers"),className:`px-3 py-2 text-sm font-medium transition-colors ${b==="speakers"?"bg-purple-500 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:"By Speaker"}),n.jsx("button",{onClick:()=>x("plain"),className:`px-3 py-2 text-sm font-medium transition-colors ${b==="plain"?"bg-purple-500 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:"Plain Text"})]})]}),n.jsx("div",{ref:Mr,className:"bg-gray-50 p-4 rounded-lg text-sm leading-relaxed flex-1 overflow-y-auto",children:Ge&&b==="speakers"&&on?n.jsxs("div",{className:"space-y-3",children:[on.map((y,T)=>{var Qe,Ze,me,Qt;const K=va(y,T),X=Ur(y,T),we=cu(K),g=ue(y),k=E[K]||K,P=A===T,W=((Qe=N[T])==null?void 0:Qe.speaker)||((Ze=N[T])==null?void 0:Ze.text),ie=Ir===T,Pe=J[T];return n.jsxs("div",{ref:R=>Wt.current[T]=R,className:`p-3 rounded-lg transition-all ${we.bg} ${Pe?"ring-2 ring-red-500 bg-red-50":""} ${W?"ring-2 ring-yellow-400":""} ${ie?`ring-2 ${we.ring} shadow-md`:""}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[n.jsxs("button",{onClick:()=>Ks(T),className:`px-2 py-0.5 rounded text-xs font-medium ${we.label} hover:opacity-80 transition-opacity cursor-pointer`,title:"Click to change speaker",children:[k,n.jsx("span",{className:"ml-1 opacity-50",children:""})]}),g&&n.jsx("button",{onClick:()=>Zs(y),className:"text-xs text-gray-400 hover:text-purple-600 transition-colors",title:"Jump to this time",children:g}),J[T]&&n.jsxs("span",{className:`px-1.5 py-0.5 rounded text-xs font-medium flex items-center gap-1 cursor-pointer ${J[T].flag_type==="wrong_speaker"?"bg-red-100 text-red-700":J[T].flag_type==="character_voice"?"bg-pink-100 text-pink-700":J[T].flag_type==="multiple_speakers"?"bg-orange-100 text-orange-700":J[T].flag_type==="audio_issue"?"bg-gray-100 text-gray-700":"bg-yellow-100 text-yellow-700"}`,title:`${((me=ri.find(R=>R.id===J[T].flag_type))==null?void 0:me.label)||"Flagged"}${J[T].corrected_speaker?`  ${J[T].corrected_speaker}`:""}${J[T].notes?`: ${J[T].notes}`:""}`,onClick:async R=>{R.stopPropagation(),await r("Remove this flag?")&&Hn(T)},children:[((Qt=ri.find(R=>R.id===J[T].flag_type))==null?void 0:Qt.icon)||"",J[T].corrected_speaker&&n.jsxs("span",{className:"text-[10px]",children:["",J[T].corrected_speaker]})]}),(()=>{const R=wa(T);return R&&n.jsxs("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium bg-pink-100 text-pink-700 flex items-center gap-1 cursor-pointer",title:`Character: ${R.character_name}`,onClick:async Le=>{Le.stopPropagation(),await r(`Remove ${R.character_name} from this segment?`)&&Kn(R.id)},children:[" ",R.character_name]})})(),(()=>{const R=qn(T);return R&&n.jsxs("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium cursor-pointer",style:{backgroundColor:R.chapter_type_color+"33",color:R.chapter_type_color},title:`${R.chapter_type_name}${R.title?": "+R.title:""} (click to remove)`,onClick:async Le=>{Le.stopPropagation(),await r(`Remove chapter "${R.chapter_type_name}"?`)&&Yn(R.id)},children:[R.chapter_type_icon," ",R.chapter_type_name]})})(),le[T]&&n.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-400 text-yellow-900 rounded text-xs font-medium cursor-pointer",title:"Voice sample marked (click to unmark)",onClick:R=>{R.stopPropagation(),Qn(T)},children:""}),n.jsxs("div",{className:"relative ml-auto",children:[n.jsx("button",{onClick:R=>{R.stopPropagation(),B(I===T?null:T),ye(null)},className:`p-1 rounded transition-colors ${I===T?"bg-purple-500 text-white":"bg-gray-100 text-gray-400 hover:bg-gray-200 hover:text-gray-600"}`,title:"Segment actions",children:n.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})})}),I===T&&n.jsxs("div",{className:"absolute right-0 top-full z-30 mt-1 p-1 bg-white rounded-lg shadow-xl border border-gray-200 min-w-48",children:[n.jsxs("button",{onClick:R=>{R.stopPropagation(),ye(se==="speaker"?null:"speaker")},className:`w-full px-3 py-2 text-xs text-left rounded flex items-center gap-2 transition-colors ${se==="speaker"?"bg-purple-100 text-purple-700":"hover:bg-gray-100"}`,children:[n.jsx("span",{children:""}),n.jsx("span",{children:"Change Speaker"}),n.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),n.jsxs("button",{onClick:R=>{R.stopPropagation(),ye(se==="flag"?null:"flag")},className:`w-full px-3 py-2 text-xs text-left rounded flex items-center gap-2 transition-colors ${se==="flag"?"bg-red-100 text-red-700":"hover:bg-gray-100"}`,children:[n.jsx("span",{children:""}),n.jsx("span",{children:"Flag Issue"}),n.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),n.jsxs("button",{onClick:R=>{R.stopPropagation(),ye(se==="character"?null:"character")},className:`w-full px-3 py-2 text-xs text-left rounded flex items-center gap-2 transition-colors ${se==="character"?"bg-pink-100 text-pink-700":"hover:bg-gray-100"}`,children:[n.jsx("span",{children:""}),n.jsx("span",{children:"Mark Character"}),n.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),n.jsxs("button",{onClick:R=>{R.stopPropagation(),Qn(T),B(null)},className:"w-full px-3 py-2 text-xs text-left rounded flex items-center gap-2 hover:bg-gray-100 transition-colors",children:[n.jsx("span",{children:le[T]?"":""}),n.jsx("span",{children:le[T]?"Unmark Audio Sample":"Mark Audio Sample"})]}),n.jsxs("button",{onClick:R=>{R.stopPropagation(),ye(se==="chapter"?null:"chapter")},className:`w-full px-3 py-2 text-xs text-left rounded flex items-center gap-2 transition-colors ${se==="chapter"?"bg-indigo-100 text-indigo-700":"hover:bg-gray-100"}`,children:[n.jsx("span",{children:""}),n.jsx("span",{children:"Mark Chapter"}),n.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),se==="speaker"&&n.jsxs("div",{className:"mt-1 pt-1 border-t border-gray-100",children:[n.jsxs("div",{className:"px-3 py-1 text-[10px] text-gray-400 uppercase",children:["Assign name to ",y.speaker,":"]}),H.map(R=>n.jsxs("button",{onClick:Le=>{Le.stopPropagation(),Zt(y.speaker,R.name),B(null)},className:"w-full px-3 py-1.5 text-xs text-left rounded flex items-center gap-2 hover:bg-yellow-50 text-yellow-800",children:[n.jsx("span",{children:""}),n.jsx("span",{children:R.short_name||R.name})]},R.name)),H.length===0&&ou.map(R=>n.jsx("button",{onClick:Le=>{Le.stopPropagation(),Zt(y.speaker,R.id),B(null)},className:"w-full px-3 py-1.5 text-xs text-left rounded hover:bg-purple-50 text-purple-800",children:R.short},R.id))]}),se==="flag"&&n.jsxs("div",{className:"mt-1 pt-1 border-t border-gray-100",children:[n.jsx("div",{className:"px-3 py-1 text-[10px] text-gray-400 uppercase",children:"Flag type:"}),ri.map(R=>n.jsxs("button",{onClick:Le=>{if(Le.stopPropagation(),R.needsSpeaker){const Ue=prompt(`Who should this be assigned to?

Current: ${y.speaker}
Enter name:`);Ue&&Vr(T,R.id,Ue,null,null)}else if(R.needsCharacter)ye("flag-character");else if(R.needsNotes){const Ue=prompt("Add a note about this segment:");Ue&&Vr(T,R.id,null,null,Ue)}else Vr(T,R.id,null,null,null)},className:"w-full px-3 py-1.5 text-xs text-left rounded flex items-center gap-2 hover:bg-red-50",title:R.description,children:[n.jsx("span",{children:R.icon}),n.jsx("span",{children:R.label})]},R.id)),J[T]&&n.jsxs("button",{onClick:R=>{R.stopPropagation(),Hn(T)},className:"w-full px-3 py-1.5 text-xs text-left rounded flex items-center gap-2 hover:bg-gray-100 text-gray-500 mt-1 border-t border-gray-100",children:[n.jsx("span",{children:""}),n.jsx("span",{children:"Remove Flag"})]})]}),se==="flag-character"&&n.jsxs("div",{className:"mt-1 pt-1 border-t border-gray-100",children:[n.jsx("div",{className:"px-3 py-1 text-[10px] text-gray-400 uppercase",children:"Which character?"}),he.slice(0,8).map(R=>n.jsxs("button",{onClick:Le=>{Le.stopPropagation(),Vr(T,"character_voice",null,R.id,null)},className:"w-full px-3 py-1.5 text-xs text-left rounded flex items-center gap-2 hover:bg-pink-50 text-pink-800",children:[n.jsx("span",{children:""}),n.jsx("span",{children:R.name})]},R.id)),n.jsx("button",{onClick:R=>{R.stopPropagation(),ye("flag")},className:"w-full px-3 py-1 text-xs text-gray-500 hover:bg-gray-100 rounded mt-1 border-t",children:" Back"})]}),se==="character"&&n.jsxs("div",{className:"mt-1 pt-1 border-t border-gray-100",children:[n.jsx("div",{className:"px-3 py-1 text-[10px] text-gray-400 uppercase",children:"Select character:"}),he.slice(0,8).map(R=>n.jsxs("button",{onClick:Le=>{Le.stopPropagation(),xr(T,R.id)},className:"w-full px-3 py-1.5 text-xs text-left rounded flex items-center gap-2 hover:bg-pink-50 text-pink-800",children:[n.jsx("span",{children:""}),n.jsx("span",{children:R.name}),R.appearance_count>0&&n.jsxs("span",{className:"ml-auto text-[10px] text-gray-400",children:["(",R.appearance_count,")"]})]},R.id)),n.jsx("div",{className:"px-2 py-1 mt-1 border-t border-gray-100",children:n.jsx("input",{type:"text",placeholder:"+ New character...",value:ce,onChange:R=>pr(R.target.value),onKeyDown:R=>{R.key==="Enter"&&ce.trim()&&(R.stopPropagation(),Ys(T,ce))},className:"w-full px-2 py-1 text-xs border rounded",onClick:R=>R.stopPropagation()})})]}),se==="chapter"&&n.jsxs("div",{className:"mt-1 pt-1 border-t border-gray-100",children:[n.jsx("div",{className:"px-3 py-1 text-[10px] text-gray-400 uppercase",children:"Chapter type:"}),Oe.map(R=>n.jsxs("button",{onClick:Le=>{Le.stopPropagation(),Xs(R.id,T)},className:"w-full px-3 py-1.5 text-xs text-left rounded flex items-center gap-2 hover:bg-indigo-50",children:[n.jsx("span",{children:R.icon}),n.jsx("span",{style:{color:R.color},children:R.name})]},R.id))]})]})]}),ie&&n.jsx("span",{className:"text-xs text-purple-600 font-medium animate-pulse",children:" Playing"}),W&&n.jsx("span",{className:"text-xs text-yellow-600 font-medium",children:"edited"})]}),P&&n.jsxs("div",{className:"mb-2 p-2 bg-white rounded border shadow-lg",children:[n.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Assign name to ",n.jsx("span",{className:"font-mono font-medium",children:y.speaker}),":"]}),H.length>0&&n.jsxs("div",{className:"mb-2",children:[n.jsxs("div",{className:"text-xs text-yellow-600 mb-1 flex items-center gap-1",children:[n.jsx("span",{children:""})," Audio Samples:"]}),n.jsx("div",{className:"flex flex-wrap gap-1",children:H.map(R=>{var Le;return n.jsxs("button",{onClick:()=>Zt(y.speaker,R.name),className:"px-2 py-1 text-xs bg-yellow-100 hover:bg-yellow-200 text-yellow-800 rounded transition-colors flex items-center gap-1",children:[n.jsx("span",{className:"w-4 h-4 rounded-full bg-yellow-500 text-white text-[10px] flex items-center justify-center font-bold",children:((Le=R.short_name)==null?void 0:Le.charAt(0))||R.name.charAt(0)}),R.short_name||R.name.split(" ")[0]]},R.name)})})]}),H.length===0&&n.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:ou.map(R=>n.jsx("button",{onClick:()=>Zt(y.speaker,R.id),className:"px-2 py-1 text-xs bg-purple-100 hover:bg-purple-200 text-purple-800 rounded transition-colors",children:R.short},R.id))}),n.jsx("div",{className:"flex gap-2",children:n.jsx("input",{type:"text",placeholder:"Or type custom name...",className:"flex-1 px-2 py-1 text-xs border rounded",onKeyDown:R=>{R.key==="Enter"&&R.target.value&&Zt(y.speaker,R.target.value)}})}),n.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:['This will update all "',y.speaker,'" segments']})]}),n.jsx("p",{className:`${we.text} ${ie?"font-medium":""}`,children:an(X==null?void 0:X.trim())})]},T)}),on.length===0&&m&&n.jsx("p",{className:"text-gray-400 text-center py-4",children:"No matches found"})]}):n.jsx("div",{className:"whitespace-pre-wrap font-sans",children:an(s.full_text||"No transcript text available")})}),ee&&n.jsxs("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center justify-between flex-shrink-0",children:[n.jsxs("div",{className:"text-sm text-yellow-700 flex flex-wrap items-center gap-2",children:[n.jsx("span",{children:"Unsaved changes"}),Object.keys(le).length>0&&n.jsxs("span",{className:"px-2 py-0.5 bg-yellow-200 rounded text-xs",children:[" ",Object.keys(le).length," audio sample",Object.keys(le).length!==1?"s":""]}),cn>0&&n.jsxs("span",{className:"px-2 py-0.5 bg-red-200 text-red-700 rounded text-xs",children:[" ",cn," flagged segment",cn!==1?"s":""]})]}),n.jsx("button",{onClick:Js,disabled:Y,className:"px-3 py-1 bg-yellow-500 hover:bg-yellow-600 text-white rounded text-sm font-medium disabled:opacity-50",children:Y?"Saving...":"Save Changes"})]}),s.transcript_path&&n.jsxs("div",{className:"mt-3 text-xs text-gray-400 truncate flex-shrink-0",children:[" ",s.transcript_path]})]}):n.jsx("div",{className:"text-center py-12 text-gray-400",children:"No transcript available"})}),n.jsx("div",{className:"px-6 py-3 border-t border-gray-200 flex justify-end flex-shrink-0",children:n.jsx("button",{className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors",onClick:t,children:"Close"})})]})})}const kf=e=>{if(!e)return"Unknown duration";const t=Math.floor(e/3600),r=Math.floor(e%3600/60);return t>0?`${t}h ${r}m`:`${r}m`},_f=e=>{if(!e)return null;try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return null}};function Nf(e,t){const r=[];if((t==null?void 0:t.status)==="failed"||e.transcription_status==="failed"){const l=e.transcription_error||"",a=l.toLowerCase().includes("download"),i=(t==null?void 0:t.queue_type)==="diarize_only",o=a?"Download Failed":i?"Diarization Failed":"Failed";r.push(n.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-medium bg-red-100 text-red-700 border border-red-200",title:l,children:o},"failed"))}return(t==null?void 0:t.status)==="processing"?r.push(n.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-medium bg-blue-100 text-blue-700 border border-blue-200",children:[n.jsx("span",{className:"w-2 h-2 border border-blue-300 border-t-blue-700 rounded-full animate-spin"}),"Processing"]},"processing")):(t==null?void 0:t.status)==="pending"&&r.push(n.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-medium bg-yellow-100 text-yellow-700 border border-yellow-200",children:[n.jsx("span",{className:"w-1.5 h-1.5 bg-yellow-500 rounded-full animate-pulse"}),"Queue #",t.priority]},"queued")),r.length===0&&(e.is_transcribed?r.push(n.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-medium bg-green-100 text-green-700 border border-green-200",children:" Transcribed"},"transcribed")):e.is_downloaded?r.push(n.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-medium bg-blue-100 text-blue-700 border border-blue-200",children:"Downloaded"},"downloaded")):r.push(n.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-medium bg-gray-100 text-gray-600 border border-gray-200",children:"Pending"},"pending"))),n.jsx(n.Fragment,{children:r})}function Sf({selectedEpisodeId:e,onSelectEpisode:t,onNotification:r}){const[s,l]=p.useState([]),[a,i]=p.useState(!0),[o,c]=p.useState(0),[m,v]=p.useState(""),[b,x]=p.useState({}),[E,h]=p.useState(0),[_,D]=p.useState(null),[d,u]=p.useState(null),[f,C]=p.useState([]),[A,z]=p.useState("published_date"),[N,O]=p.useState(!0),[ee,S]=p.useState(!1),[Y,$]=p.useState({transcribed_only:!1,in_queue_only:!1,failed_only:!1,downloaded_only:!1,not_downloaded_only:!1,diarized_only:!1,limit:50,offset:0});p.useEffect(()=>{je.getCategoryRules().then(L=>{L&&L.length>0&&C(L)}).catch(L=>console.error("Failed to load category rules:",L))},[]),p.useEffect(()=>{V()},[Y,m,_,d,A,N]),p.useEffect(()=>{G();const L=setInterval(G,5e3);return()=>clearInterval(L)},[]);const V=async()=>{try{i(!0);const L=await je.getEpisodes({...Y,search:m,..._?{feed_source:_}:{},...d?{category:d}:{},sort_by:A,sort_desc:N});l(L.episodes||[]),c(L.total||0)}catch(L){console.error("Error loading episodes:",L)}finally{i(!1)}},G=async()=>{var L,re,xe;try{const Re=await ei.getQueue(),he=Re.queue||Re,Q={};(L=he.processing)==null||L.forEach(w=>{var I,B;Q[((I=w.episode)==null?void 0:I.id)||w.episode_id]={status:"processing",queue_type:((B=w.queue_item)==null?void 0:B.queue_type)||"full"}}),(re=he.pending)==null||re.forEach((w,I)=>{var B,se;Q[((B=w.episode)==null?void 0:B.id)||w.episode_id]={status:"pending",priority:I+1,queue_type:((se=w.queue_item)==null?void 0:se.queue_type)||"full"}}),(xe=he.failed)==null||xe.forEach(w=>{var I,B;Q[((I=w.episode)==null?void 0:I.id)||w.episode_id]={status:"failed",queue_type:((B=w.queue_item)==null?void 0:B.queue_type)||"full"}}),x(Q);const ae=await je.getEpisodes({failed_only:!0,limit:1,offset:0});h(ae.total||0)}catch(Re){console.error("Error loading queue:",Re)}},le=async(L,re=0)=>{try{await ei.addToQueue(L,re),r==null||r("Added to queue","success"),G()}catch(xe){r==null||r(`Error: ${xe.message}`,"error")}},ne=async L=>{try{await ei.removeFromQueue(L),r==null||r("Removed from queue","success"),G()}catch(re){r==null||r(`Error: ${re.message}`,"error")}},J=Math.floor(Y.offset/Y.limit)+1,j=Math.ceil(o/Y.limit),H=L=>{$(re=>({...re,offset:(L-1)*re.limit}))},Z=async()=>{try{S(!0),await je.refreshFeed(_||"patreon",!1),r==null||r("Feed synced","success"),await V()}catch(L){r==null||r(`Sync error: ${L.message}`,"error")}finally{S(!1)}},de=[{key:"published_date",label:"Date"},{key:"title",label:"Title"},{key:"episode_number",label:"Ep#"}],oe=Object.values(b),Oe={processing:oe.filter(L=>L.status==="processing").length,queueFailed:oe.filter(L=>L.status==="failed").length,transcriptionPending:oe.filter(L=>L.status==="pending"&&L.queue_type!=="diarize_only").length,diarizationPending:oe.filter(L=>L.status==="pending"&&L.queue_type==="diarize_only").length},ke=Math.max(E,Oe.queueFailed);return n.jsxs("div",{className:"h-full flex flex-col bg-white border-r border-gray-200",children:[n.jsxs("div",{className:"p-4 border-b border-gray-200 flex-shrink-0",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Library"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:V,disabled:a,title:"Reload episodes",className:"p-1.5 text-gray-400 hover:text-purple-600 hover:bg-purple-50 rounded-md transition-colors",children:n.jsx("svg",{className:`w-4 h-4 ${a?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),n.jsx("button",{onClick:Z,disabled:ee,title:"Sync RSS feed",className:"p-1.5 text-gray-400 hover:text-purple-600 hover:bg-purple-50 rounded-md transition-colors",children:n.jsx("svg",{className:`w-4 h-4 ${ee?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})})})]})]}),n.jsx("input",{type:"text",placeholder:"Search episodes...",value:m,onChange:L=>v(L.target.value),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),n.jsxs("div",{className:"flex items-center gap-1.5 mt-3 flex-wrap",children:[n.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:"Status:"}),n.jsx("button",{onClick:()=>$(L=>({...L,transcribed_only:!L.transcribed_only,offset:0})),className:`px-2 py-1 text-xs rounded-full transition-colors ${Y.transcribed_only?"bg-green-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Transcribed"}),n.jsx("button",{onClick:()=>$(L=>({...L,diarized_only:!L.diarized_only,offset:0})),className:`px-2 py-1 text-xs rounded-full transition-colors ${Y.diarized_only?"bg-purple-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Diarized"}),n.jsx("button",{onClick:()=>$(L=>({...L,in_queue_only:!L.in_queue_only,offset:0})),className:`px-2 py-1 text-xs rounded-full transition-colors ${Y.in_queue_only?"bg-yellow-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"In Queue"}),n.jsx("button",{onClick:()=>$(L=>({...L,downloaded_only:!L.downloaded_only,not_downloaded_only:!1,offset:0})),className:`px-2 py-1 text-xs rounded-full transition-colors ${Y.downloaded_only?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Downloaded"}),n.jsx("button",{onClick:()=>$(L=>({...L,not_downloaded_only:!L.not_downloaded_only,downloaded_only:!1,offset:0})),className:`px-2 py-1 text-xs rounded-full transition-colors ${Y.not_downloaded_only?"bg-gray-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Not Downloaded"}),ke>0&&n.jsx("button",{onClick:()=>$(L=>({...L,failed_only:!L.failed_only,offset:0})),className:`px-2 py-1 text-xs rounded-full transition-colors ${Y.failed_only?"bg-red-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Failed"})]}),n.jsxs("div",{className:"flex items-center gap-1.5 mt-2 flex-wrap",children:[n.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:"Source:"}),[null,"patreon","apple"].map(L=>n.jsx("button",{onClick:()=>{D(L),$(re=>({...re,offset:0}))},className:`px-2 py-1 text-xs rounded-full transition-colors ${_===L?"bg-purple-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:L==="patreon"?" Patreon":L==="apple"?" Apple":" All"},L||"all"))]}),f.length>0&&n.jsxs("div",{className:"flex items-center gap-1.5 mt-2 flex-wrap",children:[n.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:"Category:"}),n.jsx("button",{onClick:()=>{u(null),$(L=>({...L,offset:0}))},className:`px-2 py-1 text-xs rounded-full transition-colors ${d===null?"bg-indigo-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"All"}),f.filter(L=>L.priority<99).map(L=>n.jsxs("button",{onClick:()=>{u(L.category),$(re=>({...re,offset:0}))},className:`px-2 py-1 text-xs rounded-full transition-colors ${d===L.category?"text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,style:d===L.category?{backgroundColor:L.color||"#6366f1"}:{},children:[L.icon," ",L.display_name]},L.category)),n.jsx("button",{onClick:()=>{u("bonus"),$(L=>({...L,offset:0}))},className:`px-2 py-1 text-xs rounded-full transition-colors ${d==="bonus"?"bg-gray-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:" Bonus"})]}),n.jsxs("div",{className:"flex items-center gap-1.5 mt-2",children:[n.jsx("span",{className:"text-[11px] text-gray-500 font-medium",children:"Sort:"}),de.map(L=>{const re=A===L.key;return n.jsxs("button",{onClick:()=>{re?O(xe=>!xe):(z(L.key),O(!0)),$(xe=>({...xe,offset:0}))},className:`px-2 py-0.5 text-[11px] rounded-full transition-colors ${re?"bg-purple-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[L.label,re?N?" ":" ":""]},L.key)})]}),o>0&&n.jsxs("div",{className:"flex items-center justify-between mt-3",children:[n.jsxs("div",{className:"text-[11px] text-gray-400",children:[Y.offset+1,"",Math.min(Y.offset+s.length,o)," of ",o]}),j>1&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>H(J-1),disabled:J<=1||a,className:"px-1.5 py-0.5 text-[11px] rounded bg-gray-100 text-gray-600 hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed",children:""}),n.jsxs("span",{className:"text-[11px] text-gray-500 px-1",children:[J," / ",j]}),n.jsx("button",{onClick:()=>H(J+1),disabled:J>=j||a,className:"px-1.5 py-0.5 text-[11px] rounded bg-gray-100 text-gray-600 hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed",children:""})]})]})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto",children:[a&&s.length===0?n.jsxs("div",{className:"p-4 text-center text-gray-500",children:[n.jsx("div",{className:"w-6 h-6 border-2 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),"Loading..."]}):n.jsx("div",{className:"divide-y divide-gray-100",children:s.map(L=>{const re=b[L.id],xe=e===L.id,Re=_f(L.published_date),he=f.find(w=>w.category===L.category),Q=he?`${he.icon||""} ${he.display_name}`:null,ae=L.feed_source==="patreon"?"":"";return n.jsxs("div",{onClick:()=>t==null?void 0:t(L),className:`p-3 cursor-pointer transition-colors ${xe?"bg-purple-50 border-l-4 border-purple-500":"hover:bg-gray-50 border-l-4 border-transparent"}`,children:[n.jsx("div",{className:"font-medium text-sm text-gray-800 line-clamp-2 mb-1",children:L.title}),n.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-gray-500 mb-1 flex-wrap",children:[Q&&L.category!=="episode"&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"font-medium px-1 py-0 rounded text-[10px]",style:{backgroundColor:((he==null?void 0:he.color)||"#6366f1")+"20",color:(he==null?void 0:he.color)||"#6366f1"},children:Q}),n.jsx("span",{children:""})]}),(L.category_number||L.episode_number)&&n.jsxs(n.Fragment,{children:[n.jsxs("span",{className:"font-medium text-gray-600",children:[L.category==="episode"?"Ep.":"#"," ",L.category_number||L.episode_number]}),n.jsx("span",{children:""})]}),n.jsx("span",{children:ae}),Re&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsx("span",{children:Re})]}),L.sub_series&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsx("span",{className:"italic text-gray-400",children:L.sub_series})]})]}),n.jsx("div",{className:"text-[11px] text-gray-400 mb-1.5",children:kf(L.duration)}),L.description&&n.jsx("p",{className:"text-[11px] text-gray-400 line-clamp-2 mb-2 leading-relaxed",children:L.description.replace(/<[^>]*>/g,"")}),n.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[Nf(L,re),L.has_diarization&&L.is_transcribed&&n.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded text-[10px] font-medium bg-purple-100 text-purple-700 border border-purple-200",children:[" ",L.num_speakers||2," speakers"]}),L.is_transcribed&&n.jsx("button",{onClick:w=>{w.stopPropagation(),t==null||t(L)},className:"px-2 py-0.5 text-[10px] font-medium bg-purple-100 text-purple-700 hover:bg-purple-200 rounded transition-colors",children:"View"}),!L.is_transcribed&&L.is_downloaded&&!re&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:w=>{w.stopPropagation(),le(L.id)},className:"px-2 py-0.5 text-[10px] font-medium bg-yellow-100 text-yellow-700 hover:bg-yellow-200 rounded transition-colors",children:"+ Queue"}),n.jsx("button",{onClick:w=>{w.stopPropagation(),le(L.id,10)},className:"px-2 py-0.5 text-[10px] font-medium bg-yellow-400 text-yellow-900 hover:bg-yellow-500 rounded transition-colors",title:"Add with high priority",children:" Priority"})]}),(re==null?void 0:re.status)==="pending"&&n.jsx("button",{onClick:w=>{w.stopPropagation(),ne(L.id)},className:"px-2 py-0.5 text-[10px] font-medium bg-red-100 text-red-700 hover:bg-red-200 rounded transition-colors",children:"Remove"})]})]},L.id)})}),j>1&&n.jsxs("div",{className:"flex items-center justify-center gap-1 p-2 border-t border-gray-100 flex-shrink-0",children:[n.jsx("button",{onClick:()=>H(1),disabled:J<=1||a,className:"px-1.5 py-1 text-[11px] rounded bg-gray-100 text-gray-600 hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed",children:""}),n.jsx("button",{onClick:()=>H(J-1),disabled:J<=1||a,className:"px-1.5 py-1 text-[11px] rounded bg-gray-100 text-gray-600 hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed",children:" Prev"}),n.jsxs("span",{className:"text-[11px] text-gray-500 px-2",children:[J," / ",j]}),n.jsx("button",{onClick:()=>H(J+1),disabled:J>=j||a,className:"px-1.5 py-1 text-[11px] rounded bg-gray-100 text-gray-600 hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed",children:"Next "}),n.jsx("button",{onClick:()=>H(j),disabled:J>=j||a,className:"px-1.5 py-1 text-[11px] rounded bg-gray-100 text-gray-600 hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed",children:""})]})]})]})}const si=[{id:"wrong_speaker",label:"Wrong Speaker",icon:"",needsSpeaker:!0},{id:"character_voice",label:"Character Voice",icon:"",needsCharacter:!0},{id:"multiple_speakers",label:"Multiple Speakers",icon:"",needsSpeakers:!0},{id:"audio_issue",label:"Audio Issue",icon:""},{id:"other",label:"Other",icon:"",needsNotes:!0}],uu={SPEAKER_00:{bg:"bg-blue-100",text:"text-blue-700",label:"bg-blue-200 text-blue-800",border:"border-blue-300",ring:"ring-blue-400",hex:"#dbeafe",borderHex:"#93c5fd"},SPEAKER_01:{bg:"bg-green-100",text:"text-green-700",label:"bg-green-200 text-green-800",border:"border-green-300",ring:"ring-green-400",hex:"#dcfce7",borderHex:"#86efac"},SPEAKER_02:{bg:"bg-orange-100",text:"text-orange-700",label:"bg-orange-200 text-orange-800",border:"border-orange-300",ring:"ring-orange-400",hex:"#ffedd5",borderHex:"#fdba74"},SPEAKER_03:{bg:"bg-purple-100",text:"text-purple-700",label:"bg-purple-200 text-purple-800",border:"border-purple-300",ring:"ring-purple-400",hex:"#f3e8ff",borderHex:"#c084fc"},SPEAKER_04:{bg:"bg-pink-100",text:"text-pink-700",label:"bg-pink-200 text-pink-800",border:"border-pink-300",ring:"ring-pink-400",hex:"#fce7f3",borderHex:"#f9a8d4"},SPEAKER_05:{bg:"bg-cyan-100",text:"text-cyan-700",label:"bg-cyan-200 text-cyan-800",border:"border-cyan-300",ring:"ring-cyan-400",hex:"#cffafe",borderHex:"#67e8f9"},UNKNOWN:{bg:"bg-gray-100",text:"text-gray-600",label:"bg-gray-200 text-gray-600",border:"border-gray-300",ring:"ring-gray-400",hex:"#f3f4f6",borderHex:"#d1d5db"}},du=e=>uu[e]||uu.UNKNOWN,li=e=>{if(!e||isNaN(e))return"00:00";const t=Math.floor(e/3600),r=Math.floor(e%3600/60),s=Math.floor(e%60);return t>0?`${t}:${r.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${r}:${s.toString().padStart(2,"0")}`};function Cf({episode:e,onClose:t,onNotification:r,onFlaggedSegmentsChange:s,onCharacterAppearancesChange:l,onChaptersChange:a,onMarkedSamplesChange:i,onSpeakersChange:o,onSpeakerNamesChange:c,onVoiceLibraryChange:m,onAudioDropInstancesChange:v,onAudioDropsChange:b,onSegmentsChange:x,selectedSegmentIdx:E,onSelectedSegmentChange:h,onTranscriptLoaded:_}){const[D,d]=p.useState(null),[u,f]=p.useState(!0),[C,A]=p.useState(null),[z,N]=p.useState(""),[O,ee]=p.useState("speakers"),[S,Y]=p.useState({}),[$,V]=p.useState([]),[G,le]=p.useState([]),[ne,J]=p.useState([]),[j,H]=p.useState(!1),[Z,de]=p.useState(!1),[oe,Oe]=p.useState(!1),[ke,L]=p.useState(!1),[re,xe]=p.useState({}),[Re,he]=p.useState([]),[Q,ae]=p.useState([]),[w,I]=p.useState({}),[B,se]=p.useState([]),[ye,$t]=p.useState([]),[zt,st]=p.useState([]),[Ne,Ee]=p.useState(null),[It,ce]=p.useState(""),[pr,Gt]=p.useState(""),[Vn,Ut]=p.useState(null),[Vt,Bt]=p.useState([]),[Bn,Fr]=p.useState(null),[Wn,sn]=p.useState(!1),[Jt,We]=p.useState(0),[Mr,Wt]=p.useState(0),[Or,ln]=p.useState(!0),[fe,Hs]=p.useState(1),Ge=p.useRef(null),ya=p.useRef(null),Je=p.useRef({});p.useEffect(()=>{e!=null&&e.id&&(mr(),Ir(),Oe(!1),L(!1))},[e==null?void 0:e.id]),p.useEffect(()=>{if(!ke||!F)return;let g;return Bs(async()=>{const{listen:k}=await import("./event-DDX7swQu.js");return{listen:k}},[]).then(({listen:k})=>{k("transcription_complete",P=>{P.payload===(e==null?void 0:e.id)&&(L(!1),Oe(!1))}).then(P=>{g=P})}),()=>{g&&g()}},[ke,e==null?void 0:e.id]);const mr=async()=>{try{f(!0),A(null);const[g,k,P,W,ie,Pe,Qe,Ze,me,Qt]=await Promise.all([je.getTranscript(e.id),lt.getVoiceLibrary().catch(()=>[]),te.getChapterTypes().catch(()=>[]),te.getEpisodeChapters(e.id).catch(()=>[]),te.getFlaggedSegments(e.id).catch(()=>[]),te.getCharacterAppearancesForEpisode(e.id).catch(()=>[]),te.getCharacters().catch(()=>[]),te.getAudioDrops().catch(()=>[]),te.getAudioDropInstances(e.id).catch(()=>[]),lt.getEpisodeSpeakerAssignments(e.id).catch(()=>[])]);d(g),_==null||_(!0),V(k),J(P),le(Qe),se(Ze),b==null||b(Ze),$t(me),v==null||v(me),ae(W),he(Pe),a==null||a(W),l==null||l(Pe);const R={};if(ie.forEach(Ue=>{R[Ue.segment_idx]=Ue}),xe(R),s==null||s(R),st(Qt),g.marked_samples&&Array.isArray(g.marked_samples)){const Ue={};g.marked_samples.forEach(Ep=>{Ue[Ep]=!0}),I(Ue),i==null||i(Ue)}const Le={...g.speaker_names||{}};for(const Ue of Qt)Ue.speaker_name?Le[Ue.diarization_label]=Ue.speaker_name:Ue.audio_drop_name&&(Le[Ue.diarization_label]=Ue.audio_drop_name);Y(Le)}catch(g){console.error("Error loading transcript:",g),A(g.message||"Failed to load transcript"),_==null||_(!1)}finally{f(!1)}},Ir=async()=>{try{const g=await je.getAudioPath(e.id);g&&Fr(ha(g))}catch(g){console.error("Failed to load audio path:",g)}},ue=p.useMemo(()=>{if(!(D!=null&&D.segments_json))return null;try{const g=JSON.parse(D.segments_json);return Array.isArray(g)&&g.length>0?g:null}catch{return null}},[D==null?void 0:D.segments_json]);p.useEffect(()=>{x==null||x(ue)},[ue]);const an=p.useMemo(()=>{if(!ue)return[];const g=new Set;return ue.forEach(k=>{k.speaker&&k.speaker!=="UNKNOWN"&&g.add(k.speaker)}),Array.from(g).sort()},[ue]);p.useEffect(()=>{o==null||o(an)},[an]),p.useEffect(()=>{c==null||c(S)},[S]),p.useEffect(()=>{m==null||m($)},[$]);const on=p.useMemo(()=>(ue==null?void 0:ue.some(g=>g.speaker&&g.speaker!=="UNKNOWN"))??!1,[ue]),_t=p.useCallback(g=>{var k;if((k=g.timestamps)!=null&&k.from){const W=g.timestamps.from.replace(",",".").split(":");if(W.length===3)return parseFloat(W[0])*3600+parseFloat(W[1])*60+parseFloat(W[2])}return typeof g.start=="number"?g.start:0},[]),fr=p.useCallback(g=>{var k;if((k=g.timestamps)!=null&&k.to){const W=g.timestamps.to.replace(",",".").split(":");if(W.length===3)return parseFloat(W[0])*3600+parseFloat(W[1])*60+parseFloat(W[2])}return typeof g.end=="number"?g.end:_t(g)+10},[_t]),va=g=>{var k;return(k=g.timestamps)!=null&&k.from?g.timestamps.from.replace(",",".").slice(0,8):typeof g.start=="number"?li(g.start):""},Ur=p.useMemo(()=>{if(!ue||Jt<=0)return-1;for(let g=0;g<ue.length;g++){const k=_t(ue[g]),P=fr(ue[g]);if(Jt>=k&&Jt<P)return g}return-1},[ue,Jt,_t,fr]);p.useEffect(()=>{Or&&Ur>=0&&Je.current[Ur]&&Je.current[Ur].scrollIntoView({behavior:"smooth",block:"center"})},[Ur,Or]),p.useEffect(()=>{const g=Ge.current;if(!g)return;const k=()=>We(g.currentTime),P=()=>Wt(g.duration),W=()=>sn(!0),ie=()=>sn(!1),Pe=()=>{sn(!1)};return g.addEventListener("timeupdate",k),g.addEventListener("durationchange",P),g.addEventListener("play",W),g.addEventListener("pause",ie),g.addEventListener("ended",Pe),g.duration&&!isNaN(g.duration)&&Wt(g.duration),()=>{g.removeEventListener("timeupdate",k),g.removeEventListener("durationchange",P),g.removeEventListener("play",W),g.removeEventListener("pause",ie),g.removeEventListener("ended",Pe)}},[Bn,u]);const Ks=()=>{Ge.current&&(Wn?Ge.current.pause():Ge.current.play().catch(g=>{console.error("Audio play failed:",g),r==null||r("Audio playback failed  file may be missing","error")}))},Zt=g=>{Ge.current&&(Ge.current.currentTime=g,We(g))},Qn=g=>{const k=_t(g);Zt(k),!Wn&&Ge.current&&Ge.current.play().catch(P=>console.error("Audio play failed:",P))},Vr=g=>{var k;ue!=null&&ue[g]&&(Qn(ue[g]),(k=Je.current[g])==null||k.scrollIntoView({behavior:"smooth",block:"center"}))},Hn=g=>{Ge.current&&Zt(Math.max(0,Math.min(Mr,Jt+g)))},xr=async(g,k,P=null,W=null,ie=null,Pe=null)=>{try{const Qe=Pe?JSON.stringify(Pe):null,Ze=await te.createFlaggedSegment(e.id,g,k,P,W,ie,Qe),me={...re,[g]:{id:Ze,episode_id:e.id,segment_idx:g,flag_type:k,corrected_speaker:P,character_id:W,notes:ie,speaker_ids:Qe,resolved:!1}};xe(me),s==null||s(me),Ee(null),Ut(null),Bt([])}catch(Qe){r==null||r(`Failed to create flag: ${Qe.message}`,"error")}},Ys=async g=>{const k=re[g];if(k)try{await te.deleteFlaggedSegment(k.id);const P={...re};delete P[g],xe(P),s==null||s(P)}catch(P){r==null||r(`Failed to delete flag: ${P.message}`,"error")}},Kn=async(g,k)=>{const P=ue[g];if(P)try{await te.addCharacterAppearance(k,e.id,_t(P),fr(P),g);const W=await te.getCharacterAppearancesForEpisode(e.id);he(W),l==null||l(W),Ee(null)}catch(W){r==null||r(`Failed to add character: ${W.message}`,"error")}},wa=async(g,k)=>{if(k.trim())try{const P=await te.createCharacter(k.trim(),null,null,null);await Kn(g,P);const W=await te.getCharacters();le(W),ce("")}catch(P){r==null||r(`Failed to create character: ${P.message}`,"error")}},cn=async g=>{try{await te.deleteCharacterAppearance(g);const k=await te.getCharacterAppearancesForEpisode(e.id);he(k),l==null||l(k)}catch(k){r==null||r(`Failed to remove character: ${k.message}`,"error")}},qs=async(g,k)=>{if(!ue||k==null)return;const P=ue[k],W=P.start??_t(P),ie=P.end??fr(P);try{await te.createEpisodeChapter(e.id,g,null,W,ie,k,k);const Pe=await te.getEpisodeChapters(e.id);ae(Pe),a==null||a(Pe),Ee(null)}catch(Pe){r==null||r(`Failed to create chapter: ${Pe.message}`,"error")}},Xs=async g=>{try{await te.deleteEpisodeChapter(g);const k=await te.getEpisodeChapters(e.id);ae(k),a==null||a(k)}catch(k){r==null||r(`Failed to delete chapter: ${k.message}`,"error")}},Yn=async(g,k)=>{const P=ue[g];if(P)try{await te.addAudioDropInstance(k,e.id,g,_t(P),fr(P));const W=await te.getAudioDropInstances(e.id);$t(W),v==null||v(W),Ee(null)}catch(W){r==null||r(`Failed to add sound bite: ${W.message}`,"error")}},ba=async(g,k)=>{if(k.trim())try{const P=await te.createAudioDrop(k.trim());await Yn(g,P);const W=await te.getAudioDrops();se(W),Gt("")}catch(P){r==null||r(`Failed to create sound bite: ${P.message}`,"error")}},Gs=async g=>{try{await te.deleteAudioDropInstance(g);const k=await te.getAudioDropInstances(e.id);$t(k),v==null||v(k)}catch(k){r==null||r(`Failed to remove sound bite: ${k.message}`,"error")}},qn=g=>{const k={...w};k[g]?delete k[g]:k[g]=!0,I(k),i==null||i(k),H(!0)},Xn=(g,k)=>{Y(P=>({...P,[g]:k})),H(!0),Ee(null)},Js=async(g,k)=>{Y(P=>({...P,[g]:k.name})),Ee(null);try{await lt.linkEpisodeAudioDrop(e.id,g,k.id),st(P=>[...P.filter(W=>W.diarization_label!==g),{diarization_label:g,audio_drop_id:k.id,audio_drop_name:k.name,speaker_id:null,speaker_name:null}])}catch(P){console.error("Failed to link audio drop:",P)}},ja=async g=>{Y(k=>{const P={...k};return delete P[g],P}),Ee(null),H(!0),st(k=>k.filter(P=>P.diarization_label!==g));try{await lt.unlinkEpisodeSpeaker(e.id,g)}catch(k){console.error("Failed to unlink speaker:",k)}},un=p.useCallback(g=>zt.some(k=>k.diarization_label===g&&k.audio_drop_id),[zt]),Zs=g=>Re.find(k=>k.segment_idx===g),ka=g=>Q.find(k=>k.start_segment_idx<=g&&k.end_segment_idx>=g),el=g=>ye.filter(k=>k.segment_idx===g),_a=g=>{const k=ye.filter(W=>W.audio_drop_id===g.audio_drop_id);return{position:k.findIndex(W=>W.id===g.id)+1,total:k.length}},tl=p.useMemo(()=>{if(!ue)return null;if(!z)return ue;const g=z.toLowerCase();return ue.filter(k=>{var P;return(P=k.text)==null?void 0:P.toLowerCase().includes(g)})},[ue,z]),y=async()=>{if(j)try{de(!0);const g=Object.keys(w).map(k=>parseInt(k));if(await je.updateSpeakerNames(e.id,S,g.length>0?g:null),Object.keys(w).length>0&&ue){const k=Object.keys(w).map(P=>{const W=parseInt(P),ie=ue[W];return{speaker:ie.speaker,speakerName:S[ie.speaker]||ie.speaker,startTime:_t(ie),endTime:fr(ie),text:ie.text,segmentIdx:W}});await je.saveVoiceSamples(e.id,k).catch(()=>{})}H(!1),r==null||r("Changes saved","success")}catch(g){r==null||r(`Failed to save: ${g.message}`,"error")}finally{de(!1)}},T=p.useCallback(g=>{if(!ue)return;const k=ue.findIndex(P=>P.speaker===g);k>=0&&Vr(k)},[ue]);p.useEffect(()=>{const g=k=>{var P,W;if(!(k.target.tagName==="INPUT"||k.target.tagName==="TEXTAREA"||k.target.isContentEditable)&&ue)switch(k.key){case"j":case"J":{k.preventDefault();const ie=E!=null?Math.min(E+1,ue.length-1):0;h==null||h(ie),(P=Je.current[ie])==null||P.scrollIntoView({behavior:"smooth",block:"center"});break}case"k":case"K":{k.preventDefault();const ie=E!=null?Math.max(E-1,0):0;h==null||h(ie),(W=Je.current[ie])==null||W.scrollIntoView({behavior:"smooth",block:"center"});break}case" ":{k.preventDefault(),Ks();break}case"f":case"F":{E!=null&&(k.preventDefault(),Ee(Ne==="flag"?null:"flag"));break}case"c":case"C":{E!=null&&(k.preventDefault(),Ee(Ne==="character"?null:"character"));break}case"h":case"H":{E!=null&&(k.preventDefault(),Ee(Ne==="chapter"?null:"chapter"));break}case"Escape":{k.preventDefault(),Ne?Ee(null):h==null||h(null);break}}};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[ue,E,Ne]),p.useEffect(()=>(typeof window<"u"&&(window.__transcriptEditorSeekToSegment=Vr,window.__transcriptEditorSeekToSpeaker=T,window.__transcriptEditorAssignSpeakerName=Xn,window.__transcriptEditorAddAudioDrop=Yn,window.__transcriptEditorCreateFlag=xr,window.__transcriptEditorAddCharacter=Kn,window.__transcriptEditorCreateChapter=qs,window.__transcriptEditorDeleteFlag=Ys,window.__transcriptEditorRemoveCharacter=cn,window.__transcriptEditorDeleteChapter=Xs,window.__transcriptEditorToggleVoiceSample=qn,window.__transcriptEditorRemoveAudioDrop=Gs,window.__transcriptEditorAssignAudioDrop=Js),()=>{typeof window<"u"&&(delete window.__transcriptEditorSeekToSegment,delete window.__transcriptEditorSeekToSpeaker,delete window.__transcriptEditorAssignSpeakerName,delete window.__transcriptEditorAddAudioDrop,delete window.__transcriptEditorCreateFlag,delete window.__transcriptEditorAddCharacter,delete window.__transcriptEditorCreateChapter,delete window.__transcriptEditorDeleteFlag,delete window.__transcriptEditorRemoveCharacter,delete window.__transcriptEditorDeleteChapter,delete window.__transcriptEditorToggleVoiceSample,delete window.__transcriptEditorRemoveAudioDrop,delete window.__transcriptEditorAssignAudioDrop)}));const K=(g,k)=>{if(g==="flag")return Vn===k?n.jsxs("div",{className:"mt-2 p-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:[n.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide mb-1 px-1",children:"Select speakers present"}),an.map(P=>{const W=S[P]||P,ie=Vt.includes(P),Pe=du(P);return n.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 text-sm rounded hover:bg-gray-50 cursor-pointer",onClick:Qe=>Qe.stopPropagation(),children:[n.jsx("input",{type:"checkbox",checked:ie,onChange:Qe=>{Qe.stopPropagation(),Bt(Ze=>ie?Ze.filter(me=>me!==P):[...Ze,P])},className:"rounded"}),n.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:Pe.hex}}),n.jsx("span",{children:W})]},P)}),n.jsxs("div",{className:"flex gap-2 mt-2 pt-2 border-t border-gray-100",children:[n.jsxs("button",{onClick:P=>{P.stopPropagation(),Vt.length>=2&&xr(k,"multiple_speakers",null,null,null,Vt)},disabled:Vt.length<2,className:"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:["Save (",Vt.length," selected)"]}),n.jsx("button",{onClick:P=>{P.stopPropagation(),Ut(null),Bt([])},className:"px-3 py-1 text-xs bg-gray-100 text-gray-600 rounded hover:bg-gray-200",children:"Cancel"})]})]}):n.jsxs("div",{className:"mt-2 p-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:[n.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide mb-1 px-1",children:"Flag type"}),si.map(P=>n.jsxs("button",{onClick:W=>{if(W.stopPropagation(),P.needsSpeaker){const ie=prompt("Who should this be?");ie&&xr(k,P.id,ie)}else if(P.needsSpeakers)Ut(k),Bt([]);else if(P.needsNotes){const ie=prompt("Add a note:");ie&&xr(k,P.id,null,null,ie)}else xr(k,P.id)},className:"w-full px-2 py-1.5 text-sm text-left rounded hover:bg-red-50 flex items-center gap-2",children:[n.jsx("span",{children:P.icon})," ",P.label]},P.id))]});if(g==="character")return n.jsxs("div",{className:"mt-2 p-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:[n.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide mb-1 px-1",children:"Character"}),G.slice(0,8).map(P=>n.jsxs("button",{onClick:W=>{W.stopPropagation(),Kn(k,P.id)},className:"w-full px-2 py-1.5 text-sm text-left rounded hover:bg-pink-50 text-pink-800 flex items-center gap-2",children:[n.jsx("span",{children:""})," ",P.name]},P.id)),n.jsx("input",{type:"text",placeholder:"+ New character...",value:It,onChange:P=>ce(P.target.value),onKeyDown:P=>{P.key==="Enter"&&It.trim()&&wa(k,It)},className:"w-full mt-1 px-2 py-1.5 text-sm border rounded",onClick:P=>P.stopPropagation()})]});if(g==="chapter")return n.jsxs("div",{className:"mt-2 p-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:[n.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide mb-1 px-1",children:"Chapter type"}),ne.map(P=>n.jsxs("button",{onClick:W=>{W.stopPropagation(),qs(P.id,k)},className:"w-full px-2 py-1.5 text-sm text-left rounded hover:bg-indigo-50 flex items-center gap-2",children:[n.jsx("span",{children:P.icon})," ",n.jsx("span",{style:{color:P.color},children:P.name})]},P.id))]});if(g==="speaker"){const P=ue==null?void 0:ue[k];return P?n.jsxs("div",{className:"mt-2 p-2 bg-white rounded-lg border border-gray-200 shadow-sm max-h-64 overflow-y-auto",children:[n.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide mb-1 px-1",children:"Assign to speaker"}),$.map(W=>n.jsxs("button",{onClick:ie=>{ie.stopPropagation(),Xn(P.speaker,W.name)},className:"w-full px-2 py-1.5 text-sm text-left rounded hover:bg-yellow-50 text-yellow-800 flex items-center gap-2",children:[n.jsx("span",{children:""})," ",W.short_name||W.name]},W.name)),B.length>0&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide mb-1 mt-2 px-1 border-t border-gray-100 pt-2",children:"Assign to sound bite"}),B.map(W=>n.jsxs("button",{onClick:ie=>{ie.stopPropagation(),Js(P.speaker,W)},className:"w-full px-2 py-1.5 text-sm text-left rounded hover:bg-teal-50 text-teal-800 flex items-center gap-2",children:[n.jsx("span",{children:""})," ",W.name]},W.id))]}),S[P.speaker]&&n.jsx(n.Fragment,{children:n.jsx("div",{className:"border-t border-gray-100 mt-2 pt-2",children:n.jsxs("button",{onClick:W=>{W.stopPropagation(),ja(P.speaker)},className:"w-full px-2 py-1.5 text-sm text-left rounded hover:bg-red-50 text-red-600 flex items-center gap-2",children:[n.jsx("span",{children:""})," Unassign"]})})})]}):null}return g==="audiodrop"?n.jsxs("div",{className:"mt-2 p-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:[n.jsx("div",{className:"text-[10px] text-gray-400 uppercase tracking-wide mb-1 px-1",children:"Sound bite"}),B.map(P=>n.jsxs("button",{onClick:W=>{W.stopPropagation(),Yn(k,P.id)},className:"w-full px-2 py-1.5 text-sm text-left rounded hover:bg-teal-50 text-teal-800 flex items-center gap-2",children:[n.jsx("span",{children:""})," ",P.name]},P.id)),n.jsx("input",{type:"text",placeholder:"+ New sound bite...",value:pr,onChange:P=>Gt(P.target.value),onKeyDown:P=>{P.key==="Enter"&&pr.trim()&&ba(k,pr)},className:"w-full mt-1 px-2 py-1.5 text-sm border rounded",onClick:P=>P.stopPropagation()})]}):null},X=g=>{var Qe,Ze;const k=re[g],P=Zs(g),W=ka(g),ie=el(g),Pe=w[g];return!k&&!P&&!W&&ie.length===0&&!Pe?null:n.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-2 pt-2 border-t border-gray-200/50",children:[k&&n.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium cursor-pointer ${k.flag_type==="wrong_speaker"?"bg-red-100 text-red-700":k.flag_type==="character_voice"?"bg-pink-100 text-pink-700":"bg-yellow-100 text-yellow-700"}`,onClick:me=>{me.stopPropagation(),Ys(g)},title:"Click to remove flag",children:[((Qe=si.find(me=>me.id===k.flag_type))==null?void 0:Qe.icon)||""," ",k.flag_type==="multiple_speakers"&&k.speaker_ids?(()=>{try{return`Multiple: ${JSON.parse(k.speaker_ids).map(R=>S[R]||R).join(", ")}`}catch{return"Multiple Speakers"}})():((Ze=si.find(me=>me.id===k.flag_type))==null?void 0:Ze.label)||"Flag"]}),P&&n.jsxs("span",{className:"px-2 py-1 rounded text-xs font-medium bg-pink-100 text-pink-700 cursor-pointer",onClick:me=>{me.stopPropagation(),cn(P.id)},title:"Click to remove",children:[" ",P.character_name]}),W&&n.jsxs("span",{className:"px-2 py-1 rounded text-xs font-medium cursor-pointer",style:{backgroundColor:W.chapter_type_color+"33",color:W.chapter_type_color},onClick:me=>{me.stopPropagation(),Xs(W.id)},title:"Click to remove",children:[W.chapter_type_icon," ",W.chapter_type_name]}),ie.map(me=>{const Qt=_a(me);return n.jsxs("span",{className:"px-2 py-1 rounded text-xs font-medium bg-teal-100 text-teal-700 cursor-pointer",onClick:R=>{R.stopPropagation(),Gs(me.id)},title:`${me.audio_drop_name}${Qt.total>1?` (${Qt.position} of ${Qt.total})`:""}  click to remove`,children:[" ",me.audio_drop_name]},me.id)}),Pe&&n.jsx("span",{className:"px-2 py-1 bg-yellow-400 text-yellow-900 rounded text-xs font-medium cursor-pointer",onClick:me=>{me.stopPropagation(),qn(g)},children:" Sample"})]})},we=g=>E!==g?null:n.jsx("div",{className:"overflow-hidden transition-all duration-200 ease-in-out",style:{maxHeight:E===g?"500px":"0"},children:n.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200",children:[n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{onClick:k=>{k.stopPropagation(),Ee(Ne==="flag"?null:"flag")},className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${Ne==="flag"?"bg-red-100 text-red-700 ring-1 ring-red-300":"bg-white text-gray-600 hover:bg-red-50 border border-gray-200"}`,children:" Flag"}),n.jsx("button",{onClick:k=>{k.stopPropagation(),Ee(Ne==="character"?null:"character")},className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${Ne==="character"?"bg-pink-100 text-pink-700 ring-1 ring-pink-300":"bg-white text-gray-600 hover:bg-pink-50 border border-gray-200"}`,children:" Character"}),n.jsx("button",{onClick:k=>{k.stopPropagation(),Ee(Ne==="chapter"?null:"chapter")},className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${Ne==="chapter"?"bg-indigo-100 text-indigo-700 ring-1 ring-indigo-300":"bg-white text-gray-600 hover:bg-indigo-50 border border-gray-200"}`,children:" Chapter"}),n.jsx("button",{onClick:k=>{k.stopPropagation(),Ee(Ne==="audiodrop"?null:"audiodrop")},className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${Ne==="audiodrop"?"bg-teal-100 text-teal-700 ring-1 ring-teal-300":"bg-white text-gray-600 hover:bg-teal-50 border border-gray-200"}`,children:" Drop"}),n.jsx("button",{onClick:k=>{k.stopPropagation(),qn(g)},className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${w[g]?"bg-yellow-300 text-yellow-900 ring-1 ring-yellow-400":"bg-white text-gray-600 hover:bg-yellow-50 border border-gray-200"}`,children:w[g]?" Unmark":" Sample"}),n.jsx("button",{onClick:k=>{k.stopPropagation(),Ee(Ne==="speaker"?null:"speaker")},className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${Ne==="speaker"?"bg-purple-100 text-purple-700 ring-1 ring-purple-300":"bg-white text-gray-600 hover:bg-purple-50 border border-gray-200"}`,children:" Speaker"})]}),Ne&&K(Ne,g)]})});if(!e)return n.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:n.jsxs("div",{className:"text-center text-gray-500",children:[n.jsx("div",{className:"text-4xl mb-4",children:""}),n.jsx("p",{children:"Select an episode to view transcript"})]})});if(u)return n.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:n.jsxs("div",{className:"text-center",children:[n.jsx("style",{children:`
            @keyframes scoop-drop {
              0% { transform: translateY(-30px); opacity: 0; }
              40% { transform: translateY(0px); opacity: 1; }
              60% { transform: translateY(0px); opacity: 1; }
              100% { transform: translateY(30px) scale(0.3); opacity: 0; }
            }
            .scoop-anim { animation: scoop-drop 2s ease-in-out infinite; }
          `}),n.jsxs("div",{className:"relative mx-auto mb-6 w-20 h-28",children:[n.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-14 h-14 rounded-full bg-pink-400 shadow-md scoop-anim",style:{animationDelay:"0s",zIndex:3}}),n.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-14 h-14 rounded-full bg-amber-100 shadow-md scoop-anim",style:{animationDelay:"0.6s",zIndex:2}}),n.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-14 h-14 rounded-full bg-amber-800 shadow-md scoop-anim",style:{animationDelay:"1.2s",zIndex:1}}),n.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2",style:{width:0,height:0,borderLeft:"24px solid transparent",borderRight:"24px solid transparent",borderTop:"40px solid #d97706",zIndex:4}}),n.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2",style:{width:0,height:0,borderLeft:"20px solid transparent",borderRight:"20px solid transparent",borderTop:"34px solid #b45309",zIndex:4,opacity:.3}})]}),n.jsx("div",{className:"text-gray-500 text-sm font-medium",children:"Scooping up transcript..."}),n.jsx("div",{className:"text-gray-400 text-xs mt-1 max-w-xs mx-auto truncate",children:e==null?void 0:e.title})]})});if(C){const g=(e==null?void 0:e.transcription_status)==="failed",k=e==null?void 0:e.transcription_error,P=k==null?void 0:k.toLowerCase().includes("download");return n.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:n.jsxs("div",{className:"text-center max-w-md px-6",children:[n.jsx("div",{className:"text-red-500 text-4xl mb-4",children:""}),n.jsx("div",{className:"text-red-600 font-medium mb-2",children:"Failed to load transcript"}),g&&k&&n.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-left",children:[n.jsx("div",{className:"text-xs font-medium text-red-700 mb-1",children:P?"Download Error":"Processing Error"}),n.jsx("div",{className:"text-xs text-red-600",children:k}),P&&n.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"The audio file could not be downloaded from the RSS feed. This usually means the CDN link has expired or the file is temporarily unavailable."})]}),!g&&n.jsx("div",{className:"text-sm text-gray-500 mb-4",children:C}),n.jsxs("div",{className:"flex gap-2 justify-center",children:[P&&n.jsx("button",{onClick:async()=>{try{await je.downloadEpisode(e.id),r==null||r("Download started - episode will be queued when complete","success")}catch(W){r==null||r(`Download failed: ${W.message}`,"error")}},className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm font-medium",children:"Retry Download"}),n.jsx("button",{onClick:mr,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm",children:"Try Again"})]})]})})}return D?n.jsxs("div",{className:"h-full flex flex-col bg-white",children:[n.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 flex-shrink-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[t&&n.jsx("button",{onClick:t,className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors flex-shrink-0",title:"Close transcript and return to library",children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),n.jsx("h2",{className:"text-lg font-bold text-gray-800 truncate",children:e.title})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-1 text-sm text-gray-500 flex-wrap",children:[(D==null?void 0:D.language)&&n.jsx("span",{className:"px-2 py-0.5 bg-gray-100 rounded text-xs",children:D.language}),(D==null?void 0:D.has_diarization)&&n.jsxs("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs",children:[" ",D.num_speakers," speakers"]}),Q.length>0&&n.jsxs("span",{className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded text-xs",children:[" ",Q.length," chapters"]}),Re.length>0&&n.jsxs("span",{className:"px-2 py-0.5 bg-pink-100 text-pink-700 rounded text-xs",children:[" ",Re.length," characters"]}),ye.length>0&&n.jsxs("span",{className:"px-2 py-0.5 bg-teal-100 text-teal-700 rounded text-xs",children:[" ",ye.length," drops"]}),Object.keys(re).length>0&&n.jsxs("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 rounded text-xs",children:[" ",Object.keys(re).length," flags"]}),e.is_transcribed&&n.jsx("button",{disabled:oe||ke,onClick:async()=>{Oe(!0);try{await je.reprocessDiarization(e.id),L(!0),r==null||r("Episode locked for re-diarization  editing disabled until complete","success")}catch(g){r==null||r(`Failed to queue re-diarization: ${g.message}`,"error"),Oe(!1)}},className:`px-2.5 py-1 rounded text-xs font-medium transition-all duration-300 ${oe?"bg-green-100 text-green-700 border border-green-300 cursor-not-allowed":"bg-orange-100 text-orange-700 border border-orange-300 hover:bg-orange-200 cursor-pointer"}`,title:"Reprocess diarization using speaker correction flags as hints",children:oe?" Queued for Diarization":" Reprocess Diarization"}),j&&n.jsx("span",{className:"px-2 py-0.5 bg-yellow-100 text-yellow-700 rounded text-xs",children:"Unsaved changes"})]})]}),ke&&n.jsxs("div",{className:"px-4 py-3 bg-orange-50 border-b border-orange-200 flex items-center gap-3 flex-shrink-0",children:[n.jsx("div",{className:"w-4 h-4 border-2 border-orange-500 border-t-transparent rounded-full animate-spin flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm font-semibold text-orange-800",children:"Re-diarization in progress"}),n.jsx("span",{className:"text-xs text-orange-600 ml-2",children:"Editing locked until the worker finishes this episode"})]})]}),Bn&&n.jsxs("div",{className:"px-4 py-3 bg-gradient-to-r from-purple-50 to-indigo-50 border-b border-purple-100 flex-shrink-0",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:Ks,className:"w-10 h-10 flex items-center justify-center bg-purple-500 hover:bg-purple-600 text-white rounded-full shadow-md transition-colors",children:Wn?n.jsxs("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:[n.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),n.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}):n.jsx("svg",{className:"w-4 h-4 ml-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M8 5v14l11-7z"})})}),n.jsx("button",{onClick:()=>Hn(-10),className:"p-2 text-gray-600 hover:text-purple-600",children:"-10s"}),n.jsx("button",{onClick:()=>Hn(10),className:"p-2 text-gray-600 hover:text-purple-600",children:"+10s"}),n.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[n.jsx("span",{className:"text-xs text-gray-500 w-12 text-right font-mono",children:li(Jt)}),n.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full cursor-pointer",onClick:g=>{const k=g.currentTarget.getBoundingClientRect(),P=(g.clientX-k.left)/k.width;Zt(P*Mr)},children:n.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${Mr?Jt/Mr*100:0}%`}})}),n.jsx("span",{className:"text-xs text-gray-500 w-12 font-mono",children:li(Mr)})]}),n.jsxs("button",{onClick:()=>{const g=[1,1.25,1.5,1.75,2],k=g[(g.indexOf(fe)+1)%g.length];Hs(k),Ge.current&&(Ge.current.playbackRate=k)},className:"px-2 py-1 text-xs font-medium text-gray-600 bg-white rounded border",children:[fe,"x"]}),n.jsx("button",{onClick:()=>ln(!Or),className:`p-2 rounded ${Or?"text-purple-600 bg-purple-100":"text-gray-400"}`,title:"Auto-scroll",children:""})]}),n.jsx("audio",{ref:Ge,src:Bn,preload:"metadata"})]}),n.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 flex gap-3 flex-shrink-0 items-center",children:[n.jsx("input",{type:"text",placeholder:"Search in transcript...",className:"flex-1 px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",value:z,onChange:g=>N(g.target.value)}),on&&n.jsxs("div",{className:"flex rounded-lg border border-gray-200 overflow-hidden",children:[n.jsx("button",{onClick:()=>ee("speakers"),className:`px-3 py-2 text-sm ${O==="speakers"?"bg-purple-500 text-white":"bg-white text-gray-600"}`,children:"By Speaker"}),n.jsx("button",{onClick:()=>ee("plain"),className:`px-3 py-2 text-sm ${O==="plain"?"bg-purple-500 text-white":"bg-white text-gray-600"}`,children:"Plain"})]}),j&&n.jsx("button",{onClick:y,disabled:Z||ke,className:"px-4 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg text-sm font-medium disabled:opacity-50",children:Z?"Saving...":"Save"})]}),n.jsx("div",{className:"px-4 py-1.5 border-b border-gray-100 bg-gray-50/50 flex-shrink-0",children:n.jsxs("span",{className:"text-[10px] text-gray-400",children:[n.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 rounded text-[10px]",children:"J"}),"/",n.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 rounded text-[10px]",children:"K"})," navigate",n.jsx("span",{className:"mx-2",children:""}),n.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 rounded text-[10px]",children:"Space"})," play/pause",n.jsx("span",{className:"mx-2",children:""}),n.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 rounded text-[10px]",children:"F"})," flag",n.jsx("span",{className:"mx-2",children:""}),n.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 rounded text-[10px]",children:"C"})," character",n.jsx("span",{className:"mx-2",children:""}),n.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 rounded text-[10px]",children:"H"})," chapter",n.jsx("span",{className:"mx-2",children:""}),n.jsx("kbd",{className:"px-1 py-0.5 bg-gray-200 rounded text-[10px]",children:"Esc"})," close"]})}),n.jsx("div",{ref:ya,className:"flex-1 overflow-y-auto p-4",children:on&&O==="speakers"&&tl?n.jsx("div",{className:"space-y-3",children:tl.map((g,k)=>{var Ze;const P=du(g.speaker),W=S[g.speaker]||g.speaker,ie=Ur===k,Pe=E===k,Qe=re[k];return n.jsxs("div",{ref:me=>Je.current[k]=me,className:`group rounded-lg overflow-hidden transition-all cursor-pointer border ${Pe?"ring-2 ring-purple-500 shadow-md border-purple-300":ie?`ring-2 ${P.ring} shadow-md border-transparent`:Qe?"ring-1 ring-red-300 border-red-200":"border-gray-200 hover:border-gray-300 hover:shadow-sm"}`,onClick:()=>{h==null||h(Pe?null:k),Ee(null)},children:[n.jsxs("div",{className:"flex",children:[n.jsx("div",{className:"w-[100px] flex-shrink-0 flex items-start justify-center pt-4 pb-3",style:{backgroundColor:P.hex},onClick:me=>{me.stopPropagation(),h==null||h(k),Ee("speaker")},children:n.jsxs("span",{className:"text-xs font-semibold text-gray-700 text-center leading-tight cursor-pointer hover:underline",children:[un(g.speaker)&&n.jsx("span",{title:"Sound bite",children:" "}),W]})}),n.jsxs("div",{className:"flex-1 min-w-0 px-5 py-4",style:{borderLeft:`4px solid ${P.borderHex}`},children:[n.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[n.jsx("button",{onClick:me=>{me.stopPropagation(),Qn(g)},className:"text-xs text-gray-400 hover:text-purple-600 font-mono",children:va(g)}),ie&&n.jsx("span",{className:"text-xs text-purple-600 font-medium animate-pulse",children:" NOW"})]}),n.jsx("p",{className:`text-gray-700 leading-relaxed ${ie?"font-medium":""}`,children:(Ze=g.text)==null?void 0:Ze.trim()}),X(k)]})]}),we(k)]},k)})}):n.jsx("div",{className:"whitespace-pre-wrap",children:D.full_text||"No transcript text available"})})]}):n.jsx("div",{className:"h-full flex items-center justify-center bg-gray-50",children:n.jsxs("div",{className:"text-center text-gray-500",children:[n.jsx("div",{className:"text-4xl mb-4",children:""}),n.jsx("p",{children:"No transcript available for this episode"})]})})}const Ef=[{id:"wrong_speaker",label:"Wrong Speaker",icon:"",color:"red"},{id:"character_voice",label:"Character Voice",icon:"",color:"pink"},{id:"multiple_speakers",label:"Multiple Speakers",icon:"",color:"orange"},{id:"audio_issue",label:"Audio Issue",icon:"",color:"gray"},{id:"other",label:"Other",icon:"",color:"yellow"}];function mn({open:e,onClick:t,icon:r,label:s,count:l,color:a="gray"}){return n.jsxs("button",{onClick:t,className:`w-full px-3 py-2 flex items-center justify-between text-xs font-medium transition-colors border-b border-gray-100 ${e?`bg-${a}-50 text-${a}-700`:"bg-white text-gray-600 hover:bg-gray-50"}`,children:[n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("span",{className:"text-sm",children:r}),n.jsx("span",{children:s}),l>0&&n.jsx("span",{className:`ml-1 px-1.5 py-0.5 rounded-full text-[10px] ${e?`bg-${a}-100 text-${a}-700`:"bg-gray-100 text-gray-500"}`,children:l})]}),n.jsx("svg",{className:`w-3.5 h-3.5 transition-transform ${e?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}const Tf={SPEAKER_00:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-300"},SPEAKER_01:{bg:"bg-green-100",text:"text-green-700",border:"border-green-300"},SPEAKER_02:{bg:"bg-orange-100",text:"text-orange-700",border:"border-orange-300"},SPEAKER_03:{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-300"},SPEAKER_04:{bg:"bg-pink-100",text:"text-pink-700",border:"border-pink-300"},SPEAKER_05:{bg:"bg-cyan-100",text:"text-cyan-700",border:"border-cyan-300"}},Pf=e=>Tf[e]||{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-300"};function $f({episode:e,flaggedSegments:t={},characterAppearances:r=[],episodeChapters:s=[],characters:l=[],chapterTypes:a=[],voiceLibrary:i=[],markedSamples:o={},speakers:c=[],speakerNames:m={},audioDropInstances:v=[],audioDrops:b=[],segments:x=null,selectedSegmentIdx:E=null,onCreateFlag:h,onDeleteFlag:_,onAddCharacter:D,onRemoveCharacter:d,onCreateChapter:u,onDeleteChapter:f,onToggleVoiceSample:C,onSeekToSegment:A,onAssignSpeakerName:z,onAssignAudioDrop:N,onSeekToSpeaker:O,onRemoveAudioDrop:ee}){const[S,Y]=p.useState({flags:!0}),[$,V]=p.useState(!1),[G,le]=p.useState(null),[ne,J]=p.useState(null),[j,H]=p.useState(!1),[Z,de]=p.useState(!1),oe=Q=>{Y(ae=>({...ae,[Q]:!ae[Q]}))};p.useEffect(()=>{if(!(e!=null&&e.id)){J(null);return}let Q=!1;return(async()=>{H(!0);try{const w=await ti.getWikiEpisodeMeta(e.id);Q||J(w)}catch(w){console.error("Failed to load wiki meta:",w)}finally{Q||H(!1)}})(),()=>{Q=!0}},[e==null?void 0:e.id]);const Oe=async()=>{if(!(!(e!=null&&e.category_number)&&!(e!=null&&e.episode_number))){de(!0);try{const Q=e.category_number||e.episode_number,ae=await ti.syncWikiEpisode(Q),w=await ti.getWikiEpisodeMeta(e.id);J(w)}catch(Q){console.error("Wiki sync failed:",Q)}finally{de(!1)}}},ke=Object.keys(t).length,L=r.length,re=s.length,xe=Object.keys(o).length,Re=c.length,he=v.length;return $?n.jsxs("div",{className:"w-12 h-full bg-gray-50 border-l border-gray-200 flex flex-col items-center py-4",children:[n.jsx("button",{onClick:()=>V(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors",title:"Expand panel",children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})}),n.jsxs("div",{className:"mt-4 space-y-3",children:[ke>0&&n.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center text-xs font-medium",children:ke}),L>0&&n.jsx("div",{className:"w-8 h-8 rounded-full bg-pink-100 text-pink-600 flex items-center justify-center text-xs font-medium",children:L}),re>0&&n.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-xs font-medium",children:re}),he>0&&n.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-100 text-teal-600 flex items-center justify-center text-xs font-medium",children:he})]})]}):n.jsxs("div",{className:"w-72 h-full bg-gray-50 border-l border-gray-200 flex flex-col",children:[n.jsxs("div",{className:"p-3 border-b border-gray-200 flex items-center justify-between flex-shrink-0",children:[n.jsx("h3",{className:"font-semibold text-gray-700 text-sm",children:"Properties"}),n.jsx("button",{onClick:()=>V(!0),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors",title:"Collapse panel",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})})]}),Re>0&&n.jsxs("div",{className:"p-3 border-b border-gray-200 bg-purple-50 flex-shrink-0",children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsxs("span",{className:"text-xs font-medium text-purple-800 flex items-center gap-1",children:[" ",Re," speakers"]})}),n.jsx("div",{className:"flex flex-wrap gap-1",children:c.map(Q=>{const ae=Pf(Q),w=m[Q],I=G===Q;return n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>O==null?void 0:O(Q),className:`px-2 py-1 rounded text-xs font-medium flex items-center gap-1 ${ae.bg} ${ae.text} ${ae.border} border hover:shadow-sm transition-all`,title:`Click to hear ${Q}`,children:[w&&b.some(B=>B.name===w)&&n.jsx("span",{title:"Sound bite",children:" "}),w||Q,n.jsx("span",{className:"opacity-50 text-[10px]",children:""})]}),!w&&i.length>0&&n.jsx("button",{onClick:B=>{B.stopPropagation(),le(I?null:Q)},className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white rounded-full text-[10px] font-bold hover:bg-red-600",title:"Assign name",children:"!"}),I&&n.jsxs("div",{className:"absolute left-0 top-full z-20 mt-1 p-2 bg-white rounded-lg shadow-xl border border-gray-200 min-w-32 max-h-48 overflow-y-auto",children:[n.jsx("div",{className:"text-[10px] text-gray-500 mb-1",children:"Speaker:"}),i.map(B=>n.jsxs("button",{onClick:se=>{se.stopPropagation(),z==null||z(Q,B.name),le(null)},className:"block w-full px-2 py-1 text-xs text-left hover:bg-yellow-50 text-yellow-800 rounded",children:[" ",B.short_name||B.name]},B.name)),b.length>0&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-[10px] text-gray-500 mb-1 mt-2 border-t border-gray-100 pt-1",children:"Sound Bite:"}),b.map(B=>n.jsxs("button",{onClick:se=>{se.stopPropagation(),N?N(Q,B):z==null||z(Q,B.name),le(null)},className:"block w-full px-2 py-1 text-xs text-left hover:bg-teal-50 text-teal-800 rounded",children:[" ",B.name]},B.id))]}),n.jsx("button",{onClick:()=>le(null),className:"block w-full px-2 py-1 text-xs text-gray-400 hover:text-gray-600 mt-1 border-t",children:"Cancel"})]})]},Q)})})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n.jsx(mn,{open:S.flags,onClick:()=>oe("flags"),icon:"",label:"Flags",count:ke,color:"red"}),S.flags&&n.jsx("div",{className:"p-3 space-y-2 border-b border-gray-100",children:ke===0?n.jsxs("p",{className:"text-xs text-gray-500 text-center py-2",children:["No flagged segments.",n.jsx("br",{}),"Use the ... menu on segments to flag issues."]}):Object.entries(t).map(([Q,ae])=>{const w=Ef.find(I=>I.id===ae.flag_type);return n.jsxs("div",{className:`p-2 rounded-lg border cursor-pointer hover:shadow-sm transition-shadow ${ae.flag_type==="wrong_speaker"?"bg-red-50 border-red-200":ae.flag_type==="character_voice"?"bg-pink-50 border-pink-200":ae.flag_type==="multiple_speakers"?"bg-orange-50 border-orange-200":ae.flag_type==="audio_issue"?"bg-gray-50 border-gray-200":"bg-yellow-50 border-yellow-200"}`,onClick:()=>A==null?void 0:A(parseInt(Q)),children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{children:(w==null?void 0:w.icon)||""}),n.jsx("span",{className:"text-xs font-medium",children:(w==null?void 0:w.label)||"Flag"})]}),n.jsx("button",{onClick:I=>{I.stopPropagation(),_==null||_(parseInt(Q))},className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:n.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"text-[10px] text-gray-500 mt-1",children:["Segment #",Q,ae.corrected_speaker&&n.jsxs("span",{className:"ml-2",children:[" ",ae.corrected_speaker]})]}),ae.notes&&n.jsxs("div",{className:"text-xs text-gray-600 mt-1 italic",children:['"',ae.notes,'"']})]},ae.id)})}),n.jsx(mn,{open:S.characters,onClick:()=>oe("characters"),icon:"",label:"Characters",count:L,color:"pink"}),S.characters&&n.jsx("div",{className:"p-3 space-y-2 border-b border-gray-100",children:L===0?n.jsxs("p",{className:"text-xs text-gray-500 text-center py-2",children:["No character appearances marked.",n.jsx("br",{}),"Use the ... menu on segments to mark characters."]}):r.map(Q=>n.jsxs("div",{className:"p-2 rounded-lg bg-pink-50 border border-pink-200 cursor-pointer hover:shadow-sm transition-shadow",onClick:()=>A==null?void 0:A(Q.segment_idx),children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{children:""}),n.jsx("span",{className:"text-xs font-medium text-pink-800",children:Q.character_name})]}),n.jsx("button",{onClick:ae=>{ae.stopPropagation(),d==null||d(Q.id)},className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:n.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"text-[10px] text-gray-500 mt-1",children:["Segment #",Q.segment_idx]})]},Q.id))}),n.jsx(mn,{open:S.chapters,onClick:()=>oe("chapters"),icon:"",label:"Chapters",count:re,color:"indigo"}),S.chapters&&n.jsx("div",{className:"p-3 space-y-2 border-b border-gray-100",children:re===0?n.jsxs("p",{className:"text-xs text-gray-500 text-center py-2",children:["No chapters marked.",n.jsx("br",{}),"Use the ... menu on segments to mark chapters."]}):s.map(Q=>n.jsxs("div",{className:"p-2 rounded-lg border cursor-pointer hover:shadow-sm transition-shadow",style:{backgroundColor:Q.chapter_type_color+"20",borderColor:Q.chapter_type_color+"60"},onClick:()=>A==null?void 0:A(Q.start_segment_idx),children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{children:Q.chapter_type_icon}),n.jsx("span",{className:"text-xs font-medium",style:{color:Q.chapter_type_color},children:Q.chapter_type_name})]}),n.jsx("button",{onClick:ae=>{ae.stopPropagation(),f==null||f(Q.id)},className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:n.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Q.title&&n.jsx("div",{className:"text-xs text-gray-700 mt-1",children:Q.title}),n.jsxs("div",{className:"text-[10px] text-gray-500 mt-1",children:["Segments #",Q.start_segment_idx," - #",Q.end_segment_idx]})]},Q.id))}),n.jsx(mn,{open:S.drops,onClick:()=>oe("drops"),icon:"",label:"Sound Bites",count:he,color:"teal"}),S.drops&&n.jsx("div",{className:"p-3 space-y-2 border-b border-gray-100",children:he===0?n.jsxs("p",{className:"text-xs text-gray-500 text-center py-2",children:["No sound bites tagged.",n.jsx("br",{}),"Select a segment and use the Sound Bite action."]}):v.map(Q=>{const ae=v.filter(B=>B.audio_drop_id===Q.audio_drop_id),w=ae.findIndex(B=>B.id===Q.id)+1,I=ae.length;return n.jsxs("div",{className:"p-2 rounded-lg bg-teal-50 border border-teal-200 cursor-pointer hover:shadow-sm transition-shadow",onClick:()=>A==null?void 0:A(Q.segment_idx),children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{children:""}),n.jsxs("span",{className:"text-xs font-medium text-teal-800",children:[Q.audio_drop_name,I>1&&n.jsxs("span",{className:"text-[10px] text-teal-500 ml-1",children:["(",w,"/",I,")"]})]})]}),n.jsx("button",{onClick:B=>{B.stopPropagation(),ee==null||ee(Q.id)},className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:n.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"text-[10px] text-gray-500 mt-1",children:["Segment #",Q.segment_idx]})]},Q.id)})}),n.jsx(mn,{open:S.samples,onClick:()=>oe("samples"),icon:"",label:"Audio IDs",count:xe,color:"yellow"}),S.samples&&n.jsx("div",{className:"p-3 space-y-2 border-b border-gray-100",children:xe===0?n.jsxs("p",{className:"text-xs text-gray-500 text-center py-2",children:["No audio IDs marked.",n.jsx("br",{}),"Use the ... menu on segments to mark good audio IDs."]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-xs text-gray-600 mb-2",children:[xe," audio ID",xe!==1?"s":""," marked"]}),Object.keys(o).map(Q=>n.jsx("div",{className:"p-2 rounded-lg bg-yellow-50 border border-yellow-200 cursor-pointer hover:shadow-sm transition-shadow",onClick:()=>A==null?void 0:A(parseInt(Q)),children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{children:""}),n.jsxs("span",{className:"text-xs font-medium text-yellow-800",children:["Segment #",Q]})]}),n.jsx("button",{onClick:ae=>{ae.stopPropagation(),C==null||C(parseInt(Q))},className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:n.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Q))]})}),n.jsx(mn,{open:S.wiki,onClick:()=>oe("wiki"),icon:"",label:"Wiki",count:ne?1:0,color:"blue"}),S.wiki&&n.jsx("div",{className:"p-3 space-y-3 border-b border-gray-100",children:j?n.jsxs("div",{className:"text-center py-4",children:[n.jsx("div",{className:"w-6 h-6 border-2 border-gray-200 border-t-blue-500 rounded-full animate-spin mx-auto mb-2"}),n.jsx("div",{className:"text-xs text-gray-500",children:"Loading wiki data..."})]}):ne?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("a",{href:ne.wiki_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline truncate",children:"View on Fandom Wiki"}),n.jsx("button",{onClick:Oe,disabled:Z,className:"text-[10px] px-1.5 py-0.5 rounded bg-gray-100 hover:bg-gray-200 text-gray-500 disabled:opacity-50",children:Z?"Syncing...":"Re-sync"})]}),ne.air_date&&n.jsxs("div",{className:"text-xs",children:[n.jsx("span",{className:"text-gray-400",children:"Air date:"})," ",n.jsx("span",{className:"text-gray-700",children:ne.air_date})]}),ne.summary&&n.jsxs("div",{children:[n.jsx("div",{className:"text-[10px] font-medium text-gray-400 uppercase tracking-wider mb-1",children:"Summary"}),n.jsx("div",{className:"text-xs text-gray-600 leading-relaxed whitespace-pre-line max-h-32 overflow-y-auto bg-white rounded border p-2",children:ne.summary})]}),ne.bits_json&&(()=>{try{const Q=JSON.parse(ne.bits_json);return Q.length===0?null:n.jsxs("div",{children:[n.jsx("div",{className:"text-[10px] font-medium text-gray-400 uppercase tracking-wider mb-1",children:"Bits & Characters"}),n.jsx("div",{className:"space-y-1",children:Q.map((ae,w)=>n.jsxs("div",{className:"text-xs text-gray-600 py-0.5 flex gap-1.5",children:[n.jsx("span",{className:"text-amber-500 flex-shrink-0",children:"-"}),n.jsx("span",{children:ae.replace(/^- /,"")})]},w))})]})}catch{return null}})(),ne.scoopmail_json&&(()=>{try{const Q=JSON.parse(ne.scoopmail_json);return Q.length===0?null:n.jsxs("div",{children:[n.jsx("div",{className:"text-[10px] font-medium text-gray-400 uppercase tracking-wider mb-1",children:"Scoopmail"}),n.jsx("div",{className:"space-y-1",children:Q.map((ae,w)=>n.jsxs("div",{className:"text-xs text-gray-600 py-0.5 flex gap-1.5",children:[n.jsx("span",{className:"text-blue-400 flex-shrink-0",children:"-"}),n.jsx("span",{children:ae.replace(/^- /,"")})]},w))})]})}catch{return null}})(),ne.jock_vs_nerd&&n.jsxs("div",{children:[n.jsx("div",{className:"text-[10px] font-medium text-gray-400 uppercase tracking-wider mb-1",children:"Jock vs Nerd"}),n.jsx("div",{className:"text-xs text-gray-600 bg-white rounded border p-2",children:ne.jock_vs_nerd})]}),n.jsxs("div",{className:"text-[9px] text-gray-300 pt-2 border-t border-gray-100",children:["Data from ",n.jsx("a",{href:"https://heyscoops.fandom.com",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"HeyScoops Wiki"})," (CC BY-SA 3.0)"]})]}):n.jsxs("div",{className:"text-center py-2",children:[n.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"No wiki data for this episode."}),((e==null?void 0:e.category_number)||(e==null?void 0:e.episode_number))&&n.jsx("button",{onClick:Oe,disabled:Z,className:"px-3 py-1.5 text-xs rounded bg-blue-100 hover:bg-blue-200 text-blue-700 disabled:opacity-50",children:Z?"Syncing from wiki...":"Fetch from Fandom Wiki"}),!(e!=null&&e.category_number)&&!(e!=null&&e.episode_number)&&n.jsx("p",{className:"text-[10px] text-gray-400 mt-2",children:"Episode has no number  can't match to wiki."})]})})]}),e&&n.jsx("div",{className:"p-3 border-t border-gray-200 flex-shrink-0",children:n.jsx("div",{className:"text-xs text-gray-500 truncate",title:e.title,children:e.title})})]})}function zf({onNotification:e}){var w;const[t,r]=p.useState(null),[s,l]=p.useState(!1),[a,i]=p.useState(!1),[o,c]=p.useState(!1),[m,v]=p.useState({}),[b,x]=p.useState([]),[E,h]=p.useState([]),[_,D]=p.useState({}),[d,u]=p.useState([]),[f,C]=p.useState([]),[A,z]=p.useState([]),[N,O]=p.useState([]),[ee,S]=p.useState({}),[Y,$]=p.useState([]),[V,G]=p.useState([]),[le,ne]=p.useState(null),[J,j]=p.useState(null),H=p.useCallback(()=>{r(null),l(!1),i(!1),c(!1),v({}),x([]),h([]),D({}),O([]),S({}),$([]),G([]),ne(null),j(null)},[]),Z=p.useCallback(I=>{r(I),l(!0),i(!1),c(!0),v({}),x([]),h([]),D({}),O([]),S({}),$([]),G([]),ne(null),j(null)},[]),de=p.useCallback(I=>{i(I),c(!1)},[]),oe=t&&(a||o),Oe=p.useCallback(I=>{var B;(B=window.__transcriptEditorDeleteFlag)==null||B.call(window,I)},[]),ke=p.useCallback(I=>{var B;(B=window.__transcriptEditorRemoveCharacter)==null||B.call(window,I)},[]),L=p.useCallback(I=>{var B;(B=window.__transcriptEditorDeleteChapter)==null||B.call(window,I)},[]),re=p.useCallback(I=>{var B;(B=window.__transcriptEditorToggleVoiceSample)==null||B.call(window,I)},[]),xe=p.useCallback(I=>{typeof window<"u"&&window.__transcriptEditorSeekToSegment&&window.__transcriptEditorSeekToSegment(I)},[]),Re=p.useCallback(I=>{var B;(B=window.__transcriptEditorRemoveAudioDrop)==null||B.call(window,I)},[]),he=p.useCallback(I=>{typeof window<"u"&&window.__transcriptEditorSeekToSpeaker&&window.__transcriptEditorSeekToSpeaker(I)},[]),Q=p.useCallback((I,B)=>{S(se=>({...se,[I]:B})),typeof window<"u"&&window.__transcriptEditorAssignSpeakerName&&window.__transcriptEditorAssignSpeakerName(I,B)},[]),ae=p.useCallback((I,B)=>{S(se=>({...se,[I]:B.name})),typeof window<"u"&&window.__transcriptEditorAssignAudioDrop&&window.__transcriptEditorAssignAudioDrop(I,B)},[]);return n.jsxs("div",{className:"h-[calc(100vh-220px)] flex bg-gray-100 rounded-xl overflow-hidden shadow-lg border border-gray-200",children:[s&&oe?n.jsxs("div",{className:"w-12 h-full bg-white border-r border-gray-200 flex flex-col items-center py-4 flex-shrink-0",children:[n.jsx("button",{onClick:()=>l(!1),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors",title:"Browse episodes",children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})})}),t&&n.jsx("div",{className:"mt-4 flex-1 flex items-start justify-center overflow-hidden",children:n.jsx("span",{className:"text-[10px] text-gray-500 font-medium whitespace-nowrap",style:{writingMode:"vertical-rl",textOrientation:"mixed"},title:t.title,children:((w=t.title)==null?void 0:w.length)>40?t.title.slice(0,40)+"":t.title})})]}):n.jsxs("div",{className:`${oe?"w-80":"flex-1"} flex-shrink-0 flex flex-col h-full`,children:[oe&&n.jsx("div",{className:"px-3 py-2 border-b border-gray-200 bg-white flex items-center justify-end flex-shrink-0",children:n.jsx("button",{onClick:()=>l(!0),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors",title:"Collapse sidebar",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})})}),n.jsx("div",{className:"flex-1 min-h-0",children:n.jsx(Sf,{selectedEpisodeId:t==null?void 0:t.id,onSelectEpisode:Z,onNotification:e})})]}),t&&n.jsx("div",{className:`${oe?"flex-1":"w-0 overflow-hidden"} min-w-0`,children:n.jsx(Cf,{episode:t,onClose:H,onNotification:e,onFlaggedSegmentsChange:v,onCharacterAppearancesChange:x,onChaptersChange:h,onMarkedSamplesChange:D,onSpeakersChange:O,onSpeakerNamesChange:S,onVoiceLibraryChange:z,onAudioDropInstancesChange:$,onAudioDropsChange:G,onSegmentsChange:ne,selectedSegmentIdx:J,onSelectedSegmentChange:j,onTranscriptLoaded:de})}),oe&&n.jsx($f,{episode:t,flaggedSegments:m,characterAppearances:b,episodeChapters:E,characters:d,chapterTypes:f,voiceLibrary:A,markedSamples:_,speakers:N,speakerNames:ee,audioDropInstances:Y,audioDrops:V,segments:le,selectedSegmentIdx:J,onDeleteFlag:Oe,onRemoveCharacter:ke,onDeleteChapter:L,onToggleVoiceSample:re,onSeekToSegment:xe,onAssignSpeakerName:Q,onAssignAudioDrop:ae,onSeekToSpeaker:he,onRemoveAudioDrop:Re})]})}function Af({message:e,type:t="success",onClose:r}){p.useEffect(()=>{const l=setTimeout(r,5e3);return()=>clearTimeout(l)},[r]);const s={success:"bg-sage-50 border-sage-500 text-sage-800",error:"bg-red-50 border-red-500 text-red-800"};return n.jsx("div",{className:"fixed top-20 right-4 z-50 animate-slide-in",children:n.jsx("div",{className:`${s[t]} border-l-4 rounded-lg shadow-lg p-4 max-w-md`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("p",{className:"font-medium",children:e}),n.jsx("button",{className:"ml-4 text-gray-400 hover:text-gray-600",onClick:r,children:""})]})})})}function Lf({message:e,detail:t}){return n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsxs("div",{className:"text-center",children:[n.jsx("style",{children:`
          @keyframes scoop-drop {
            0% { transform: translateY(-30px); opacity: 0; }
            40% { transform: translateY(0px); opacity: 1; }
            60% { transform: translateY(0px); opacity: 1; }
            100% { transform: translateY(30px) scale(0.3); opacity: 0; }
          }
          .scoop-anim { animation: scoop-drop 2s ease-in-out infinite; }
        `}),n.jsxs("div",{className:"relative mx-auto mb-6 w-20 h-28",children:[n.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-14 h-14 rounded-full bg-pink-400 shadow-md scoop-anim",style:{animationDelay:"0s",zIndex:3}}),n.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-14 h-14 rounded-full bg-amber-100 shadow-md scoop-anim",style:{animationDelay:"0.6s",zIndex:2}}),n.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-14 h-14 rounded-full bg-amber-800 shadow-md scoop-anim",style:{animationDelay:"1.2s",zIndex:1}}),n.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2",style:{width:0,height:0,borderLeft:"24px solid transparent",borderRight:"24px solid transparent",borderTop:"40px solid #d97706",zIndex:4}}),n.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2",style:{width:0,height:0,borderLeft:"20px solid transparent",borderRight:"20px solid transparent",borderTop:"34px solid #b45309",zIndex:4,opacity:.3}})]}),n.jsx("div",{className:"text-gray-500 text-sm font-medium",children:e||"Loading..."}),t&&n.jsx("div",{className:"text-gray-400 text-xs mt-1",children:t})]})})}function Df(){return n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 py-2",children:[n.jsx("style",{children:`
        @keyframes mini-scoop {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-4px); }
        }
      `}),n.jsxs("div",{className:"flex gap-0.5",children:[n.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-pink-400",style:{animation:"mini-scoop 1s ease-in-out infinite",animationDelay:"0s"}}),n.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-amber-100",style:{animation:"mini-scoop 1s ease-in-out infinite",animationDelay:"0.2s"}}),n.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-amber-800",style:{animation:"mini-scoop 1s ease-in-out infinite",animationDelay:"0.4s"}})]}),"Loading samples..."]})}function Rf({rating:e,onChange:t}){return n.jsx("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(r=>n.jsx("button",{onClick:s=>{s.stopPropagation(),t(e===r?0:r)},className:`text-sm transition-colors ${r<=e?"text-yellow-400":"text-gray-300 hover:text-yellow-300"}`,title:`Rate ${r} star${r!==1?"s":""}`,children:""},r))})}function pu(e){if(e==null)return"";const t=Math.floor(e/60),r=Math.floor(e%60);return`${t}:${r.toString().padStart(2,"0")}`}function Ff({onNotification:e,onViewEpisode:t}){const r=Ws(),[s,l]=p.useState([]),[a,i]=p.useState([]),[o,c]=p.useState([]),[m,v]=p.useState([]),[b,x]=p.useState(!0),[E,h]=p.useState(!1),[_,D]=p.useState(null),[d,u]=p.useState({name:"",shortName:"",isHost:!1}),[f,C]=p.useState(null),[A,z]=p.useState({}),[N,O]=p.useState({}),[ee,S]=p.useState(null),Y=p.useRef(null);p.useEffect(()=>{$()},[]);const $=async()=>{x(!0);try{const[w,I,B,se]=await Promise.all([lt.getSpeakers(),lt.getSpeakerStats(),lt.getVoiceLibrary(),te.getAudioDrops()]);l(w),i(I),c(B),v(se)}catch(w){console.error("Error loading data:",w),e==null||e("Error loading audio ID data","error")}finally{x(!1)}},V=async w=>{if(!A[w]){O(I=>({...I,[w]:!0}));try{const I=await lt.getVoiceSamples(w);z(B=>({...B,[w]:I}))}catch(I){console.error("Error loading samples for",w,I),z(B=>({...B,[w]:[]}))}finally{O(I=>({...I,[w]:!1}))}}},G=w=>{f===w?C(null):(C(w),V(w))},le=async()=>{if(!d.name.trim()){e==null||e("Name is required","error");return}try{await lt.createSpeaker(d.name.trim(),d.shortName.trim()||null,d.isHost),e==null||e(`Speaker "${d.name}" added`,"success"),u({name:"",shortName:"",isHost:!1}),h(!1),$()}catch(w){e==null||e(`Error adding speaker: ${w.message}`,"error")}},ne=async()=>{if(!(!_||!d.name.trim()))try{await lt.updateSpeaker(_.id,d.name.trim(),d.shortName.trim()||null,d.isHost),e==null||e(`Speaker "${d.name}" updated`,"success"),D(null),u({name:"",shortName:"",isHost:!1}),$()}catch(w){e==null||e(`Error updating speaker: ${w.message}`,"error")}},J=async w=>{if(await r(`Delete speaker "${w.name}"?`))try{await lt.deleteSpeaker(w.id),e==null||e(`Speaker "${w.name}" deleted`,"success"),f===w.name&&C(null),$()}catch(I){e==null||e(`Error deleting speaker: ${I.message}`,"error")}},j=(w,I)=>{I.stopPropagation(),D(w),u({name:w.name,shortName:w.short_name||"",isHost:w.is_host}),h(!1)},H=()=>{D(null),u({name:"",shortName:"",isHost:!1})},Z=w=>{if(Y.current){if(ee===w){Y.current.pause(),Y.current.currentTime=0,S(null);return}Y.current.src=ha(w),Y.current.play(),S(w)}},de=async w=>{var I;if(!((I=w.drop)!=null&&I.id)){e==null||e("Cannot delete: sound bite has no ID","error");return}if(await r(`Delete sound bite "${w.cleanName}"? This will remove it from all episodes.`))try{await te.deleteAudioDrop(w.drop.id),e==null||e(`Sound bite "${w.cleanName}" deleted`,"success"),$()}catch(B){e==null||e(`Error deleting sound bite: ${B.message}`,"error")}},oe=async(w,I)=>{if(await r(`Delete sample "${I.file_name}"?`))try{await lt.deleteVoiceSample(w,I.file_path,I.id),e==null||e(`Deleted "${I.file_name}"`,"success"),z(se=>({...se,[w]:void 0})),V(w);const B=await lt.getVoiceLibrary();c(B)}catch(B){e==null||e(`Error deleting sample: ${B.message}`,"error")}},Oe=async(w,I,B)=>{if(I.id)try{await lt.updateVoiceSampleRating(I.id,B),z(se=>({...se,[w]:(se[w]||[]).map(ye=>ye.id===I.id?{...ye,rating:B}:ye)}))}catch(se){e==null||e(`Error updating rating: ${se.message}`,"error")}},ke=w=>{if(!w)return"0m";const I=Math.floor(w/3600),B=Math.floor(w%3600/60);return I>0?`${I}h ${B}m`:`${B}m`},L=w=>w<1024?`${w} B`:w<1024*1024?`${(w/1024).toFixed(1)} KB`:`${(w/(1024*1024)).toFixed(1)} MB`,re=w=>w.name.startsWith("")?!0:m.some(I=>I.name===w.name||` ${I.name}`===w.name),xe=s.map(w=>{const I=a.find(se=>se.id===w.id)||{},B=o.find(se=>se.name===w.name);return{...w,...I,voiceInfo:B,type:"speaker"}});xe.sort((w,I)=>w.is_host!==I.is_host?w.is_host?-1:1:(I.episode_count||0)-(w.episode_count||0));const he=o.filter(w=>re(w)).map(w=>{const I=w.name.replace(/^\s*/,""),B=m.find(se=>se.name===I);return{name:w.name,cleanName:I,voiceInfo:w,sample_count:w.sample_count,short_name:w.short_name,sample_file:w.sample_file,drop:B,type:"sound_bite"}});m.forEach(w=>{o.some(B=>B.name===w.name||B.name===` ${w.name}`)||he.push({name:w.name,cleanName:w.name,voiceInfo:null,sample_count:0,short_name:w.name.charAt(0),sample_file:null,drop:w,type:"sound_bite"})});const Q=o.filter(w=>re(w)?!1:!s.some(I=>I.name===w.name)),ae=(w,I)=>{var It;const B=f===w.name,se=I==="speaker",ye=w.voiceInfo,$t=ye&&ye.sample_count>0,zt=(ye==null?void 0:ye.sample_count)||0,st=(ye==null?void 0:ye.file_count)||0,Ne=(ye==null?void 0:ye.sample_file)||w.sample_file,Ee=(w.short_name||w.cleanName||w.name||"?").charAt(0).toUpperCase();return n.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[n.jsxs("div",{onClick:()=>G(w.name),className:`flex items-center justify-between px-4 py-3 cursor-pointer transition-colors ${B?"bg-gray-100":"hover:bg-gray-50"}`,children:[n.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[n.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0 ${w.is_host?"bg-purple-500":se?"bg-gray-400":"bg-amber-500"}`,children:se?Ee:""}),n.jsxs("div",{className:"min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("span",{className:"font-medium text-gray-800 truncate",children:w.cleanName||w.name}),w.is_host&&n.jsx("span",{className:"px-1.5 py-0.5 bg-purple-200 text-purple-700 rounded text-xs font-medium flex-shrink-0",children:"Host"}),$t&&n.jsxs("span",{className:"px-1.5 py-0.5 bg-green-100 text-green-700 rounded text-xs font-medium flex-shrink-0",title:`Voice print trained from ${zt} clip${zt!==1?"s":""}${Ne?` (last: ${Ne})`:""}`,children:["Voice ID (",zt,"x)"]}),st>0&&n.jsxs("span",{className:"px-1.5 py-0.5 bg-yellow-100 text-yellow-700 rounded text-xs font-medium flex-shrink-0",children:[st," clip",st!==1?"s":""]})]}),se&&n.jsxs("div",{className:"flex items-center gap-3 mt-0.5 text-xs text-gray-500",children:[n.jsxs("span",{children:[w.episode_count||0," episodes"]}),n.jsx("span",{children:ke(w.total_speaking_time)}),n.jsxs("span",{children:[w.total_segments||0," segments"]})]}),!se&&((It=w.drop)==null?void 0:It.description)&&n.jsx("div",{className:"text-xs text-gray-500 mt-0.5 truncate",children:w.drop.description})]})]}),n.jsx("div",{className:"flex items-center gap-1 flex-shrink-0",children:n.jsx("span",{className:`text-gray-400 text-xs transition-transform ${B?"rotate-90":""}`,children:""})})]}),B&&n.jsxs("div",{className:"border-t border-gray-200 bg-gray-50 px-4 py-3",children:[se&&n.jsxs("div",{className:"flex gap-2 mb-3",children:[n.jsx("button",{onClick:ce=>j(w,ce),className:"px-3 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded border border-purple-200 transition-colors",children:"Edit Speaker"}),!w.is_host&&n.jsx("button",{onClick:ce=>{ce.stopPropagation(),J(w)},className:"px-3 py-1 text-xs text-red-600 hover:bg-red-100 rounded border border-red-200 transition-colors",children:"Delete Speaker"})]}),!se&&w.drop&&n.jsx("div",{className:"flex gap-2 mb-3",children:n.jsx("button",{onClick:ce=>{ce.stopPropagation(),de(w)},className:"px-3 py-1 text-xs text-red-600 hover:bg-red-100 rounded border border-red-200 transition-colors",children:"Delete Sound Bite"})}),$t&&n.jsxs("div",{className:"mb-3 p-2 bg-green-50 rounded border border-green-200 text-xs text-green-700",children:["Voice print trained from ",zt," clip",zt!==1?"s":"",Ne&&n.jsxs("span",{className:"text-green-600 ml-1",children:[" Last source: ",Ne]})]}),n.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Audio Samples"}),N[w.name]?n.jsx(Df,{}):(A[w.name]||[]).length===0?n.jsx("div",{className:"text-sm text-gray-400 py-2",children:$t&&st===0?"Voice print trained from older clips (no audio files saved). Add new clips from the Transcript viewer to see them here.":"No saved audio clips. Mark clips in the Transcript viewer to add samples."}):n.jsx("div",{className:"space-y-1",children:(A[w.name]||[]).map(ce=>n.jsx("div",{className:"py-1.5 px-2 rounded hover:bg-white transition-colors",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsx("button",{onClick:()=>Z(ce.file_path),className:`w-7 h-7 rounded-full flex items-center justify-center text-xs flex-shrink-0 transition-colors ${ee===ce.file_path?"bg-yellow-400 text-yellow-900":"bg-gray-200 hover:bg-gray-300 text-gray-600"}`,children:ee===ce.file_path?"":""}),n.jsxs("div",{className:"min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm text-gray-700 truncate",children:ce.file_name}),ce.id!=null&&n.jsx(Rf,{rating:ce.rating||0,onChange:pr=>Oe(w.name,ce,pr)})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[n.jsx("span",{children:L(ce.file_size)}),ce.episode_title&&n.jsx("span",{className:"text-gray-500",children:ce.episode_title.length>30?ce.episode_title.substring(0,30)+"...":ce.episode_title}),ce.start_time!=null&&ce.end_time!=null&&n.jsxs("span",{className:"text-purple-500 font-medium",children:[pu(ce.start_time),"-",pu(ce.end_time)]}),!ce.episode_title&&ce.created&&n.jsx("span",{children:ce.created})]}),ce.transcript_text&&n.jsxs("div",{className:"text-xs text-gray-400 italic truncate mt-0.5",children:['"',ce.transcript_text.length>60?ce.transcript_text.substring(0,60)+"...":ce.transcript_text,'"']})]})]}),n.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[ce.episode_id&&t&&n.jsxs("button",{onClick:()=>t(ce.episode_id,ce.start_time),className:"flex items-center gap-1 px-2 py-1 text-xs text-purple-600 hover:bg-purple-50 rounded border border-purple-200 transition-colors flex-shrink-0",children:[n.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Jump to source"]}),n.jsx("button",{onClick:()=>oe(w.name,ce),className:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Delete sample",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},ce.file_path))})]})]},w.name)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 px-6 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:"Audio Identification"}),n.jsx("p",{className:"text-purple-100 text-sm mt-0.5",children:"Manage speakers and sound bites used for automatic audio identification"})]}),n.jsx("button",{onClick:()=>{h(!0),D(null),u({name:"",shortName:"",isHost:!1})},className:"px-3 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg font-medium text-sm transition-colors",children:"+ Add Speaker"})]})}),(E||_)&&n.jsxs("div",{className:"p-4 bg-purple-50 border-b border-purple-200",children:[n.jsx("h3",{className:"font-medium text-purple-800 mb-3",children:_?"Edit Speaker":"Add New Speaker"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),n.jsx("input",{type:"text",value:d.name,onChange:w=>u({...d,name:w.target.value}),placeholder:"e.g., Matt Donnelly",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Short Name"}),n.jsx("input",{type:"text",value:d.shortName,onChange:w=>u({...d,shortName:w.target.value}),placeholder:"e.g., Matt",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),n.jsx("div",{className:"flex items-end gap-4",children:n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:d.isHost,onChange:w=>u({...d,isHost:w.target.checked}),className:"w-4 h-4 text-purple-500 border-gray-300 rounded focus:ring-purple-400"}),n.jsx("span",{className:"text-sm text-gray-700",children:"Is Host"})]})})]}),n.jsxs("div",{className:"flex gap-2 mt-4",children:[n.jsx("button",{onClick:_?ne:le,className:"px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg font-medium text-sm transition-colors",children:_?"Update":"Add Speaker"}),n.jsx("button",{onClick:()=>{h(!1),H()},className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-medium text-sm transition-colors",children:"Cancel"})]})]})]}),b?n.jsx(Lf,{message:"Scooping up audio ID data..."}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden",children:[n.jsx("div",{className:"px-5 py-3 border-b border-gray-200 bg-gray-50",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-base",children:""}),n.jsx("h3",{className:"font-semibold text-gray-800",children:"Speakers"}),n.jsxs("span",{className:"text-sm text-gray-500",children:["(",xe.length,")"]})]})}),n.jsxs("div",{className:"p-4 space-y-2",children:[xe.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No speakers yet. Add hosts and guests to track them across episodes."}):xe.map(w=>ae(w,"speaker")),Q.length>0&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wide mt-4 mb-1 px-1",children:"Voice Library Only (not added as speaker)"}),Q.map(w=>n.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 rounded-lg border border-dashed border-yellow-300 bg-yellow-50",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-9 h-9 rounded-full flex items-center justify-center text-white font-bold text-sm bg-yellow-500",children:w.short_name.charAt(0).toUpperCase()}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-medium text-gray-800",children:w.name}),n.jsxs("span",{className:"px-1.5 py-0.5 bg-green-100 text-green-700 rounded text-xs font-medium",children:["Voice ID (",w.sample_count,"x)"]})]}),w.sample_file&&n.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:["Source: ",w.sample_file]})]})]}),n.jsx("button",{onClick:()=>{u({name:w.name,shortName:w.short_name,isHost:!1}),h(!0)},className:"px-3 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded border border-purple-200 transition-colors",children:"Add as Speaker"})]},w.name))]})]})]}),n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden",children:[n.jsx("div",{className:"px-5 py-3 border-b border-gray-200 bg-gray-50",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-base",children:""}),n.jsx("h3",{className:"font-semibold text-gray-800",children:"Sound Bites"}),n.jsxs("span",{className:"text-sm text-gray-500",children:["(",he.length,")"]})]})}),n.jsx("div",{className:"p-4 space-y-2",children:he.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No sound bites yet. Sound bites are non-speech audio identified during diarization (intros, music, drops)."}):he.map(w=>ae(w,"sound_bite"))})]})]}),n.jsx("audio",{ref:Y,onEnded:()=>S(null),onError:()=>S(null)})]})}function Mf({onNotification:e}){const t=Ws(),[r,s]=p.useState([]),[l,a]=p.useState([]),[i,o]=p.useState(!0),[c,m]=p.useState(!1),[v,b]=p.useState(null),[x,E]=p.useState({name:"",shortName:"",description:"",catchphrase:""}),[h,_]=p.useState({characterName:"",episodeId:"",timestamp:""}),[D,d]=p.useState(!1);p.useEffect(()=>{u(),f()},[]);const u=async()=>{o(!0);try{const S=await te.getCharacters();s(S)}catch(S){console.error("Error loading characters:",S),e==null||e("Error loading characters","error")}finally{o(!1)}},f=async()=>{try{const S=await je.getEpisodes({feed_source:"patreon",limit:500,sort_by:"episode_number",sort_desc:!0});a(S.episodes||[])}catch(S){console.error("Error loading episodes:",S)}},C=async()=>{if(!h.characterName.trim()){e==null||e("Enter a character name","warning");return}if(!h.episodeId){e==null||e("Select an episode","warning");return}d(!0);try{let S=r.find(V=>V.name.toLowerCase()===h.characterName.trim().toLowerCase());if(!S){const V=await te.createCharacter(h.characterName.trim(),null,null,null),G=await te.getCharacters();s(G),S=G.find(le=>le.id===V),e==null||e(`Created new character: ${h.characterName}`,"info")}let Y=null;if(h.timestamp.trim()){const V=h.timestamp.split(":").map(Number);V.length===2?Y=V[0]*60+V[1]:V.length===3&&(Y=V[0]*3600+V[1]*60+V[2])}await te.addCharacterAppearance(S.id,parseInt(h.episodeId),Y,null,null);const $=l.find(V=>V.id===parseInt(h.episodeId));e==null||e(`Added ${S.name} to episode ${($==null?void 0:$.episode_number)||h.episodeId}`,"success"),_({characterName:"",episodeId:"",timestamp:""}),u()}catch(S){e==null||e(`Error: ${S.message}`,"error")}finally{d(!1)}},A=async()=>{if(!x.name.trim()){e==null||e("Name is required","error");return}try{await te.createCharacter(x.name.trim(),x.shortName.trim()||null,x.description.trim()||null,x.catchphrase.trim()||null),e==null||e(`Character "${x.name}" added`,"success"),E({name:"",shortName:"",description:"",catchphrase:""}),m(!1),u()}catch(S){e==null||e(`Error adding character: ${S.message}`,"error")}},z=async()=>{if(!(!v||!x.name.trim()))try{await te.updateCharacter(v.id,x.name.trim(),x.shortName.trim()||null,x.description.trim()||null,x.catchphrase.trim()||null),e==null||e(`Character "${x.name}" updated`,"success"),b(null),E({name:"",shortName:"",description:"",catchphrase:""}),u()}catch(S){e==null||e(`Error updating character: ${S.message}`,"error")}},N=async S=>{if(await t(`Delete character "${S.name}"?`))try{await te.deleteCharacter(S.id),e==null||e(`Character "${S.name}" deleted`,"success"),u()}catch(Y){e==null||e(`Error deleting character: ${Y.message}`,"error")}},O=S=>{b(S),E({name:S.name,shortName:S.short_name||"",description:S.description||"",catchphrase:S.catchphrase||""}),m(!1)},ee=()=>{b(null),E({name:"",shortName:"",description:"",catchphrase:""})};return n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-pink-500 to-pink-600 px-6 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:"ICS Characters"}),n.jsx("p",{className:"text-pink-100 text-sm",children:"Recurring characters from bits & commercials"})]}),n.jsx("button",{onClick:()=>{m(!0),b(null),E({name:"",shortName:"",description:"",catchphrase:""})},className:"px-3 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg font-medium text-sm transition-colors",children:"+ Add Character"})]})}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:[n.jsxs("h3",{className:"font-medium text-green-800 mb-3 flex items-center gap-2",children:[n.jsx("span",{className:"text-lg",children:""})," Quick Add Character Appearance"]}),n.jsx("p",{className:"text-sm text-green-700 mb-3",children:"Know a character appears in an episode? Add it here. Creates the character if it's new."}),n.jsxs("div",{className:"flex flex-wrap gap-3 items-end",children:[n.jsxs("div",{className:"flex-1 min-w-[200px]",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Character Name"}),n.jsx("input",{type:"text",value:h.characterName,onChange:S=>_({...h,characterName:S.target.value}),placeholder:"e.g., Count Absorbo",list:"character-suggestions",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),n.jsx("datalist",{id:"character-suggestions",children:r.map(S=>n.jsx("option",{value:S.name},S.id))})]}),n.jsxs("div",{className:"flex-1 min-w-[200px]",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Episode"}),n.jsxs("select",{value:h.episodeId,onChange:S=>_({...h,episodeId:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[n.jsx("option",{value:"",children:"Select episode..."}),l.map(S=>n.jsxs("option",{value:S.id,children:[S.episode_number?`#${S.episode_number}`:""," ",S.title]},S.id))]})]}),n.jsxs("div",{className:"w-32",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Timestamp"}),n.jsx("input",{type:"text",value:h.timestamp,onChange:S=>_({...h,timestamp:S.target.value}),placeholder:"MM:SS",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),n.jsx("button",{onClick:C,disabled:D,className:"px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-green-300 text-white rounded-lg font-medium transition-colors",children:D?"Adding...":"Add"})]})]}),(c||v)&&n.jsxs("div",{className:"mb-6 p-4 bg-pink-50 rounded-lg border border-pink-200",children:[n.jsx("h3",{className:"font-medium text-pink-800 mb-3",children:v?"Edit Character":"Add New Character (with details)"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),n.jsx("input",{type:"text",value:x.name,onChange:S=>E({...x,name:S.target.value}),placeholder:"e.g., Sweet Bean",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Short Name"}),n.jsx("input",{type:"text",value:x.shortName,onChange:S=>E({...x,shortName:S.target.value}),placeholder:"e.g., Bean",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Catchphrase"}),n.jsx("input",{type:"text",value:x.catchphrase,onChange:S=>E({...x,catchphrase:S.target.value}),placeholder:"e.g., It's me, Sweet Bean!",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("input",{type:"text",value:x.description,onChange:S=>E({...x,description:S.target.value}),placeholder:"e.g., Matt's lovable character",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500"})]})]}),n.jsxs("div",{className:"flex gap-2 mt-4",children:[n.jsx("button",{onClick:v?z:A,className:"px-4 py-2 bg-pink-500 hover:bg-pink-600 text-white rounded-lg font-medium text-sm transition-colors",children:v?"Update":"Add Character"}),n.jsx("button",{onClick:()=>{m(!1),ee()},className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-medium text-sm transition-colors",children:"Cancel"})]})]}),i?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-10 h-10 border-4 border-pink-200 border-t-pink-500 rounded-full animate-spin mx-auto mb-4"}),n.jsx("div",{className:"text-gray-500",children:"Loading characters..."})]}):r.length===0?n.jsx("div",{className:"text-center py-12 text-gray-400",children:"No characters yet. Use Quick Add above to add characters!"}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(S=>n.jsxs("div",{className:"p-4 rounded-lg border bg-gradient-to-br from-pink-50 to-purple-50 border-pink-200 hover:shadow-md transition-shadow",children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-pink-500 text-white flex items-center justify-center font-bold text-lg",children:(S.short_name||S.name).charAt(0).toUpperCase()}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:S.name}),S.short_name&&n.jsxs("span",{className:"text-xs text-gray-500",children:["(",S.short_name,")"]})]})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>O(S),className:"p-1 text-pink-600 hover:bg-pink-100 rounded transition-colors",title:"Edit",children:n.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})}),n.jsx("button",{onClick:()=>N(S),className:"p-1 text-red-600 hover:bg-red-100 rounded transition-colors",title:"Delete",children:n.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]})]}),S.catchphrase&&n.jsxs("p",{className:"text-sm text-pink-600 italic mb-2",children:['"',S.catchphrase,'"']}),S.description&&n.jsx("p",{className:"text-sm text-gray-600 mb-2",children:S.description}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 mt-2",children:[n.jsxs("span",{className:"font-medium text-pink-600",children:[S.appearance_count||0," appearances"]}),S.first_episode_title&&n.jsxs("span",{className:"truncate",children:["First: ",S.first_episode_title]})]})]},S.id))})]})]})}function Of({onNotification:e}){const t=Ws(),[r,s]=p.useState([]),[l,a]=p.useState(!0),[i,o]=p.useState(!1),[c,m]=p.useState(null),[v,b]=p.useState({name:"",tagline:"",description:"",isReal:!1}),[x,E]=p.useState("all");p.useEffect(()=>{h()},[]);const h=async()=>{a(!0);try{const N=await te.getSponsors();s(N)}catch(N){console.error("Error loading sponsors:",N),e==null||e("Error loading sponsors","error")}finally{a(!1)}},_=async()=>{if(!v.name.trim()){e==null||e("Name is required","error");return}try{await te.createSponsor(v.name.trim(),v.tagline.trim()||null,v.description.trim()||null,v.isReal),e==null||e(`Sponsor "${v.name}" added`,"success"),b({name:"",tagline:"",description:"",isReal:!1}),o(!1),h()}catch(N){e==null||e(`Error adding sponsor: ${N.message}`,"error")}},D=async()=>{if(!(!c||!v.name.trim()))try{await te.updateSponsor(c.id,v.name.trim(),v.tagline.trim()||null,v.description.trim()||null,v.isReal),e==null||e(`Sponsor "${v.name}" updated`,"success"),m(null),b({name:"",tagline:"",description:"",isReal:!1}),h()}catch(N){e==null||e(`Error updating sponsor: ${N.message}`,"error")}},d=async N=>{if(await t(`Delete sponsor "${N.name}"?`))try{await te.deleteSponsor(N.id),e==null||e(`Sponsor "${N.name}" deleted`,"success"),h()}catch(O){e==null||e(`Error deleting sponsor: ${O.message}`,"error")}},u=N=>{m(N),b({name:N.name,tagline:N.tagline||"",description:N.description||"",isReal:N.is_real}),o(!1)},f=()=>{m(null),b({name:"",tagline:"",description:"",isReal:!1})},C=r.filter(N=>x==="fake"?!N.is_real:x==="real"?N.is_real:!0),A=r.filter(N=>!N.is_real).length,z=r.filter(N=>N.is_real).length;return n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 px-6 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:"Sponsors & Commercials"}),n.jsx("p",{className:"text-orange-100 text-sm",children:"Fake commercials and real sponsors"})]}),n.jsx("button",{onClick:()=>{o(!0),m(null),b({name:"",tagline:"",description:"",isReal:!1})},className:"px-3 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg font-medium text-sm transition-colors",children:"+ Add Sponsor"})]})}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex gap-2 mb-6",children:[n.jsxs("button",{onClick:()=>E("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${x==="all"?"bg-gray-800 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:["All (",r.length,")"]}),n.jsxs("button",{onClick:()=>E("fake"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${x==="fake"?"bg-orange-500 text-white":"bg-orange-100 text-orange-700 hover:bg-orange-200"}`,children:[" Fake Commercials (",A,")"]}),n.jsxs("button",{onClick:()=>E("real"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${x==="real"?"bg-green-500 text-white":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[" Real Sponsors (",z,")"]})]}),(i||c)&&n.jsxs("div",{className:"mb-6 p-4 bg-orange-50 rounded-lg border border-orange-200",children:[n.jsx("h3",{className:"font-medium text-orange-800 mb-3",children:c?"Edit Sponsor":"Add New Sponsor"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),n.jsx("input",{type:"text",value:v.name,onChange:N=>b({...v,name:N.target.value}),placeholder:"e.g., Totino's Pizza Rolls",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tagline"}),n.jsx("input",{type:"text",value:v.tagline,onChange:N=>b({...v,tagline:N.target.value}),placeholder:"e.g., Pizza in the morning, pizza in the evening...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("input",{type:"text",value:v.description,onChange:N=>b({...v,description:N.target.value}),placeholder:"e.g., Recurring fake sponsor for pizza-related bits",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),n.jsx("div",{className:"md:col-span-2",children:n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:v.isReal,onChange:N=>b({...v,isReal:N.target.checked}),className:"w-4 h-4 text-green-500 border-gray-300 rounded focus:ring-green-400"}),n.jsx("span",{className:"text-sm text-gray-700",children:"This is a real sponsor (not a fake commercial)"})]})})]}),n.jsxs("div",{className:"flex gap-2 mt-4",children:[n.jsx("button",{onClick:c?D:_,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg font-medium text-sm transition-colors",children:c?"Update":"Add Sponsor"}),n.jsx("button",{onClick:()=>{o(!1),f()},className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-medium text-sm transition-colors",children:"Cancel"})]})]}),l?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-10 h-10 border-4 border-orange-200 border-t-orange-500 rounded-full animate-spin mx-auto mb-4"}),n.jsx("div",{className:"text-gray-500",children:"Loading sponsors..."})]}):C.length===0?n.jsx("div",{className:"text-center py-12 text-gray-400",children:x==="all"?"No sponsors yet. Add fake commercials and real sponsors.":x==="fake"?"No fake commercials yet.":"No real sponsors yet."}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(N=>n.jsxs("div",{className:`p-4 rounded-lg border hover:shadow-md transition-shadow ${N.is_real?"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200":"bg-gradient-to-br from-orange-50 to-red-50 border-orange-200"}`,children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-lg ${N.is_real?"bg-green-500":"bg-orange-500"}`,children:N.is_real?"":""}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:N.name}),n.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${N.is_real?"bg-green-200 text-green-700":"bg-orange-200 text-orange-700"}`,children:N.is_real?"Real Sponsor":"Fake Commercial"})]})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>u(N),className:"p-1 text-orange-600 hover:bg-orange-100 rounded transition-colors",title:"Edit",children:n.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})}),n.jsx("button",{onClick:()=>d(N),className:"p-1 text-red-600 hover:bg-red-100 rounded transition-colors",title:"Delete",children:n.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]})]}),N.tagline&&n.jsxs("p",{className:`text-sm italic mb-2 ${N.is_real?"text-green-600":"text-orange-600"}`,children:['"',N.tagline,'"']}),N.description&&n.jsx("p",{className:"text-sm text-gray-600 mb-2",children:N.description}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 mt-2",children:[n.jsxs("span",{children:[N.mention_count||0," mentions"]}),N.first_episode_title&&n.jsxs("span",{className:"truncate",children:["First: ",N.first_episode_title]})]})]},N.id))})]})]})}function mu({rule:e,onSave:t,onDelete:r,onTest:s,isNew:l=!1}){var Y;const[a,i]=p.useState(l),[o,c]=p.useState(l),[m,v]=p.useState({...e}),[b,x]=p.useState(null),[E,h]=p.useState(!1),[_,D]=p.useState(!1),[d,u]=p.useState(""),f=e.category==="bonus"&&e.priority===99,C=(m.keywords||"").split(",").map($=>$.trim()).filter($=>$.length>0),A=$=>{v(V=>({...V,keywords:$.join(", ")}))},z=()=>{const $=d.trim();$&&!C.includes($)&&(A([...C,$]),u(""))},N=$=>{A(C.filter((V,G)=>G!==$))},O=async()=>{D(!0);try{await t(m),c(!1)}catch($){console.error("Save failed:",$)}finally{D(!1)}},ee=async()=>{h(!0),x(null);try{const $=await s(m.title_pattern,m.keywords||null);x($)}catch($){x({error:$.message||$.toString()})}finally{h(!1)}},S=()=>{v({...e}),c(!1),x(null),l&&(r==null||r(e.id))};return n.jsxs("div",{className:"border rounded-lg overflow-hidden",style:{borderColor:e.color||"#e5e7eb"},children:[n.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 cursor-pointer hover:bg-gray-50",onClick:()=>{o||i(!a)},children:[n.jsx("span",{className:"text-xl",children:m.icon||"?"}),n.jsx("div",{className:"flex-1 min-w-0",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-medium text-gray-800",children:m.display_name}),n.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium text-white",style:{backgroundColor:m.color||"#6b7280"},children:m.category}),n.jsxs("span",{className:"text-xs text-gray-400",children:["priority: ",m.priority]})]})}),!o&&n.jsx("button",{onClick:$=>{$.stopPropagation(),c(!0),i(!0)},className:"text-xs px-2 py-1 rounded bg-gray-100 hover:bg-gray-200 text-gray-600",children:"Edit"}),n.jsx("svg",{className:`w-4 h-4 text-gray-400 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&n.jsx("div",{className:"border-t px-4 py-3 space-y-3 bg-gray-50",children:o?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Display Name"}),n.jsx("input",{type:"text",value:m.display_name,onChange:$=>v(V=>({...V,display_name:$.target.value})),className:"w-full px-2 py-1.5 text-sm border rounded focus:ring-2 focus:ring-blue-400 focus:outline-none"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Category Slug"}),n.jsx("input",{type:"text",value:m.category,onChange:$=>v(V=>({...V,category:$.target.value})),disabled:!l,className:"w-full px-2 py-1.5 text-sm border rounded focus:ring-2 focus:ring-blue-400 focus:outline-none disabled:bg-gray-100 disabled:text-gray-400"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Icon (emoji)"}),n.jsx("input",{type:"text",value:m.icon||"",onChange:$=>v(V=>({...V,icon:$.target.value})),className:"w-full px-2 py-1.5 text-sm border rounded focus:ring-2 focus:ring-blue-400 focus:outline-none",placeholder:"e.g. emoji"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Color"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"color",value:m.color||"#6b7280",onChange:$=>v(V=>({...V,color:$.target.value})),className:"w-8 h-8 rounded border cursor-pointer"}),n.jsx("input",{type:"text",value:m.color||"",onChange:$=>v(V=>({...V,color:$.target.value})),className:"flex-1 px-2 py-1.5 text-sm border rounded focus:ring-2 focus:ring-blue-400 focus:outline-none",placeholder:"#hexcolor"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Priority"}),n.jsx("input",{type:"number",value:m.priority,onChange:$=>v(V=>({...V,priority:parseInt($.target.value)||0})),className:"w-full px-2 py-1.5 text-sm border rounded focus:ring-2 focus:ring-blue-400 focus:outline-none"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Title Pattern (regex)"}),n.jsx("input",{type:"text",value:m.title_pattern,onChange:$=>v(V=>({...V,title_pattern:$.target.value})),className:"w-full px-2 py-1.5 text-sm border rounded font-mono focus:ring-2 focus:ring-blue-400 focus:outline-none",placeholder:"(?i)regex pattern"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Number Pattern (regex, optional)"}),n.jsx("input",{type:"text",value:m.number_pattern||"",onChange:$=>v(V=>({...V,number_pattern:$.target.value||null})),className:"w-full px-2 py-1.5 text-sm border rounded font-mono focus:ring-2 focus:ring-blue-400 focus:outline-none",placeholder:"(?i)capture group (\\d+)"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Keywords (matched before regex, case-insensitive)"}),n.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:C.map(($,V)=>n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-white border",style:{borderColor:m.color||"#d1d5db",color:m.color||"#374151"},children:[$,n.jsx("button",{onClick:()=>N(V),className:"hover:text-red-500 font-bold",children:"x"})]},V))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:d,onChange:$=>u($.target.value),onKeyDown:$=>{$.key==="Enter"&&($.preventDefault(),z())},className:"flex-1 px-2 py-1.5 text-sm border rounded focus:ring-2 focus:ring-blue-400 focus:outline-none",placeholder:"Add keyword..."}),n.jsx("button",{onClick:z,disabled:!d.trim(),className:"px-3 py-1.5 text-sm rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-40",children:"Add"})]})]}),n.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[n.jsx("button",{onClick:ee,disabled:E||!m.title_pattern,className:"px-3 py-1.5 text-sm rounded bg-indigo-100 hover:bg-indigo-200 text-indigo-700 disabled:opacity-40",children:E?"Testing...":"Test Pattern"}),b&&!b.error&&n.jsxs("span",{className:"text-sm text-gray-600",children:[b.match_count," episode",b.match_count!==1?"s":""," matched"]}),(b==null?void 0:b.error)&&n.jsx("span",{className:"text-sm text-red-600",children:b.error})]}),((Y=b==null?void 0:b.samples)==null?void 0:Y.length)>0&&n.jsxs("div",{className:"max-h-40 overflow-y-auto bg-white rounded border p-2",children:[b.samples.map(($,V)=>n.jsxs("div",{className:"text-xs text-gray-600 py-0.5 flex items-center gap-1.5",children:[n.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${$.matched_by==="keyword"?"bg-amber-400":"bg-indigo-400"}`}),n.jsx("span",{className:"truncate",children:$.title})]},V)),b.match_count>20&&n.jsxs("div",{className:"text-xs text-gray-400 pt-1",children:["...and ",b.match_count-20," more"]})]}),n.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t",children:[n.jsx("button",{onClick:O,disabled:_,className:"px-4 py-1.5 text-sm rounded bg-blue-500 hover:bg-blue-600 text-white disabled:opacity-50",children:_?"Saving...":"Save"}),n.jsx("button",{onClick:S,className:"px-4 py-1.5 text-sm rounded bg-gray-200 hover:bg-gray-300 text-gray-700",children:"Cancel"}),!l&&!f&&n.jsx("button",{onClick:()=>r(e.id),className:"ml-auto px-3 py-1.5 text-sm rounded bg-red-100 hover:bg-red-200 text-red-600",children:"Delete"})]})]}):n.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Pattern:"})," ",n.jsx("code",{className:"text-xs bg-white px-1 py-0.5 rounded",children:e.title_pattern})]}),e.number_pattern&&n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-400",children:"Number:"})," ",n.jsx("code",{className:"text-xs bg-white px-1 py-0.5 rounded",children:e.number_pattern})]}),C.length>0&&n.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[n.jsx("span",{className:"text-gray-400",children:"Keywords:"}),C.map(($,V)=>n.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs bg-white border",children:$},V))]})]})})]})}function If({onNotification:e}){const[t,r]=p.useState([]),[s,l]=p.useState(!0),[a,i]=p.useState(!1),[o,c]=p.useState(!1),m=p.useCallback(async()=>{l(!0);try{const d=await je.getCategoryRules();r(d||[])}catch(d){console.error("Error loading category rules:",d),e==null||e("Error loading category rules","error")}finally{l(!1)}},[e]);p.useEffect(()=>{m()},[m]);const v=async d=>{if(!t.some(f=>f.id===d.id)){const f=await je.addCategoryRule(d);return e==null||e(`Rule "${d.display_name}" added`,"success"),c(!1),await m(),f}else await je.updateCategoryRule(d),e==null||e(`Rule "${d.display_name}" updated`,"success"),await m()},b=async d=>{if(d===-1){c(!1);return}try{await je.deleteCategoryRule(d),e==null||e("Rule deleted","success"),await m()}catch(u){e==null||e(u.message||"Error deleting rule","error")}},x=async(d,u)=>await je.testCategoryRule(d,u),E=async()=>{i(!0);try{const d=await je.recategorizeAllEpisodes(),u=d.counts||{},f=Object.entries(u).map(([C,A])=>`${C}: ${A}`).join(", ");e==null||e(`Recategorized ${d.total} episodes (${f})`,"success")}catch(d){e==null||e(`Recategorize failed: ${d.message||d}`,"error")}finally{i(!1)}},h=()=>{c(!0)},_=t.reduce((d,u)=>Math.max(d,u.priority),0),D={id:-1,category:"",display_name:"",title_pattern:"",number_pattern:null,priority:_>90?_-1:_+1,icon:"",color:"#6b7280",keywords:null};return n.jsxs("div",{className:"p-4 bg-amber-50 rounded-lg border border-amber-200",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-amber-800",children:"Category Rules"}),n.jsx("p",{className:"text-sm text-amber-600 mt-0.5",children:"Rules for auto-categorizing episodes. Checked in priority order (lowest first)."})]}),n.jsx("button",{onClick:E,disabled:a,className:"px-3 py-1.5 text-sm rounded bg-amber-200 hover:bg-amber-300 text-amber-800 disabled:opacity-50",children:a?"Re-categorizing...":"Re-categorize All"})]}),s?n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-8 h-8 border-3 border-amber-200 border-t-amber-500 rounded-full animate-spin mx-auto mb-2"}),n.jsx("div",{className:"text-sm text-amber-600",children:"Loading rules..."})]}):n.jsxs("div",{className:"space-y-2",children:[t.map(d=>n.jsx(mu,{rule:d,onSave:v,onDelete:b,onTest:x},d.id)),o&&n.jsx(mu,{rule:D,onSave:v,onDelete:b,onTest:x,isNew:!0},"new"),!o&&n.jsx("button",{onClick:h,className:"w-full py-2 text-sm rounded border-2 border-dashed border-amber-300 text-amber-600 hover:bg-amber-100 hover:border-amber-400",children:"+ Add Rule"})]})]})}function Uf({onNotification:e}){const[t,r]=p.useState({}),[s,l]=p.useState(!0),[a,i]=p.useState(!1),[o,c]=p.useState(!1),[m,v]=p.useState(!1);p.useEffect(()=>{E(),b()},[]);const b=async()=>{try{const f=await Zi.getPreventSleep();c(f)}catch(f){console.error("Error checking prevent sleep:",f)}},x=async()=>{v(!0);try{const f=!o,C=await Zi.setPreventSleep(f);c(C),e==null||e(C?"Prevent sleep enabled":"Prevent sleep disabled","success")}catch(f){console.error("Error toggling prevent sleep:",f),e==null||e(`Error: ${f.message||f}`,"error")}finally{v(!1)}},E=async()=>{l(!0);try{const f=await au.getAllSettings();r(f||{})}catch(f){console.error("Error loading settings:",f),e==null||e("Error loading settings","error")}finally{l(!1)}},h=async(f,C)=>{i(!0);try{await au.setSetting(f,C),r(A=>({...A,[f]:C})),e==null||e(`Setting "${f}" updated`,"success")}catch(A){console.error("Error updating setting:",A),e==null||e(`Error updating setting: ${A.message}`,"error")}finally{i(!1)}},_=()=>{const f=t.auto_transcribe==="true";h("auto_transcribe",(!f).toString())},D=()=>{const f=t.enable_diarization==="true";h("enable_diarization",(!f).toString())},d=t.auto_transcribe==="true",u=t.enable_diarization==="true";return n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-gray-600 to-gray-700 px-6 py-4",children:n.jsx("h2",{className:"text-xl font-bold text-white",children:"Settings"})}),n.jsx("div",{className:"p-6",children:s?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-10 h-10 border-4 border-gray-200 border-t-gray-500 rounded-full animate-spin mx-auto mb-4"}),n.jsx("div",{className:"text-gray-500",children:"Loading settings..."})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-blue-800",children:"Auto-Transcribe"}),n.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Automatically transcribe downloaded episodes when the queue is empty. Episodes are processed in order of publish date (newest first)."})]}),n.jsx("button",{onClick:_,disabled:a,className:`relative inline-flex h-7 w-14 items-center rounded-full transition-colors ${d?"bg-blue-500":"bg-gray-300"} ${a?"opacity-50":""}`,children:n.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow-md transition-transform ${d?"translate-x-8":"translate-x-1"}`})})]}),n.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[n.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${d?"bg-blue-200 text-blue-800":"bg-gray-200 text-gray-600"}`,children:d?"ON":"OFF"}),d&&n.jsx("span",{className:"text-xs text-blue-600",children:"Worker will automatically pick up next episode when idle"})]})]}),n.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-purple-800",children:"Speaker Diarization"}),n.jsx("p",{className:"text-sm text-purple-600 mt-1",children:"Identify who is speaking in each segment. Requires HuggingFace token and adds processing time."})]}),n.jsx("button",{onClick:D,disabled:a,className:`relative inline-flex h-7 w-14 items-center rounded-full transition-colors ${u?"bg-purple-500":"bg-gray-300"} ${a?"opacity-50":""}`,children:n.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow-md transition-transform ${u?"translate-x-8":"translate-x-1"}`})})]}),n.jsx("div",{className:"mt-3 flex items-center gap-2",children:n.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${u?"bg-purple-200 text-purple-800":"bg-gray-200 text-gray-600"}`,children:u?"ON":"OFF"})})]}),n.jsxs("div",{className:"p-4 bg-amber-50 rounded-lg border border-amber-200",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-amber-800",children:"Prevent Sleep"}),n.jsxs("p",{className:"text-sm text-amber-600 mt-1",children:["Keep your Mac awake while processing the queue. Uses macOS ",n.jsx("code",{className:"text-xs bg-amber-100 px-1 py-0.5 rounded",children:"caffeinate"})," to prevent sleep on AC power. Enable this for overnight batch runs."]})]}),n.jsx("button",{onClick:x,disabled:m,className:`relative inline-flex h-7 w-14 items-center rounded-full transition-colors ${o?"bg-amber-500":"bg-gray-300"} ${m?"opacity-50":""}`,children:n.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow-md transition-transform ${o?"translate-x-8":"translate-x-1"}`})})]}),n.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[n.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${o?"bg-amber-200 text-amber-800":"bg-gray-200 text-gray-600"}`,children:o?"AWAKE":"OFF"}),o&&n.jsx("span",{className:"text-xs text-amber-600",children:"Mac will stay awake until this is turned off or the app closes"})]}),n.jsx("p",{className:"text-xs text-amber-500 mt-2",children:"Without this, macOS will sleep after a period of inactivity, pausing all pipeline processing. Only works while plugged into AC power."})]}),n.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[n.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Transcription Model"}),n.jsxs("select",{value:t.transcription_model||"medium",onChange:f=>h("transcription_model",f.target.value),disabled:a,className:"w-full md:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"tiny",children:"Tiny (fastest, lowest quality)"}),n.jsx("option",{value:"base",children:"Base (fast, basic quality)"}),n.jsx("option",{value:"small",children:"Small (balanced)"}),n.jsx("option",{value:"medium",children:"Medium (recommended)"}),n.jsx("option",{value:"large-v3",children:"Large v3 (best quality, slowest)"})]}),n.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Larger models are more accurate but take longer to process."})]}),n.jsx(If,{onNotification:e}),n.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg border border-gray-200",children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-2 text-sm",children:"Current Settings"}),n.jsx("pre",{className:"text-xs text-gray-600 overflow-auto",children:JSON.stringify(t,null,2)})]})]})})]})}function Vf(e){const t=p.useRef(0);return p.useCallback(async(...s)=>{const l=++t.current;try{const a=await e(...s);return l!==t.current?null:a}catch(a){if(l!==t.current)return null;throw a}},[e])}const fu=async()=>{try{const{listen:e}=await Bs(async()=>{const{listen:t}=await import("./event-DDX7swQu.js");return{listen:t}},[]);return e}catch{return null}};function Bf(e){if(e==null)return"--:--";const t=Math.floor(e/3600),r=Math.floor(e%3600/60),s=Math.floor(e%60);return t>0?`${t}:${r.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${r}:${s.toString().padStart(2,"0")}`}function Wf({onNotification:e,onViewEpisode:t}){const[r,s]=p.useState(""),[l,a]=p.useState([]),[i,o]=p.useState(!1),[c,m]=p.useState(0),[v,b]=p.useState({indexed_segments:0,unindexed_episode_count:0}),[x,E]=p.useState(0),[h,_]=p.useState(!1),[D,d]=p.useState({current:0,total:0}),u=25,f=Vf(us.searchTranscripts);p.useEffect(()=>{C()},[]);const C=async()=>{try{const $=await us.getSearchStats();b($)}catch($){console.error("Error loading search stats:",$)}},A=p.useCallback(async($=!0)=>{if(!r.trim()){a([]),m(0);return}o(!0),$&&E(0);try{const V=$?0:x,G=await f(r.trim(),u,V*u);if(!G)return;a(G.results||[]),m(G.total||0)}catch(V){console.error("Search failed:",V),e==null||e(`Search failed: ${V.message}`,"error"),a([])}finally{o(!1)}},[r,x,u,e,f]),z=$=>{$.key==="Enter"&&A(!0)},N=$=>{E($),setTimeout(()=>A(!1),0)},O=async()=>{_(!0),d({current:0,total:0,episode_title:""});let $=null,V=null;try{const G=await fu();G&&($=await G("indexing_progress",ne=>{d({current:ne.payload.current,total:ne.payload.total,episode_title:ne.payload.episode_title})}),V=await G("indexing_complete",ne=>{const{indexed:J,failed:j,total:H}=ne.payload;e==null||e(`Indexing complete: ${J} indexed, ${j} failed`,J>0?"success":"warning")})),e==null||e("Starting transcript indexing...","info");const le=await us.indexAllTranscripts();le&&(e==null||e(`Indexed ${le.indexed} episodes (${le.failed} failed)`,le.indexed>0?"success":"warning")),await C()}catch(G){console.error("Indexing failed:",G),e==null||e(`Indexing failed: ${G.message}`,"error")}finally{$&&$(),V&&V(),_(!1),d({current:0,total:0,episode_title:""})}},ee=async()=>{_(!0),d({current:0,total:0,episode_title:""});let $=null,V=null;try{const G=await fu();G&&($=await G("indexing_progress",ne=>{d({current:ne.payload.current,total:ne.payload.total,episode_title:ne.payload.episode_title})}),V=await G("indexing_complete",ne=>{const{indexed:J,failed:j}=ne.payload;e==null||e(`Reindex complete: ${J} episodes updated, ${j} failed`,J>0?"success":"warning")})),e==null||e("Reindexing all transcripts with speaker names...","info");const le=await us.reindexAllWithSpeakers();le&&(e==null||e(`Reindexed ${le.indexed} episodes (${le.failed} failed)`,le.indexed>0?"success":"warning")),await C()}catch(G){console.error("Reindex failed:",G),e==null||e(`Reindex failed: ${G.message}`,"error")}finally{$&&$(),V&&V(),_(!1),d({current:0,total:0,episode_title:""})}},S=async $=>{t&&t($.episode_id,$.start_time,$.segment_idx)},Y=Math.ceil(c/u);return n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 px-6 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:"Search Transcripts"}),n.jsx("p",{className:"text-indigo-100 text-sm",children:"Search across all episode transcripts with timestamps"})]}),n.jsxs("div",{className:"text-right text-sm text-indigo-100",children:[n.jsxs("div",{children:[v.indexed_segments.toLocaleString()," segments indexed"]}),v.unindexed_episode_count>0&&n.jsxs("div",{className:"text-yellow-200",children:[v.unindexed_episode_count," episodes need indexing"]})]})]})}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex gap-3 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx("input",{type:"text",value:r,onChange:$=>s($.target.value),onKeyDown:z,placeholder:'Search for quotes, characters, topics... (e.g., "Sweet Bean" OR "pizza rolls")',className:"w-full px-4 py-3 pl-11 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-lg"}),n.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),n.jsx("button",{onClick:()=>A(!0),disabled:i||!r.trim(),className:"px-6 py-3 bg-indigo-500 hover:bg-indigo-600 disabled:bg-gray-300 text-white rounded-lg font-medium transition-colors",children:i?"Searching...":"Search"})]}),l.length===0&&!i&&!r&&n.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4 mb-6",children:[n.jsx("h3",{className:"font-medium text-indigo-800 mb-2",children:"Search Tips"}),n.jsxs("ul",{className:"text-sm text-indigo-700 space-y-1",children:[n.jsxs("li",{children:["Use quotes for exact phrases: ",n.jsx("code",{className:"bg-indigo-100 px-1 rounded",children:'"Sweet Bean"'})]}),n.jsxs("li",{children:["Use OR for alternatives: ",n.jsx("code",{className:"bg-indigo-100 px-1 rounded",children:"pizza OR burger"})]}),n.jsxs("li",{children:["Use * for wildcards: ",n.jsx("code",{className:"bg-indigo-100 px-1 rounded",children:"Matting*"})]}),n.jsxs("li",{children:["Use - to exclude: ",n.jsx("code",{className:"bg-indigo-100 px-1 rounded",children:"commercial -sponsor"})]})]})]}),c>0&&n.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:["Found ",c.toLocaleString(),' results for "',r,'"',Y>1&&` (page ${x+1} of ${Y})`]}),i?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-10 h-10 border-4 border-indigo-200 border-t-indigo-500 rounded-full animate-spin mx-auto mb-4"}),n.jsx("div",{className:"text-gray-500",children:"Searching transcripts..."})]}):l.length===0&&r?n.jsxs("div",{className:"text-center py-12 text-gray-400",children:[n.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"})}),n.jsxs("p",{children:['No results found for "',r,'"']}),n.jsx("p",{className:"text-sm mt-2",children:"Try different keywords or check if episodes are indexed"})]}):n.jsx("div",{className:"space-y-3",children:l.map($=>n.jsxs("div",{className:"p-4 rounded-lg border border-gray-200 hover:border-indigo-300 hover:shadow-md transition-all cursor-pointer bg-white",onClick:()=>S($),children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsxs("span",{className:"text-xs font-medium text-indigo-600 bg-indigo-50 px-2 py-0.5 rounded",children:["Ep ",$.episode_number||"?"]}),n.jsx("span",{className:"font-medium text-gray-800 truncate",children:$.episode_title})]}),$.speaker&&n.jsxs("span",{className:"text-xs text-gray-500",children:["Speaker: ",$.speaker]})]}),n.jsxs("button",{className:"flex items-center gap-1 px-3 py-1.5 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 rounded-lg text-sm font-medium transition-colors",onClick:V=>{V.stopPropagation(),S($)},children:[n.jsx("span",{className:"font-mono",children:Bf($.start_time)}),n.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})]})]}),n.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",dangerouslySetInnerHTML:{__html:$.snippet||$.text}})]},$.id))}),Y>1&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[n.jsx("button",{onClick:()=>N(x-1),disabled:x===0||i,className:"px-3 py-1 border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Previous"}),n.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,Y)},($,V)=>{let G;return Y<=5||x<3?G=V:x>Y-4?G=Y-5+V:G=x-2+V,n.jsx("button",{onClick:()=>N(G),disabled:i,className:`w-8 h-8 rounded ${G===x?"bg-indigo-500 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:G+1},G)})}),n.jsx("button",{onClick:()=>N(x+1),disabled:x>=Y-1||i,className:"px-3 py-1 border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:"Next"})]}),n.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 text-sm",children:"Re-index with Speaker Names"}),n.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Resolves raw SPEAKER_00 labels to real names across all transcribed episodes"})]}),n.jsx("button",{onClick:ee,disabled:h,className:"ml-4 flex-shrink-0 px-4 py-2 bg-indigo-500 hover:bg-indigo-600 disabled:bg-gray-300 text-white rounded-lg font-medium text-sm transition-colors",children:h?"Working...":"Reindex with Speakers"})]}),h&&D.total>0&&n.jsxs("div",{className:"mt-3",children:[n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[n.jsx("span",{className:"truncate flex-1",children:D.episode_title||"Indexing..."}),n.jsxs("span",{className:"ml-2",children:[D.current," / ",D.total]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"bg-indigo-500 h-2 rounded-full transition-all",style:{width:`${D.current/D.total*100}%`}})})]})]}),v.unindexed_episode_count>0&&n.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"font-medium text-yellow-800",children:[v.unindexed_episode_count," episodes need indexing"]}),n.jsx("p",{className:"text-sm text-yellow-700",children:"Index transcripts to enable full-text search"})]}),n.jsx("button",{onClick:O,disabled:h,className:"px-4 py-2 bg-yellow-500 hover:bg-yellow-600 disabled:bg-yellow-300 text-white rounded-lg font-medium text-sm transition-colors",children:h?"Indexing...":"Index All"})]}),h&&D.total>0&&n.jsxs("div",{className:"mt-3",children:[n.jsxs("div",{className:"flex justify-between text-xs text-yellow-700 mb-1",children:[n.jsx("span",{className:"truncate flex-1",children:D.episode_title||"Indexing..."}),n.jsxs("span",{className:"ml-2",children:[D.current," / ",D.total]})]}),n.jsx("div",{className:"w-full bg-yellow-200 rounded-full h-2",children:n.jsx("div",{className:"bg-yellow-500 h-2 rounded-full transition-all",style:{width:`${D.current/D.total*100}%`}})})]})]})]})]})}function Qf({onNotification:e}){const t=Ws(),[r,s]=p.useState(null),[l,a]=p.useState([]),[i,o]=p.useState(null),[c,m]=p.useState(!1),[v,b]=p.useState([]),[x,E]=p.useState(null),[h,_]=p.useState(null),[D,d]=p.useState(!1),[u,f]=p.useState(!1),[C,A]=p.useState(""),[z,N]=p.useState({name:"",description:"",content_type:"custom",prompt_text:"",system_prompt:"",output_schema:"",is_active:!0});p.useEffect(()=>{O(),ee(),S()},[]);const O=async()=>{try{const j=await Br.getOllamaStatus();s(j)}catch(j){console.error("Failed to get Ollama status:",j)}},ee=async()=>{try{const j=await Br.getPrompts();a(j)}catch(j){console.error("Failed to load prompts:",j)}},S=async()=>{try{const j=await je.getEpisodes({feed_source:"patreon",transcribed_only:!0,limit:100,sort_by:"published_date",sort_desc:!0});b(j.episodes||[])}catch(j){console.error("Failed to load episodes:",j)}},Y=j=>{o(j),N({name:j.name,description:j.description||"",content_type:j.content_type,prompt_text:j.prompt_text,system_prompt:j.system_prompt||"",output_schema:j.output_schema||"",is_active:j.is_active}),m(!1),_(null)},$=()=>{o(null),N({name:"",description:"",content_type:"custom",prompt_text:"",system_prompt:"You are a content extraction assistant. Analyze podcast transcripts and extract structured information. Always respond with valid JSON.",output_schema:"",is_active:!0}),m(!0),_(null)},V=async()=>{d(!0);try{i?(await Br.updatePrompt(i.id,z.name,z.description||null,z.content_type,z.prompt_text,z.system_prompt||null,z.output_schema||null,z.is_active),e==null||e("Prompt updated","success")):(await Br.createPrompt(z.name,z.description||null,z.content_type,z.prompt_text,z.system_prompt||null,z.output_schema||null),e==null||e("Prompt created","success")),await ee(),m(!1)}catch(j){const H=typeof j=="string"?j:(j==null?void 0:j.message)||"Unknown error";e==null||e(`Failed to save prompt: ${H}`,"error")}finally{d(!1)}},G=async()=>{if(i&&await t(`Delete prompt "${i.name}"?`)){d(!0);try{await Br.deletePrompt(i.id),e==null||e("Prompt deleted","success"),o(null),await ee()}catch(j){const H=typeof j=="string"?j:(j==null?void 0:j.message)||"Unknown error";e==null||e(`Failed to delete prompt: ${H}`,"error")}finally{d(!1)}}},le=async()=>{if(!i||!x){e==null||e("Select a prompt and episode first","warning");return}d(!0),_(null);try{const j=await Br.runExtraction(i.id,x.id);_(j),j.status==="completed"?e==null||e(`Extracted ${j.items_extracted} items in ${(j.duration_ms/1e3).toFixed(1)}s`,"success"):e==null||e(`Extraction failed: ${j.error}`,"error")}catch(j){const H=typeof j=="string"?j:(j==null?void 0:j.message)||"Unknown error";e==null||e(`Extraction failed: ${H}`,"error")}finally{d(!1)}},ne=async()=>{if(!z.prompt_text||!C){e==null||e("Enter prompt text and sample text","warning");return}d(!0),_(null);try{const j=await Br.testPrompt(z.prompt_text,z.system_prompt||null,C);_(j),j.status==="completed"?e==null||e(`Test completed in ${(j.duration_ms/1e3).toFixed(1)}s`,"success"):e==null||e(`Test failed: ${j.error}`,"error")}catch(j){const H=typeof j=="string"?j:(j==null?void 0:j.message)||"Unknown error";e==null||e(`Test failed: ${H}`,"error")}finally{d(!1)}},J=[{value:"character",label:"Character Detection"},{value:"trivia",label:"Trivia Scores"},{value:"guest",label:"Guest Detection"},{value:"segment",label:"Segment Detection"},{value:"custom",label:"Custom"}];return n.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-cream-200 overflow-hidden",children:[n.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-indigo-600 px-6 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-white",children:"LLM Content Extraction"}),n.jsx("p",{className:"text-purple-100 text-sm",children:"Create and run extraction prompts with local Ollama"})]}),n.jsx("div",{className:"text-right",children:r?n.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${r.running&&r.model_available?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.running&&r.model_available?`Ollama: ${r.model}`:r.error||"Ollama not running"}):n.jsx("div",{className:"px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-600",children:"Checking Ollama..."})})]})}),n.jsx("div",{className:"p-6",children:n.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:"Extraction Prompts"}),n.jsx("button",{onClick:$,className:"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded text-sm",children:"+ New"})]}),n.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[l.map(j=>n.jsxs("div",{onClick:()=>Y(j),className:`p-3 rounded-lg border cursor-pointer transition-colors ${(i==null?void 0:i.id)===j.id?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300"}`,children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"font-medium text-gray-900",children:j.name}),n.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${j.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`,children:j.content_type})]}),j.description&&n.jsx("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:j.description}),n.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[j.run_count," runs"]})]},j.id)),l.length===0&&n.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:"No prompts yet"})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:c?i?"Edit Prompt":"New Prompt":"Prompt Details"}),i&&!c&&n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>m(!0),className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded text-sm",children:"Edit"}),n.jsx("button",{onClick:G,className:"px-3 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-sm",children:"Delete"})]})]}),i||c?n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),n.jsx("input",{type:"text",value:z.name,onChange:j=>N({...z,name:j.target.value}),disabled:!c,className:"w-full px-3 py-2 border rounded-lg disabled:bg-gray-50",placeholder:"Character Detection"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),n.jsx("select",{value:z.content_type,onChange:j=>N({...z,content_type:j.target.value}),disabled:!c,className:"w-full px-3 py-2 border rounded-lg disabled:bg-gray-50",children:J.map(j=>n.jsx("option",{value:j.value,children:j.label},j.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("input",{type:"text",value:z.description,onChange:j=>N({...z,description:j.target.value}),disabled:!c,className:"w-full px-3 py-2 border rounded-lg disabled:bg-gray-50",placeholder:"What this prompt extracts..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Extraction Prompt"}),n.jsx("textarea",{value:z.prompt_text,onChange:j=>N({...z,prompt_text:j.target.value}),disabled:!c,rows:6,className:"w-full px-3 py-2 border rounded-lg font-mono text-sm disabled:bg-gray-50",placeholder:"Analyze this transcript and find..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"System Prompt (optional)"}),n.jsx("textarea",{value:z.system_prompt,onChange:j=>N({...z,system_prompt:j.target.value}),disabled:!c,rows:3,className:"w-full px-3 py-2 border rounded-lg font-mono text-sm disabled:bg-gray-50",placeholder:"You are a content extraction assistant..."})]}),c&&n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:V,disabled:D||!z.name||!z.prompt_text,className:"flex-1 px-4 py-2 bg-purple-500 hover:bg-purple-600 disabled:bg-gray-300 text-white rounded-lg font-medium",children:D?"Saving...":"Save Prompt"}),n.jsx("button",{onClick:()=>{m(!1),i||N({name:"",description:"",content_type:"custom",prompt_text:"",system_prompt:"",output_schema:"",is_active:!0})},className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg",children:"Cancel"})]})]}):n.jsx("div",{className:"text-gray-400 text-center py-8",children:"Select a prompt or create a new one"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:"Run Extraction"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>f(!1),className:`flex-1 px-3 py-2 rounded-lg text-sm font-medium ${u?"bg-gray-100 text-gray-600":"bg-purple-100 text-purple-700"}`,children:"Run on Episode"}),n.jsx("button",{onClick:()=>f(!0),className:`flex-1 px-3 py-2 rounded-lg text-sm font-medium ${u?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600"}`,children:"Test Mode"})]}),u?n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sample Text"}),n.jsx("textarea",{value:C,onChange:j=>A(j.target.value),rows:6,className:"w-full px-3 py-2 border rounded-lg font-mono text-sm",placeholder:"Paste sample transcript text here to test your prompt..."})]}),n.jsx("button",{onClick:ne,disabled:D||!z.prompt_text||!C||!(r!=null&&r.running),className:"w-full px-4 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700 disabled:from-gray-300 disabled:to-gray-400 text-white rounded-lg font-medium",children:D?"Testing...":"Test Prompt"})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Episode"}),n.jsxs("select",{value:(x==null?void 0:x.id)||"",onChange:j=>{const H=v.find(Z=>Z.id===parseInt(j.target.value));E(H)},className:"w-full px-3 py-2 border rounded-lg",children:[n.jsx("option",{value:"",children:"Choose an episode..."}),v.map(j=>n.jsxs("option",{value:j.id,children:[j.episode_number?`#${j.episode_number}: `:"",j.title]},j.id))]})]}),n.jsx("button",{onClick:le,disabled:D||!i||!x||!(r!=null&&r.running),className:"w-full px-4 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700 disabled:from-gray-300 disabled:to-gray-400 text-white rounded-lg font-medium",children:D?"Running...":"Run Extraction"})]}),h&&n.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:`font-medium ${h.status==="completed"?"text-green-700":"text-red-700"}`,children:h.status==="completed"?"Success":"Failed"}),n.jsxs("span",{className:"text-sm text-gray-500",children:[(h.duration_ms/1e3).toFixed(1),"s"]})]}),h.error&&n.jsx("div",{className:"text-red-600 text-sm mb-2",children:h.error}),h.parsed_json&&n.jsx("div",{className:"bg-white p-3 rounded border overflow-auto max-h-64",children:n.jsx("pre",{className:"text-xs text-gray-700",children:JSON.stringify(h.parsed_json,null,2)})}),!h.parsed_json&&h.raw_response&&n.jsx("div",{className:"bg-white p-3 rounded border overflow-auto max-h-64",children:n.jsx("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap",children:h.raw_response})}),h.items_extracted>0&&n.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:["Extracted ",h.items_extracted," item(s)"]})]})]})]})})]})}function Hf(){const[e,t]=p.useState(!1),[r,s]=p.useState("episodes"),[l,a]=p.useState({total_episodes:0,transcribed_episodes:0,downloaded_episodes:0,in_queue:0,failed:0,completion_rate:{downloaded:0,total:0}}),[i,o]=p.useState(null),[c,m]=p.useState(null),[v,b]=p.useState(null);p.useEffect(()=>{F?(console.log("Running in Tauri mode"),t(!0),(async()=>await df({onStatusUpdate:d=>{console.log("Status update:",d),E()},onQueueUpdate:d=>{console.log("Queue update:",d),x()},onStatsUpdate:d=>{console.log("Stats update:",d),x()},onTranscriptionComplete:d=>{h(`Transcription completed for episode ${d}`,"success"),x()},onTranscriptionFailed:([d,u])=>{h(`Transcription failed: ${u}`,"error")}}))()):(console.log("Running in browser mode (Socket.IO)"),Bs(async()=>{const{io:_}=await import("./index-wSuXe0Ee.js");return{io:_}},[]).then(({io:_})=>{const D=_();return D.on("connect",()=>{console.log("Connected to server"),t(!0),D.emit("request_update")}),D.on("disconnect",()=>{console.log("Disconnected from server"),t(!1)}),D.on("status_update",d=>{o(d)}),D.on("stats_update",d=>{a(d)}),D.on("download_complete",d=>{h(`Downloaded: ${d.episode}`,"success")}),D.on("download_error",d=>{h(`Error: ${d.error}`,"error")}),()=>D.close()}))},[]),p.useEffect(()=>{x(),E()},[]),p.useEffect(()=>{const _=setInterval(()=>{E(),x()},5e3);return()=>clearInterval(_)},[]);const x=async()=>{try{const _=await ws.getStats();_&&a(_)}catch(_){console.error("Error loading stats:",_)}},E=async()=>{try{const _=await Zi.getStatus();_&&!_.error?o(_):o({status:"idle",current_episode:null,progress:null,elapsed_seconds:null,estimated_remaining_seconds:null,last_activity:null,next_check_seconds:60,worker_info:{model:"unknown",memory_mb:null,memory_percent:null,processed_today:null}})}catch(_){console.error("Error loading status:",_),o(null)}},h=(_,D="success")=>{m({message:_,type:D}),setTimeout(()=>m(null),5e3)};return n.jsxs("div",{className:"min-h-screen bg-cream-100",children:[n.jsx(af,{connected:e,isTauri:F}),n.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-6",children:[n.jsx("div",{className:"border-b border-cream-200",children:n.jsx("nav",{className:"flex gap-1",children:[{id:"episodes",label:"Episodes",icon:""},{id:"search",label:"Search",icon:""},{id:"extraction",label:"Extraction",icon:""},{id:"speakers",label:"Audio ID",icon:""},{id:"characters",label:"Characters",icon:""},{id:"sponsors",label:"Sponsors",icon:""},{id:"stats",label:"Stats",icon:""},{id:"settings",label:"Settings",icon:""}].map(_=>n.jsxs("button",{onClick:()=>s(_.id),className:`px-4 py-3 font-medium text-sm transition-colors border-b-2 ${r===_.id?"border-coral-500 text-coral-600 bg-white":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-cream-50"}`,children:[n.jsx("span",{className:"mr-2",children:_.icon}),_.label]},_.id))})}),r==="stats"&&n.jsx(yf,{stats:l,currentActivity:i}),r==="episodes"&&n.jsx(zf,{onNotification:h}),r==="search"&&n.jsx(Wf,{onNotification:h,onViewEpisode:async(_,D,d)=>{try{const u=await je.getEpisode(_);u&&b({...u,initialTimestamp:D,initialSegmentIdx:d})}catch(u){h(`Error loading episode: ${u.message}`,"error")}}}),r==="extraction"&&n.jsx(Qf,{onNotification:h}),r==="speakers"&&n.jsx(Ff,{onNotification:h,onViewEpisode:async(_,D)=>{try{const d=await je.getEpisode(_);d&&b({...d,initialTimestamp:D})}catch(d){h(`Error loading episode: ${d.message}`,"error")}}}),r==="characters"&&n.jsx(Mf,{onNotification:h}),r==="sponsors"&&n.jsx(Of,{onNotification:h}),r==="settings"&&n.jsx(Uf,{onNotification:h})]}),v&&n.jsx(jf,{episode:v,onClose:()=>b(null)}),c&&n.jsx(Af,{message:c.message,type:c.type,onClose:()=>m(null)})]})}function Kf(){return n.jsx(lf,{children:n.jsx(Hf,{})})}ai.createRoot(document.getElementById("root")).render(n.jsx(Qp.StrictMode,{children:n.jsx(Kf,{})}));export{wf as i,vf as t};
